import time
import numpy as np


def h_t_c0(O, h, t, gamma1, eta1, lambdas, orbspace, verbose=False, scale=1.0):
    c = orbspace['core_alpha']
    C = orbspace['core_beta']
    a = orbspace['active_alpha']
    A = orbspace['active_beta']
    v = orbspace['virt_alpha']
    V = orbspace['virt_beta']
    hc = orbspace['hole_core_alpha']
    hC = orbspace['hole_core_beta']
    ha = orbspace['hole_active_alpha']
    hA = orbspace['hole_active_beta']
    pa = orbspace['particle_active_alpha']
    pA = orbspace['particle_active_beta']
    pv = orbspace['particle_virt_alpha']
    pV = orbspace['particle_virt_beta']
    #
    hole_a = orbspace['hole_alpha']
    part_a = orbspace['particle_alpha']
    hole_b = orbspace['hole_beta']
    part_b = orbspace['particle_beta']

    # [H1, T1]
    O['0'] += scale * (
            np.einsum("me,em->", h['a'][c, v], t['a'][pv, hc], optimize=True)
            + np.einsum("xe,ey,xy->", h['a'][a, v], t['a'][pv, ha], gamma1['a'], optimize=True)
            + np.einsum("mx,ym,yx->", h['a'][c, a], t['a'][pa, hc], eta1['a'], optimize=True)
    )
    O['0'] += scale * (
            np.einsum("me,em->", h['b'][C, V], t['b'][pV, hC], optimize=True)
            + np.einsum("xe,ey,xy->", h['b'][A, V], t['b'][pV, hA], gamma1['b'], optimize=True)
            + np.einsum("mx,ym,yx->", h['b'][C, A], t['b'][pA, hC], eta1['b'], optimize=True)
    )

    # [H2, T1]
    temp = (
            + np.einsum("xyev,eu->xyuv", h['aa'][a, a, v, a], t['a'][pv, ha], optimize=True)
            - np.einsum("myuv,xm->xyuv", h['aa'][c, a, a, a], t['a'][pa, hc], optimize=True)
    )
    O['0'] += 0.5 * scale * np.einsum("xyuv,xyuv->", temp, lambdas['aa'], optimize=True) 

    temp = (
            + np.einsum("xyev,eu->xyuv", h['bb'][A, A, V, A], t['b'][pV, hA], optimize=True)
            - np.einsum("myuv,xm->xyuv", h['bb'][C, A, A, A], t['b'][pA, hC], optimize=True)
    )
    O['0'] += 0.5 * scale * np.einsum("xyuv,xyuv->", temp, lambdas['bb'], optimize=True)

    temp = (
            + np.einsum("xYeV,eu->xYuV", h['ab'][a, A, v, A], t['a'][pv, ha], optimize=True)
            + np.einsum("xYuE,EV->xYuV", h['ab'][a, A, a, V], t['b'][pV, hA], optimize=True)
            - np.einsum("mYuV,xm->xYuV", h['ab'][c, A, a, A], t['a'][pa, hc], optimize=True)
            - np.einsum("xMuV,YM->xYuV", h['ab'][a, C, a, A], t['b'][pA, hC], optimize=True)

    )
    O['0'] += scale * np.einsum("xYuV,xYuV->", temp, lambdas['ab'], optimize=True)
    return O


def h1_t1_c1(O, h, t, gamma1, eta1, lambdas, orbspace, verbose=False, scale=1.0):
    t0 = time.time()
    c = orbspace['core_alpha']
    C = orbspace['core_beta']
    a = orbspace['active_alpha']
    A = orbspace['active_beta']
    v = orbspace['virt_alpha']
    V = orbspace['virt_beta']
    hc = orbspace['hole_core_alpha']
    hC = orbspace['hole_core_beta']
    ha = orbspace['hole_active_alpha']
    hA = orbspace['hole_active_beta']
    pa = orbspace['particle_active_alpha']
    pA = orbspace['particle_active_beta']
    pv = orbspace['particle_virt_alpha']
    pV = orbspace['particle_virt_beta']
    #
    hole_a = orbspace['hole_alpha']
    part_a = orbspace['particle_alpha']
    hole_b = orbspace['hole_beta']
    part_b = orbspace['particle_beta']

    O['a'][:, hole_a] += scale * np.einsum("pa,ai->pi", h['a'][:, part_a], t['a'], optimize=True)
    O['a'][part_a, :] -= scale * np.einsum("iq,ai->aq", h['a'][hole_a, :], t['a'], optimize=True)

    O['b'][:, hole_b] += scale * np.einsum("PA,AI->PI", h['b'][:, part_b], t['b'], optimize=True)
    O['b'][part_b, :] -= scale * np.einsum("IQ,AI->AQ", h['b'][hole_b, :], t['b'], optimize=True)
    return O


def h2_t1_c1(O, h, t, gamma1, eta1, lambdas, orbspace, verbose=False, scale=1.0):
    t0 = time.time()
    c = orbspace['core_alpha']
    C = orbspace['core_beta']
    a = orbspace['active_alpha']
    A = orbspace['active_beta']
    v = orbspace['virt_alpha']
    V = orbspace['virt_beta']
    hc = orbspace['hole_core_alpha']
    hC = orbspace['hole_core_beta']
    ha = orbspace['hole_active_alpha']
    hA = orbspace['hole_active_beta']
    pa = orbspace['particle_active_alpha']
    pA = orbspace['particle_active_beta']
    pv = orbspace['particle_virt_alpha']
    pV = orbspace['particle_virt_beta']
    #
    hole_a = orbspace['hole_alpha']
    part_a = orbspace['particle_alpha']
    hole_b = orbspace['hole_beta']
    part_b = orbspace['particle_beta']

    # a
    O['a'] += scale * np.einsum("pmqa,am->pq", h['aa'][:, c, :, part_a], t['a'][:, hc], optimize=True)
    O['a'] += scale * np.einsum("pyqe,yx,ex->pq", h['aa'][:, a, :, v], gamma1['a'], t['a'][pv, ha], optimize=True)
    O['a'] -= scale * np.einsum("pmqv,uv,um->pq", h['aa'][:, c, :, a], gamma1['a'], t['a'][pa, hc], optimize=True)
    O['a'] += scale * np.einsum("pMqA,AM->pq", h['ab'][:, C, :, part_b], t['b'][:, hC], optimize=True)
    O['a'] += scale * np.einsum("pYqE,YX,EX->pq", h['ab'][:, A, :, V], gamma1['b'], t['b'][pV, hA], optimize=True)
    O['a'] -= scale * np.einsum("pMqV,UV,UM->pq", h['ab'][:, C, :, A], gamma1['b'], t['b'][pA, hC], optimize=True)
    # b
    O['b'] += scale * np.einsum("mPaQ,am->PQ", h['ab'][c, :, part_a, :], t['a'][:, hc], optimize=True)
    O['b'] += scale * np.einsum("yPeQ,yx,ex->PQ", h['ab'][a, :, v, :], gamma1['a'], t['a'][pv, ha], optimize=True)
    O['b'] -= scale * np.einsum("mPvQ,uv,um->PQ", h['ab'][c, :, a, :], gamma1['a'], t['a'][pa, hc], optimize=True)
    O['b'] += scale * np.einsum("pmqa,am->pq", h['bb'][:, C, :, part_b], t['b'][:, hC], optimize=True)
    O['b'] += scale * np.einsum("pyqe,yx,ex->pq", h['bb'][:, A, :, V], gamma1['b'], t['b'][pV, hA], optimize=True)
    O['b'] -= scale * np.einsum("pmqv,uv,um->pq", h['bb'][:, C, :, A], gamma1['b'], t['b'][pA, hC], optimize=True)
    return O


def h2_t1_c2(O, h, t, gamma1, eta1, lambdas, orbspace, verbose=False, scale=1.0):
    t0 = time.time()
    c = orbspace['core_alpha']
    C = orbspace['core_beta']
    a = orbspace['active_alpha']
    A = orbspace['active_beta']
    v = orbspace['virt_alpha']
    V = orbspace['virt_beta']
    hc = orbspace['hole_core_alpha']
    hC = orbspace['hole_core_beta']
    ha = orbspace['hole_active_alpha']
    hA = orbspace['hole_active_beta']
    pa = orbspace['particle_active_alpha']
    pA = orbspace['particle_active_beta']
    pv = orbspace['particle_virt_alpha']
    pV = orbspace['particle_virt_beta']
    #
    hole_a = orbspace['hole_alpha']
    part_a = orbspace['particle_alpha']
    hole_b = orbspace['hole_beta']
    part_b = orbspace['particle_beta']

    O['aa'][:, :, hole_a, :] += 0.5 * scale * np.einsum("pqar,ai->pqir", h['aa'][:, :, part_a, :], t['a'], optimize=True)
    O['aa'][part_a, :, :, :] -= 0.5 * scale * np.einsum("iqrs,ai->aqrs", h['aa'][hole_a, :, :, :], t['a'], optimize=True)

    O['ab'][:, :, hole_a, :] += scale * np.einsum("pQaR,ai->pQiR", h['ab'][:, :, part_a, :], t['a'], optimize=True)
    O['ab'][:, :, :, hole_b] += scale * np.einsum("pQrA,AI->pQrI", h['ab'][:, :, :, part_b], t['b'], optimize=True)
    O['ab'][part_a, :, :, :] -= scale * np.einsum("iQrS,ai->aQrS", h['ab'][hole_a, :, :, :], t['a'], optimize=True)
    O['ab'][:, part_b, :, :] -= scale * np.einsum("pIrS,AI->pArS", h['ab'][:, hole_b, :, :], t['b'], optimize=True)

    O['bb'][:, :, hole_b, :] += 0.5 * scale * np.einsum("pqar,ai->pqir", h['bb'][:, :, part_b, :], t['b'], optimize=True)
    O['bb'][part_b, :, :, :] -= 0.5 * scale * np.einsum("iqrs,ai->aqrs", h['bb'][hole_b, :, :, :], t['b'], optimize=True)
    return O


def H_T_ncomm1_nbody0(X, h, t, gamma1, eta1, lambdas, orbspace, verbose=False):
	tic = time.time()
	c = orbspace['core_alpha']
	C = orbspace['core_beta']
	a = orbspace['active_alpha']
	A = orbspace['active_beta']
	v = orbspace['virt_alpha']
	V = orbspace['virt_beta']
	hc = orbspace['hole_core_alpha']
	hC = orbspace['hole_core_beta']
	ha = orbspace['hole_active_alpha']
	hA = orbspace['hole_active_beta']
	pa = orbspace['particle_active_alpha']
	pA = orbspace['particle_active_beta']
	pv = orbspace['particle_virt_alpha']
	pV = orbspace['particle_virt_beta']

	# |
	X['0'] += 0.5 * np.einsum('uv,wx,yz,izuw,vxiy->', eta1['a'], eta1['a'], gamma1['a'], h['aa'][c,a,a,a], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += 0.25 * np.einsum('uv,wx,ijuw,vxij->', eta1['a'], eta1['a'], h['aa'][c,c,a,a], t['aa'][pa,pa,hc,hc], optimize=True)
	X['0'] += 0.5 * np.einsum('uv,wx,yz,xzua,vawy->', eta1['a'], gamma1['a'], gamma1['a'], h['aa'][a,a,a,v], t['aa'][pa,pv,ha,ha], optimize=True)
	X['0'] += 1.0 * np.einsum('uv,wx,ixua,vaiw->', eta1['a'], gamma1['a'], h['aa'][c,a,a,v], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += 1.0 * np.einsum('uv,wx,xIuA,vAwI->', eta1['a'], gamma1['a'], h['ab'][a,C,a,V], t['ab'][pa,pV,ha,hC], optimize=True)
	X['0'] += 1.0 * np.einsum('uv,UV,wx,xVuA,vAwU->', eta1['a'], gamma1['b'], gamma1['a'], h['ab'][a,A,a,V], t['ab'][pa,pV,ha,hA], optimize=True)
	X['0'] += 1.0 * np.einsum('uv,UV,iVuA,vAiU->', eta1['a'], gamma1['b'], h['ab'][c,A,a,V], t['ab'][pa,pV,hc,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('uv,ijua,vaij->', eta1['a'], h['aa'][c,c,a,v], t['aa'][pa,pv,hc,hc], optimize=True)
	X['0'] += 1.0 * np.einsum('uv,iwux,xywz,vziy->', eta1['a'], h['aa'][c,a,a,a], lambdas['aa'], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += 1.0 * np.einsum('uv,iwux,xUwV,vViU->', eta1['a'], h['aa'][c,a,a,a], lambdas['ab'], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += 1.0 * np.einsum('uv,iIuA,vAiI->', eta1['a'], h['ab'][c,C,a,V], t['ab'][pa,pV,hc,hC], optimize=True)
	X['0'] += 1.0 * np.einsum('uv,iUuV,wVxU,vxiw->', eta1['a'], h['ab'][c,A,a,A], lambdas['ab'], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += 1.0 * np.einsum('uv,iUuV,VWUX,vXiW->', eta1['a'], h['ab'][c,A,a,A], lambdas['bb'], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += 0.25 * np.einsum('uv,wxua,yzwx,vayz->', eta1['a'], h['aa'][a,a,a,v], lambdas['aa'], t['aa'][pa,pv,ha,ha], optimize=True)
	X['0'] += -1.0 * np.einsum('uv,wIuU,xUwV,vVxI->', eta1['a'], h['ab'][a,C,a,A], lambdas['ab'], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += 1.0 * np.einsum('uv,wUuA,xVwU,vAxV->', eta1['a'], h['ab'][a,A,a,V], lambdas['ab'], t['ab'][pa,pV,ha,hA], optimize=True)
	X['0'] += 1.0 * np.einsum('UV,uv,wx,xIuU,vVwI->', eta1['b'], eta1['a'], gamma1['a'], h['ab'][a,C,a,A], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += 1.0 * np.einsum('UV,uv,WX,iXuU,vViW->', eta1['b'], eta1['a'], gamma1['b'], h['ab'][c,A,a,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += 1.0 * np.einsum('UV,uv,iIuU,vViI->', eta1['b'], eta1['a'], h['ab'][c,C,a,A], t['ab'][pa,pA,hc,hC], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,WX,YZ,IZUW,VXIY->', eta1['b'], eta1['b'], gamma1['b'], h['bb'][C,A,A,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['0'] += 0.25 * np.einsum('UV,WX,IJUW,VXIJ->', eta1['b'], eta1['b'], h['bb'][C,C,A,A], t['bb'][pA,pA,hC,hC], optimize=True)
	X['0'] += 1.0 * np.einsum('UV,uv,vIaU,aVuI->', eta1['b'], gamma1['a'], h['ab'][a,C,v,A], t['ab'][pv,pA,ha,hC], optimize=True)
	X['0'] += 1.0 * np.einsum('UV,WX,uv,vXaU,aVuW->', eta1['b'], gamma1['b'], gamma1['a'], h['ab'][a,A,v,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,WX,YZ,XZUA,VAWY->', eta1['b'], gamma1['b'], gamma1['b'], h['bb'][A,A,A,V], t['bb'][pA,pV,hA,hA], optimize=True)
	X['0'] += 1.0 * np.einsum('UV,WX,iXaU,aViW->', eta1['b'], gamma1['b'], h['ab'][c,A,v,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['0'] += 1.0 * np.einsum('UV,WX,IXUA,VAIW->', eta1['b'], gamma1['b'], h['bb'][C,A,A,V], t['bb'][pA,pV,hC,hA], optimize=True)
	X['0'] += 1.0 * np.einsum('UV,iIaU,aViI->', eta1['b'], h['ab'][c,C,v,A], t['ab'][pv,pA,hc,hC], optimize=True)
	X['0'] += -1.0 * np.einsum('UV,iWuU,uXvW,vViX->', eta1['b'], h['ab'][c,A,a,A], lambdas['ab'], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += 1.0 * np.einsum('UV,uIvU,vwux,xVwI->', eta1['b'], h['ab'][a,C,a,A], lambdas['aa'], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += 1.0 * np.einsum('UV,uIvU,vWuX,VXIW->', eta1['b'], h['ab'][a,C,a,A], lambdas['ab'], t['bb'][pA,pA,hC,hA], optimize=True)
	X['0'] += 1.0 * np.einsum('UV,uWaU,vXuW,aVvX->', eta1['b'], h['ab'][a,A,v,A], lambdas['ab'], t['ab'][pv,pA,ha,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,IJUA,VAIJ->', eta1['b'], h['bb'][C,C,A,V], t['bb'][pA,pV,hC,hC], optimize=True)
	X['0'] += 1.0 * np.einsum('UV,IWUX,uXvW,vVuI->', eta1['b'], h['bb'][C,A,A,A], lambdas['ab'], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += 1.0 * np.einsum('UV,IWUX,XYWZ,VZIY->', eta1['b'], h['bb'][C,A,A,A], lambdas['bb'], t['bb'][pA,pA,hC,hA], optimize=True)
	X['0'] += 0.25 * np.einsum('UV,WXUA,YZWX,VAYZ->', eta1['b'], h['bb'][A,A,A,V], lambdas['bb'], t['bb'][pA,pV,hA,hA], optimize=True)
	X['0'] += 0.25 * np.einsum('uv,wx,vxab,abuw->', gamma1['a'], gamma1['a'], h['aa'][a,a,v,v], t['aa'][pv,pv,ha,ha], optimize=True)
	X['0'] += 0.25 * np.einsum('uv,ivwx,wxyz,yziu->', gamma1['a'], h['aa'][c,a,a,a], lambdas['aa'], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += 0.5 * np.einsum('uv,ivab,abiu->', gamma1['a'], h['aa'][c,a,v,v], t['aa'][pv,pv,hc,ha], optimize=True)
	X['0'] += 1.0 * np.einsum('uv,vwxa,xywz,zauy->', gamma1['a'], h['aa'][a,a,a,v], lambdas['aa'], t['aa'][pa,pv,ha,ha], optimize=True)
	X['0'] += -1.0 * np.einsum('uv,vwxa,xUwV,aVuU->', gamma1['a'], h['aa'][a,a,a,v], lambdas['ab'], t['ab'][pv,pA,ha,hA], optimize=True)
	X['0'] += 1.0 * np.einsum('uv,vIwU,wUxV,xVuI->', gamma1['a'], h['ab'][a,C,a,A], lambdas['ab'], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += 1.0 * np.einsum('uv,vIaA,aAuI->', gamma1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,ha,hC], optimize=True)
	X['0'] += -1.0 * np.einsum('uv,vUwA,wVxU,xAuV->', gamma1['a'], h['ab'][a,A,a,V], lambdas['ab'], t['ab'][pa,pV,ha,hA], optimize=True)
	X['0'] += -1.0 * np.einsum('uv,vUaV,wVxU,xauw->', gamma1['a'], h['ab'][a,A,v,A], lambdas['ab'], t['aa'][pa,pv,ha,ha], optimize=True)
	X['0'] += 1.0 * np.einsum('uv,vUaV,VWUX,aXuW->', gamma1['a'], h['ab'][a,A,v,A], lambdas['bb'], t['ab'][pv,pA,ha,hA], optimize=True)
	X['0'] += 1.0 * np.einsum('UV,uv,vVaA,aAuU->', gamma1['b'], gamma1['a'], h['ab'][a,A,v,V], t['ab'][pv,pV,ha,hA], optimize=True)
	X['0'] += 0.25 * np.einsum('UV,WX,VXAB,ABUW->', gamma1['b'], gamma1['b'], h['bb'][A,A,V,V], t['bb'][pV,pV,hA,hA], optimize=True)
	X['0'] += 1.0 * np.einsum('UV,iVuW,uWvX,vXiU->', gamma1['b'], h['ab'][c,A,a,A], lambdas['ab'], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += 1.0 * np.einsum('UV,iVaA,aAiU->', gamma1['b'], h['ab'][c,A,v,V], t['ab'][pv,pV,hc,hA], optimize=True)
	X['0'] += 1.0 * np.einsum('UV,uVvA,vwux,xAwU->', gamma1['b'], h['ab'][a,A,a,V], lambdas['aa'], t['ab'][pa,pV,ha,hA], optimize=True)
	X['0'] += -1.0 * np.einsum('UV,uVvA,vWuX,XAUW->', gamma1['b'], h['ab'][a,A,a,V], lambdas['ab'], t['bb'][pA,pV,hA,hA], optimize=True)
	X['0'] += -1.0 * np.einsum('UV,uVaW,vWuX,aXvU->', gamma1['b'], h['ab'][a,A,v,A], lambdas['ab'], t['ab'][pv,pA,ha,hA], optimize=True)
	X['0'] += 0.25 * np.einsum('UV,IVWX,WXYZ,YZIU->', gamma1['b'], h['bb'][C,A,A,A], lambdas['bb'], t['bb'][pA,pA,hC,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,IVAB,ABIU->', gamma1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hC,hA], optimize=True)
	X['0'] += -1.0 * np.einsum('UV,VWXA,uXvW,vAuU->', gamma1['b'], h['bb'][A,A,A,V], lambdas['ab'], t['ab'][pa,pV,ha,hA], optimize=True)
	X['0'] += 1.0 * np.einsum('UV,VWXA,XYWZ,ZAUY->', gamma1['b'], h['bb'][A,A,A,V], lambdas['bb'], t['bb'][pA,pV,hA,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('iu,uvwx,wxiv->', h['a'][c,a], lambdas['aa'], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += -1.0 * np.einsum('iu,uUvV,vViU->', h['a'][c,a], lambdas['ab'], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += 0.125 * np.einsum('ijuv,uvwx,wxij->', h['aa'][c,c,a,a], lambdas['aa'], t['aa'][pa,pa,hc,hc], optimize=True)
	X['0'] += 0.25 * np.einsum('ijab,abij->', h['aa'][c,c,v,v], t['aa'][pv,pv,hc,hc], optimize=True)
	X['0'] += 0.25 * np.einsum('iuvw,vwxuyz,yzix->', h['aa'][c,a,a,a], lambdas['aaa'], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += 0.5 * np.einsum('iuvw,vwUuxV,xViU->', h['aa'][c,a,a,a], lambdas['aab'], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += 1.0 * np.einsum('iuva,vwux,xaiw->', h['aa'][c,a,a,v], lambdas['aa'], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += -1.0 * np.einsum('iuva,vUuV,aViU->', h['aa'][c,a,a,v], lambdas['ab'], t['ab'][pv,pA,hc,hA], optimize=True)
	X['0'] += 1.0 * np.einsum('iIuU,uUvV,vViI->', h['ab'][c,C,a,A], lambdas['ab'], t['ab'][pa,pA,hc,hC], optimize=True)
	X['0'] += 1.0 * np.einsum('iIaA,aAiI->', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], optimize=True)
	X['0'] += -0.5 * np.einsum('iUuV,uvVwxU,wxiv->', h['ab'][c,A,a,A], lambdas['aab'], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += -1.0 * np.einsum('iUuV,uVWvUX,vXiW->', h['ab'][c,A,a,A], lambdas['abb'], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += -1.0 * np.einsum('iUuA,uVvU,vAiV->', h['ab'][c,A,a,V], lambdas['ab'], t['ab'][pa,pV,hc,hA], optimize=True)
	X['0'] += -1.0 * np.einsum('iUaV,uVvU,vaiu->', h['ab'][c,A,v,A], lambdas['ab'], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += 1.0 * np.einsum('iUaV,VWUX,aXiW->', h['ab'][c,A,v,A], lambdas['bb'], t['ab'][pv,pA,hc,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('ua,vwux,xavw->', h['a'][a,v], lambdas['aa'], t['aa'][pa,pv,ha,ha], optimize=True)
	X['0'] += 1.0 * np.einsum('ua,vUuV,aVvU->', h['a'][a,v], lambdas['ab'], t['ab'][pv,pA,ha,hA], optimize=True)
	X['0'] += -0.25 * np.einsum('uvwa,wxyuvz,zaxy->', h['aa'][a,a,a,v], lambdas['aaa'], t['aa'][pa,pv,ha,ha], optimize=True)
	X['0'] += 0.5 * np.einsum('uvwa,wxUuvV,aVxU->', h['aa'][a,a,a,v], lambdas['aab'], t['ab'][pv,pA,ha,hA], optimize=True)
	X['0'] += 0.125 * np.einsum('uvab,wxuv,abwx->', h['aa'][a,a,v,v], lambdas['aa'], t['aa'][pv,pv,ha,ha], optimize=True)
	X['0'] += -1.0 * np.einsum('uIvU,vwUuxV,xVwI->', h['ab'][a,C,a,A], lambdas['aab'], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += -0.5 * np.einsum('uIvU,vUVuWX,WXIV->', h['ab'][a,C,a,A], lambdas['abb'], t['bb'][pA,pA,hC,hA], optimize=True)
	X['0'] += 1.0 * np.einsum('uIvA,vwux,xAwI->', h['ab'][a,C,a,V], lambdas['aa'], t['ab'][pa,pV,ha,hC], optimize=True)
	X['0'] += -1.0 * np.einsum('uIvA,vUuV,VAIU->', h['ab'][a,C,a,V], lambdas['ab'], t['bb'][pA,pV,hC,hA], optimize=True)
	X['0'] += -1.0 * np.einsum('uIaU,vUuV,aVvI->', h['ab'][a,C,v,A], lambdas['ab'], t['ab'][pv,pA,ha,hC], optimize=True)
	X['0'] += 1.0 * np.einsum('uUvA,vwVuxU,xAwV->', h['ab'][a,A,a,V], lambdas['aab'], t['ab'][pa,pV,ha,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('uUvA,vVWuUX,XAVW->', h['ab'][a,A,a,V], lambdas['abb'], t['bb'][pA,pV,hA,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('uUaV,vwVuxU,xavw->', h['ab'][a,A,v,A], lambdas['aab'], t['aa'][pa,pv,ha,ha], optimize=True)
	X['0'] += 1.0 * np.einsum('uUaV,vVWuUX,aXvW->', h['ab'][a,A,v,A], lambdas['abb'], t['ab'][pv,pA,ha,hA], optimize=True)
	X['0'] += 1.0 * np.einsum('uUaA,vVuU,aAvV->', h['ab'][a,A,v,V], lambdas['ab'], t['ab'][pv,pV,ha,hA], optimize=True)
	X['0'] += -1.0 * np.einsum('IU,uUvV,vVuI->', h['b'][C,A], lambdas['ab'], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += -0.5 * np.einsum('IU,UVWX,WXIV->', h['b'][C,A], lambdas['bb'], t['bb'][pA,pA,hC,hA], optimize=True)
	X['0'] += 0.125 * np.einsum('IJUV,UVWX,WXIJ->', h['bb'][C,C,A,A], lambdas['bb'], t['bb'][pA,pA,hC,hC], optimize=True)
	X['0'] += 0.25 * np.einsum('IJAB,ABIJ->', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hC], optimize=True)
	X['0'] += 0.5 * np.einsum('IUVW,uVWvUX,vXuI->', h['bb'][C,A,A,A], lambdas['abb'], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += 0.25 * np.einsum('IUVW,VWXUYZ,YZIX->', h['bb'][C,A,A,A], lambdas['bbb'], t['bb'][pA,pA,hC,hA], optimize=True)
	X['0'] += -1.0 * np.einsum('IUVA,uVvU,vAuI->', h['bb'][C,A,A,V], lambdas['ab'], t['ab'][pa,pV,ha,hC], optimize=True)
	X['0'] += 1.0 * np.einsum('IUVA,VWUX,XAIW->', h['bb'][C,A,A,V], lambdas['bb'], t['bb'][pA,pV,hC,hA], optimize=True)
	X['0'] += 1.0 * np.einsum('UA,uVvU,vAuV->', h['b'][A,V], lambdas['ab'], t['ab'][pa,pV,ha,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('UA,VWUX,XAVW->', h['b'][A,V], lambdas['bb'], t['bb'][pA,pV,hA,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('UVWA,uWXvUV,vAuX->', h['bb'][A,A,A,V], lambdas['abb'], t['ab'][pa,pV,ha,hA], optimize=True)
	X['0'] += -0.25 * np.einsum('UVWA,WXYUVZ,ZAXY->', h['bb'][A,A,A,V], lambdas['bbb'], t['bb'][pA,pV,hA,hA], optimize=True)
	X['0'] += 0.125 * np.einsum('UVAB,WXUV,ABWX->', h['bb'][A,A,V,V], lambdas['bb'], t['bb'][pV,pV,hA,hA], optimize=True)
	toc = time.time()
	elapsed_time = toc - tic
	if verbose:
		print(f'Took {elapsed_time} seconds.')
	return X


def H_T_ncomm1_nbody1(X, h, t, gamma1, eta1, lambdas, orbspace, verbose=False):
	tic = time.time()
	c = orbspace['core_alpha']
	C = orbspace['core_beta']
	a = orbspace['active_alpha']
	A = orbspace['active_beta']
	v = orbspace['virt_alpha']
	V = orbspace['virt_beta']
	hc = orbspace['hole_core_alpha']
	hC = orbspace['hole_core_beta']
	ha = orbspace['hole_active_alpha']
	hA = orbspace['hole_active_beta']
	pa = orbspace['particle_active_alpha']
	pA = orbspace['particle_active_beta']
	pv = orbspace['particle_virt_alpha']
	pV = orbspace['particle_virt_beta']

	# A|V
	X['b'][pV,hA] += -1.0 * np.einsum('uv,wx,vw,xAuU->AU', eta1['a'], gamma1['a'], h['a'][a,a], t['ab'][pa,pV,ha,hA], optimize=True)
	X['b'][pV,hA] += 1.0 * np.einsum('uv,wx,xu,vAwU->AU', eta1['a'], gamma1['a'], h['a'][a,a], t['ab'][pa,pV,ha,hA], optimize=True)
	X['b'][pV,hA] += -1.0 * np.einsum('uv,wx,xIuU,vAwI->AU', eta1['a'], gamma1['a'], h['ab'][a,C,a,A], t['ab'][pa,pV,ha,hC], optimize=True)
	X['b'][pV,hA] += 1.0 * np.einsum('uv,wx,xAuB,vBwU->AU', eta1['a'], gamma1['a'], h['ab'][a,V,a,V], t['ab'][pa,pV,ha,hA], optimize=True)
	X['b'][pV,hA] += -1.0 * np.einsum('uv,VW,wx,xWuU,vAwV->AU', eta1['a'], gamma1['b'], gamma1['a'], h['ab'][a,A,a,A], t['ab'][pa,pV,ha,hA], optimize=True)
	X['b'][pV,hA] += -1.0 * np.einsum('uv,VW,iWuU,vAiV->AU', eta1['a'], gamma1['b'], h['ab'][c,A,a,A], t['ab'][pa,pV,hc,hA], optimize=True)
	X['b'][pV,hA] += 1.0 * np.einsum('uv,iu,vAiU->AU', eta1['a'], h['a'][c,a], t['ab'][pa,pV,hc,hA], optimize=True)
	X['b'][pV,hA] += -1.0 * np.einsum('uv,iIuU,vAiI->AU', eta1['a'], h['ab'][c,C,a,A], t['ab'][pa,pV,hc,hC], optimize=True)
	X['b'][pV,hA] += 1.0 * np.einsum('uv,iAuB,vBiU->AU', eta1['a'], h['ab'][c,V,a,V], t['ab'][pa,pV,hc,hA], optimize=True)
	X['b'][pV,hA] += 0.5 * np.einsum('uv,vwxy,xywz,zAuU->AU', eta1['a'], h['aa'][a,a,a,a], lambdas['aa'], t['ab'][pa,pV,ha,hA], optimize=True)
	X['b'][pV,hA] += 1.0 * np.einsum('uv,vVwU,wWxV,xAuW->AU', eta1['a'], h['ab'][a,A,a,A], lambdas['ab'], t['ab'][pa,pV,ha,hA], optimize=True)
	X['b'][pV,hA] += -1.0 * np.einsum('uv,vVwW,wWxV,xAuU->AU', eta1['a'], h['ab'][a,A,a,A], lambdas['ab'], t['ab'][pa,pV,ha,hA], optimize=True)
	X['b'][pV,hA] += -0.5 * np.einsum('uv,wxuy,yzwx,vAzU->AU', eta1['a'], h['aa'][a,a,a,a], lambdas['aa'], t['ab'][pa,pV,ha,hA], optimize=True)
	X['b'][pV,hA] += -1.0 * np.einsum('uv,wVuU,xWwV,vAxW->AU', eta1['a'], h['ab'][a,A,a,A], lambdas['ab'], t['ab'][pa,pV,ha,hA], optimize=True)
	X['b'][pV,hA] += 1.0 * np.einsum('uv,wVuW,xWwV,vAxU->AU', eta1['a'], h['ab'][a,A,a,A], lambdas['ab'], t['ab'][pa,pV,ha,hA], optimize=True)
	X['b'][pV,hA] += -1.0 * np.einsum('VW,uv,wx,vWwU,xAuV->AU', eta1['b'], eta1['a'], gamma1['a'], h['ab'][a,A,a,A], t['ab'][pa,pV,ha,hA], optimize=True)
	X['b'][pV,hA] += 1.0 * np.einsum('VW,uv,iAuV,vWiU->AU', eta1['b'], eta1['a'], h['ab'][c,V,a,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['b'][pV,hA] += 0.5 * np.einsum('VW,XY,ZP,WYUZ,PAVX->AU', eta1['b'], eta1['b'], gamma1['b'], h['bb'][A,A,A,A], t['bb'][pA,pV,hA,hA], optimize=True)
	X['b'][pV,hA] += 0.5 * np.einsum('VW,XY,IAVX,WYIU->AU', eta1['b'], eta1['b'], h['bb'][C,V,A,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['b'][pV,hA] += 1.0 * np.einsum('VW,uv,vAaV,aWuU->AU', eta1['b'], gamma1['a'], h['ab'][a,V,v,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['b'][pV,hA] += 0.5 * np.einsum('VW,XY,ZP,YPUV,WAXZ->AU', eta1['b'], gamma1['b'], gamma1['b'], h['bb'][A,A,A,A], t['bb'][pA,pV,hA,hA], optimize=True)
	X['b'][pV,hA] += 1.0 * np.einsum('VW,XY,IYUV,WAIX->AU', eta1['b'], gamma1['b'], h['bb'][C,A,A,A], t['bb'][pA,pV,hC,hA], optimize=True)
	X['b'][pV,hA] += 1.0 * np.einsum('VW,XY,WX,YAUV->AU', eta1['b'], gamma1['b'], h['b'][A,A], t['bb'][pA,pV,hA,hA], optimize=True)
	X['b'][pV,hA] += -1.0 * np.einsum('VW,XY,YV,WAUX->AU', eta1['b'], gamma1['b'], h['b'][A,A], t['bb'][pA,pV,hA,hA], optimize=True)
	X['b'][pV,hA] += -1.0 * np.einsum('VW,XY,YAVB,WBUX->AU', eta1['b'], gamma1['b'], h['bb'][A,V,A,V], t['bb'][pA,pV,hA,hA], optimize=True)
	X['b'][pV,hA] += 1.0 * np.einsum('VW,iAaV,aWiU->AU', eta1['b'], h['ab'][c,V,v,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['b'][pV,hA] += -1.0 * np.einsum('VW,uWvU,vwux,xAwV->AU', eta1['b'], h['ab'][a,A,a,A], lambdas['aa'], t['ab'][pa,pV,ha,hA], optimize=True)
	X['b'][pV,hA] += 1.0 * np.einsum('VW,uWvU,vXuY,YAVX->AU', eta1['b'], h['ab'][a,A,a,A], lambdas['ab'], t['bb'][pA,pV,hA,hA], optimize=True)
	X['b'][pV,hA] += 1.0 * np.einsum('VW,uWvX,vXuY,YAUV->AU', eta1['b'], h['ab'][a,A,a,A], lambdas['ab'], t['bb'][pA,pV,hA,hA], optimize=True)
	X['b'][pV,hA] += -1.0 * np.einsum('VW,uXvV,vYuX,WAUY->AU', eta1['b'], h['ab'][a,A,a,A], lambdas['ab'], t['bb'][pA,pV,hA,hA], optimize=True)
	X['b'][pV,hA] += 1.0 * np.einsum('VW,IV,WAIU->AU', eta1['b'], h['b'][C,A], t['bb'][pA,pV,hC,hA], optimize=True)
	X['b'][pV,hA] += 0.5 * np.einsum('VW,IJUV,WAIJ->AU', eta1['b'], h['bb'][C,C,A,A], t['bb'][pA,pV,hC,hC], optimize=True)
	X['b'][pV,hA] += 1.0 * np.einsum('VW,IAVB,WBIU->AU', eta1['b'], h['bb'][C,V,A,V], t['bb'][pA,pV,hC,hA], optimize=True)
	X['b'][pV,hA] += -1.0 * np.einsum('VW,WXUY,uYvX,vAuV->AU', eta1['b'], h['bb'][A,A,A,A], lambdas['ab'], t['ab'][pa,pV,ha,hA], optimize=True)
	X['b'][pV,hA] += 1.0 * np.einsum('VW,WXUY,YZXP,PAVZ->AU', eta1['b'], h['bb'][A,A,A,A], lambdas['bb'], t['bb'][pA,pV,hA,hA], optimize=True)
	X['b'][pV,hA] += -0.5 * np.einsum('VW,WXYZ,YZXP,PAUV->AU', eta1['b'], h['bb'][A,A,A,A], lambdas['bb'], t['bb'][pA,pV,hA,hA], optimize=True)
	X['b'][pV,hA] += 0.25 * np.einsum('VW,XYUV,ZPXY,WAZP->AU', eta1['b'], h['bb'][A,A,A,A], lambdas['bb'], t['bb'][pA,pV,hA,hA], optimize=True)
	X['b'][pV,hA] += 0.5 * np.einsum('VW,XYVZ,ZPXY,WAUP->AU', eta1['b'], h['bb'][A,A,A,A], lambdas['bb'], t['bb'][pA,pV,hA,hA], optimize=True)
	X['b'][pV,hA] += 1.0 * np.einsum('uv,va,aAuU->AU', gamma1['a'], h['a'][a,v], t['ab'][pv,pV,ha,hA], optimize=True)
	X['b'][pV,hA] += 0.5 * np.einsum('uv,vwxy,xywz,zAuU->AU', gamma1['a'], h['aa'][a,a,a,a], lambdas['aa'], t['ab'][pa,pV,ha,hA], optimize=True)
	X['b'][pV,hA] += -1.0 * np.einsum('uv,vIaU,aAuI->AU', gamma1['a'], h['ab'][a,C,v,A], t['ab'][pv,pV,ha,hC], optimize=True)
	X['b'][pV,hA] += 1.0 * np.einsum('uv,vVwU,wWxV,xAuW->AU', gamma1['a'], h['ab'][a,A,a,A], lambdas['ab'], t['ab'][pa,pV,ha,hA], optimize=True)
	X['b'][pV,hA] += -1.0 * np.einsum('uv,vVwW,wWxV,xAuU->AU', gamma1['a'], h['ab'][a,A,a,A], lambdas['ab'], t['ab'][pa,pV,ha,hA], optimize=True)
	X['b'][pV,hA] += 1.0 * np.einsum('uv,vAaB,aBuU->AU', gamma1['a'], h['ab'][a,V,v,V], t['ab'][pv,pV,ha,hA], optimize=True)
	X['b'][pV,hA] += -0.5 * np.einsum('uv,wxuy,yzwx,vAzU->AU', gamma1['a'], h['aa'][a,a,a,a], lambdas['aa'], t['ab'][pa,pV,ha,hA], optimize=True)
	X['b'][pV,hA] += -1.0 * np.einsum('uv,wVuU,xWwV,vAxW->AU', gamma1['a'], h['ab'][a,A,a,A], lambdas['ab'], t['ab'][pa,pV,ha,hA], optimize=True)
	X['b'][pV,hA] += 1.0 * np.einsum('uv,wVuW,xWwV,vAxU->AU', gamma1['a'], h['ab'][a,A,a,A], lambdas['ab'], t['ab'][pa,pV,ha,hA], optimize=True)
	X['b'][pV,hA] += -1.0 * np.einsum('VW,uv,vWaU,aAuV->AU', gamma1['b'], gamma1['a'], h['ab'][a,A,v,A], t['ab'][pv,pV,ha,hA], optimize=True)
	X['b'][pV,hA] += -0.5 * np.einsum('VW,XY,WYUB,ABVX->AU', gamma1['b'], gamma1['b'], h['bb'][A,A,A,V], t['bb'][pV,pV,hA,hA], optimize=True)
	X['b'][pV,hA] += -1.0 * np.einsum('VW,iWaU,aAiV->AU', gamma1['b'], h['ab'][c,A,v,A], t['ab'][pv,pV,hc,hA], optimize=True)
	X['b'][pV,hA] += -1.0 * np.einsum('VW,uWvU,vwux,xAwV->AU', gamma1['b'], h['ab'][a,A,a,A], lambdas['aa'], t['ab'][pa,pV,ha,hA], optimize=True)
	X['b'][pV,hA] += 1.0 * np.einsum('VW,uWvU,vXuY,YAVX->AU', gamma1['b'], h['ab'][a,A,a,A], lambdas['ab'], t['bb'][pA,pV,hA,hA], optimize=True)
	X['b'][pV,hA] += 1.0 * np.einsum('VW,uWvX,vXuY,YAUV->AU', gamma1['b'], h['ab'][a,A,a,A], lambdas['ab'], t['bb'][pA,pV,hA,hA], optimize=True)
	X['b'][pV,hA] += -1.0 * np.einsum('VW,uXvV,vYuX,WAUY->AU', gamma1['b'], h['ab'][a,A,a,A], lambdas['ab'], t['bb'][pA,pV,hA,hA], optimize=True)
	X['b'][pV,hA] += -1.0 * np.einsum('VW,IWUB,ABIV->AU', gamma1['b'], h['bb'][C,A,A,V], t['bb'][pV,pV,hC,hA], optimize=True)
	X['b'][pV,hA] += 1.0 * np.einsum('VW,WB,ABUV->AU', gamma1['b'], h['b'][A,V], t['bb'][pV,pV,hA,hA], optimize=True)
	X['b'][pV,hA] += -1.0 * np.einsum('VW,WXUY,uYvX,vAuV->AU', gamma1['b'], h['bb'][A,A,A,A], lambdas['ab'], t['ab'][pa,pV,ha,hA], optimize=True)
	X['b'][pV,hA] += 1.0 * np.einsum('VW,WXUY,YZXP,PAVZ->AU', gamma1['b'], h['bb'][A,A,A,A], lambdas['bb'], t['bb'][pA,pV,hA,hA], optimize=True)
	X['b'][pV,hA] += -0.5 * np.einsum('VW,WXYZ,YZXP,PAUV->AU', gamma1['b'], h['bb'][A,A,A,A], lambdas['bb'], t['bb'][pA,pV,hA,hA], optimize=True)
	X['b'][pV,hA] += -0.5 * np.einsum('VW,WABC,BCUV->AU', gamma1['b'], h['bb'][A,V,V,V], t['bb'][pV,pV,hA,hA], optimize=True)
	X['b'][pV,hA] += 0.25 * np.einsum('VW,XYUV,ZPXY,WAZP->AU', gamma1['b'], h['bb'][A,A,A,A], lambdas['bb'], t['bb'][pA,pV,hA,hA], optimize=True)
	X['b'][pV,hA] += 0.5 * np.einsum('VW,XYVZ,ZPXY,WAUP->AU', gamma1['b'], h['bb'][A,A,A,A], lambdas['bb'], t['bb'][pA,pV,hA,hA], optimize=True)
	X['b'][pV,hA] += 1.0 * np.einsum('ia,aAiU->AU', h['a'][c,v], t['ab'][pv,pV,hc,hA], optimize=True)
	X['b'][pV,hA] += 0.5 * np.einsum('iuvw,vwux,xAiU->AU', h['aa'][c,a,a,a], lambdas['aa'], t['ab'][pa,pV,hc,hA], optimize=True)
	X['b'][pV,hA] += -1.0 * np.einsum('iIaU,aAiI->AU', h['ab'][c,C,v,A], t['ab'][pv,pV,hc,hC], optimize=True)
	X['b'][pV,hA] += 1.0 * np.einsum('iVuU,uWvV,vAiW->AU', h['ab'][c,A,a,A], lambdas['ab'], t['ab'][pa,pV,hc,hA], optimize=True)
	X['b'][pV,hA] += -1.0 * np.einsum('iVuW,uWvV,vAiU->AU', h['ab'][c,A,a,A], lambdas['ab'], t['ab'][pa,pV,hc,hA], optimize=True)
	X['b'][pV,hA] += -0.5 * np.einsum('iAuU,uvwx,wxiv->AU', h['ab'][c,V,a,A], lambdas['aa'], t['aa'][pa,pa,hc,ha], optimize=True)
	X['b'][pV,hA] += -1.0 * np.einsum('iAuU,uVvW,vWiV->AU', h['ab'][c,V,a,A], lambdas['ab'], t['ab'][pa,pA,hc,hA], optimize=True)
	X['b'][pV,hA] += 1.0 * np.einsum('iAuV,uVvW,vWiU->AU', h['ab'][c,V,a,A], lambdas['ab'], t['ab'][pa,pA,hc,hA], optimize=True)
	X['b'][pV,hA] += 1.0 * np.einsum('iAaB,aBiU->AU', h['ab'][c,V,v,V], t['ab'][pv,pV,hc,hA], optimize=True)
	X['b'][pV,hA] += 0.5 * np.einsum('uvwa,wxuv,aAxU->AU', h['aa'][a,a,a,v], lambdas['aa'], t['ab'][pv,pV,ha,hA], optimize=True)
	X['b'][pV,hA] += -1.0 * np.einsum('uIvU,vwux,xAwI->AU', h['ab'][a,C,a,A], lambdas['aa'], t['ab'][pa,pV,ha,hC], optimize=True)
	X['b'][pV,hA] += 1.0 * np.einsum('uIvU,vVuW,WAIV->AU', h['ab'][a,C,a,A], lambdas['ab'], t['bb'][pA,pV,hC,hA], optimize=True)
	X['b'][pV,hA] += -1.0 * np.einsum('uIvV,vVuW,WAIU->AU', h['ab'][a,C,a,A], lambdas['ab'], t['bb'][pA,pV,hC,hA], optimize=True)
	X['b'][pV,hA] += 1.0 * np.einsum('uVvB,vWuV,ABUW->AU', h['ab'][a,A,a,V], lambdas['ab'], t['bb'][pV,pV,hA,hA], optimize=True)
	X['b'][pV,hA] += -1.0 * np.einsum('uVaU,vWuV,aAvW->AU', h['ab'][a,A,v,A], lambdas['ab'], t['ab'][pv,pV,ha,hA], optimize=True)
	X['b'][pV,hA] += 1.0 * np.einsum('uVaW,vWuV,aAvU->AU', h['ab'][a,A,v,A], lambdas['ab'], t['ab'][pv,pV,ha,hA], optimize=True)
	X['b'][pV,hA] += 1.0 * np.einsum('uAvB,vwux,xBwU->AU', h['ab'][a,V,a,V], lambdas['aa'], t['ab'][pa,pV,ha,hA], optimize=True)
	X['b'][pV,hA] += -1.0 * np.einsum('uAvB,vVuW,WBUV->AU', h['ab'][a,V,a,V], lambdas['ab'], t['bb'][pA,pV,hA,hA], optimize=True)
	X['b'][pV,hA] += -0.5 * np.einsum('uAaU,vwux,xavw->AU', h['ab'][a,V,v,A], lambdas['aa'], t['aa'][pa,pv,ha,ha], optimize=True)
	X['b'][pV,hA] += 1.0 * np.einsum('uAaU,vVuW,aWvV->AU', h['ab'][a,V,v,A], lambdas['ab'], t['ab'][pv,pA,ha,hA], optimize=True)
	X['b'][pV,hA] += -1.0 * np.einsum('uAaV,vVuW,aWvU->AU', h['ab'][a,V,v,A], lambdas['ab'], t['ab'][pv,pA,ha,hA], optimize=True)
	X['b'][pV,hA] += -1.0 * np.einsum('IB,ABIU->AU', h['b'][C,V], t['bb'][pV,pV,hC,hA], optimize=True)
	X['b'][pV,hA] += -0.5 * np.einsum('IJUB,ABIJ->AU', h['bb'][C,C,A,V], t['bb'][pV,pV,hC,hC], optimize=True)
	X['b'][pV,hA] += -1.0 * np.einsum('IVUW,uWvV,vAuI->AU', h['bb'][C,A,A,A], lambdas['ab'], t['ab'][pa,pV,ha,hC], optimize=True)
	X['b'][pV,hA] += 1.0 * np.einsum('IVUW,WXVY,YAIX->AU', h['bb'][C,A,A,A], lambdas['bb'], t['bb'][pA,pV,hC,hA], optimize=True)
	X['b'][pV,hA] += 0.5 * np.einsum('IVWX,WXVY,YAIU->AU', h['bb'][C,A,A,A], lambdas['bb'], t['bb'][pA,pV,hC,hA], optimize=True)
	X['b'][pV,hA] += 1.0 * np.einsum('IAUV,uVvW,vWuI->AU', h['bb'][C,V,A,A], lambdas['ab'], t['ab'][pa,pA,ha,hC], optimize=True)
	X['b'][pV,hA] += 0.5 * np.einsum('IAUV,VWXY,XYIW->AU', h['bb'][C,V,A,A], lambdas['bb'], t['bb'][pA,pA,hC,hA], optimize=True)
	X['b'][pV,hA] += 0.25 * np.einsum('IAVW,VWXY,XYIU->AU', h['bb'][C,V,A,A], lambdas['bb'], t['bb'][pA,pA,hC,hA], optimize=True)
	X['b'][pV,hA] += 0.5 * np.einsum('IABC,BCIU->AU', h['bb'][C,V,V,V], t['bb'][pV,pV,hC,hA], optimize=True)
	X['b'][pV,hA] += -0.25 * np.einsum('VWUB,XYVW,ABXY->AU', h['bb'][A,A,A,V], lambdas['bb'], t['bb'][pV,pV,hA,hA], optimize=True)
	X['b'][pV,hA] += 0.5 * np.einsum('VWXB,XYVW,ABUY->AU', h['bb'][A,A,A,V], lambdas['bb'], t['bb'][pV,pV,hA,hA], optimize=True)
	X['b'][pV,hA] += -1.0 * np.einsum('VAUB,uWvV,vBuW->AU', h['bb'][A,V,A,V], lambdas['ab'], t['ab'][pa,pV,ha,hA], optimize=True)
	X['b'][pV,hA] += 0.5 * np.einsum('VAUB,WXVY,YBWX->AU', h['bb'][A,V,A,V], lambdas['bb'], t['bb'][pA,pV,hA,hA], optimize=True)
	X['b'][pV,hA] += 1.0 * np.einsum('VAWB,uWvV,vBuU->AU', h['bb'][A,V,A,V], lambdas['ab'], t['ab'][pa,pV,ha,hA], optimize=True)
	X['b'][pV,hA] += -1.0 * np.einsum('VAWB,WXVY,YBUX->AU', h['bb'][A,V,A,V], lambdas['bb'], t['bb'][pA,pV,hA,hA], optimize=True)
	# C|A
	X['b'][pA,hC] += -1.0 * np.einsum('uv,wx,vw,xUuI->UI', eta1['a'], gamma1['a'], h['a'][a,a], t['ab'][pa,pA,ha,hC], optimize=True)
	X['b'][pA,hC] += 1.0 * np.einsum('uv,wx,xu,vUwI->UI', eta1['a'], gamma1['a'], h['a'][a,a], t['ab'][pa,pA,ha,hC], optimize=True)
	X['b'][pA,hC] += -1.0 * np.einsum('uv,wx,xJuI,vUwJ->UI', eta1['a'], gamma1['a'], h['ab'][a,C,a,C], t['ab'][pa,pA,ha,hC], optimize=True)
	X['b'][pA,hC] += 1.0 * np.einsum('uv,wx,xUuA,vAwI->UI', eta1['a'], gamma1['a'], h['ab'][a,A,a,V], t['ab'][pa,pV,ha,hC], optimize=True)
	X['b'][pA,hC] += 1.0 * np.einsum('uv,VW,wx,vUwV,xWuI->UI', eta1['a'], gamma1['b'], gamma1['a'], h['ab'][a,A,a,A], t['ab'][pa,pA,ha,hC], optimize=True)
	X['b'][pA,hC] += -1.0 * np.einsum('uv,VW,iWuI,vUiV->UI', eta1['a'], gamma1['b'], h['ab'][c,A,a,C], t['ab'][pa,pA,hc,hA], optimize=True)
	X['b'][pA,hC] += 1.0 * np.einsum('uv,iu,vUiI->UI', eta1['a'], h['a'][c,a], t['ab'][pa,pA,hc,hC], optimize=True)
	X['b'][pA,hC] += -1.0 * np.einsum('uv,iJuI,vUiJ->UI', eta1['a'], h['ab'][c,C,a,C], t['ab'][pa,pA,hc,hC], optimize=True)
	X['b'][pA,hC] += 1.0 * np.einsum('uv,iUuA,vAiI->UI', eta1['a'], h['ab'][c,A,a,V], t['ab'][pa,pV,hc,hC], optimize=True)
	X['b'][pA,hC] += 0.5 * np.einsum('uv,vwxy,xywz,zUuI->UI', eta1['a'], h['aa'][a,a,a,a], lambdas['aa'], t['ab'][pa,pA,ha,hC], optimize=True)
	X['b'][pA,hC] += 1.0 * np.einsum('uv,vUwV,wVxW,xWuI->UI', eta1['a'], h['ab'][a,A,a,A], lambdas['ab'], t['ab'][pa,pA,ha,hC], optimize=True)
	X['b'][pA,hC] += -1.0 * np.einsum('uv,vVwW,wWxV,xUuI->UI', eta1['a'], h['ab'][a,A,a,A], lambdas['ab'], t['ab'][pa,pA,ha,hC], optimize=True)
	X['b'][pA,hC] += -0.5 * np.einsum('uv,wxuy,yzwx,vUzI->UI', eta1['a'], h['aa'][a,a,a,a], lambdas['aa'], t['ab'][pa,pA,ha,hC], optimize=True)
	X['b'][pA,hC] += -1.0 * np.einsum('uv,wUuV,xVwW,vWxI->UI', eta1['a'], h['ab'][a,A,a,A], lambdas['ab'], t['ab'][pa,pA,ha,hC], optimize=True)
	X['b'][pA,hC] += 1.0 * np.einsum('uv,wVuW,xWwV,vUxI->UI', eta1['a'], h['ab'][a,A,a,A], lambdas['ab'], t['ab'][pa,pA,ha,hC], optimize=True)
	X['b'][pA,hC] += 1.0 * np.einsum('VW,uv,wx,xUuV,vWwI->UI', eta1['b'], eta1['a'], gamma1['a'], h['ab'][a,A,a,A], t['ab'][pa,pA,ha,hC], optimize=True)
	X['b'][pA,hC] += 1.0 * np.einsum('VW,uv,iUuV,vWiI->UI', eta1['b'], eta1['a'], h['ab'][c,A,a,A], t['ab'][pa,pA,hc,hC], optimize=True)
	X['b'][pA,hC] += 0.5 * np.einsum('VW,XY,ZP,UPVX,WYIZ->UI', eta1['b'], eta1['b'], gamma1['b'], h['bb'][A,A,A,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['b'][pA,hC] += -0.5 * np.einsum('VW,XY,JUVX,WYIJ->UI', eta1['b'], eta1['b'], h['bb'][C,A,A,A], t['bb'][pA,pA,hC,hC], optimize=True)
	X['b'][pA,hC] += 1.0 * np.einsum('VW,uv,vUaV,aWuI->UI', eta1['b'], gamma1['a'], h['ab'][a,A,v,A], t['ab'][pv,pA,ha,hC], optimize=True)
	X['b'][pA,hC] += 0.5 * np.einsum('VW,XY,ZP,UWXZ,YPIV->UI', eta1['b'], gamma1['b'], gamma1['b'], h['bb'][A,A,A,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['b'][pA,hC] += -1.0 * np.einsum('VW,XY,JYIV,UWJX->UI', eta1['b'], gamma1['b'], h['bb'][C,A,C,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['b'][pA,hC] += 1.0 * np.einsum('VW,XY,UYVA,WAIX->UI', eta1['b'], gamma1['b'], h['bb'][A,A,A,V], t['bb'][pA,pV,hC,hA], optimize=True)
	X['b'][pA,hC] += -1.0 * np.einsum('VW,XY,WX,UYIV->UI', eta1['b'], gamma1['b'], h['b'][A,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['b'][pA,hC] += 1.0 * np.einsum('VW,XY,YV,UWIX->UI', eta1['b'], gamma1['b'], h['b'][A,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['b'][pA,hC] += 1.0 * np.einsum('VW,iUaV,aWiI->UI', eta1['b'], h['ab'][c,A,v,A], t['ab'][pv,pA,hc,hC], optimize=True)
	X['b'][pA,hC] += 1.0 * np.einsum('VW,uUvV,vwux,xWwI->UI', eta1['b'], h['ab'][a,A,a,A], lambdas['aa'], t['ab'][pa,pA,ha,hC], optimize=True)
	X['b'][pA,hC] += 1.0 * np.einsum('VW,uUvV,vXuY,WYIX->UI', eta1['b'], h['ab'][a,A,a,A], lambdas['ab'], t['bb'][pA,pA,hC,hA], optimize=True)
	X['b'][pA,hC] += -1.0 * np.einsum('VW,uWvX,vXuY,UYIV->UI', eta1['b'], h['ab'][a,A,a,A], lambdas['ab'], t['bb'][pA,pA,hC,hA], optimize=True)
	X['b'][pA,hC] += 1.0 * np.einsum('VW,uXvV,vYuX,UWIY->UI', eta1['b'], h['ab'][a,A,a,A], lambdas['ab'], t['bb'][pA,pA,hC,hA], optimize=True)
	X['b'][pA,hC] += 1.0 * np.einsum('VW,JV,UWIJ->UI', eta1['b'], h['b'][C,A], t['bb'][pA,pA,hC,hC], optimize=True)
	X['b'][pA,hC] += -0.5 * np.einsum('VW,JKIV,UWJK->UI', eta1['b'], h['bb'][C,C,C,A], t['bb'][pA,pA,hC,hC], optimize=True)
	X['b'][pA,hC] += -1.0 * np.einsum('VW,JUVA,WAIJ->UI', eta1['b'], h['bb'][C,A,A,V], t['bb'][pA,pV,hC,hC], optimize=True)
	X['b'][pA,hC] += 0.25 * np.einsum('VW,UWXY,XYZP,ZPIV->UI', eta1['b'], h['bb'][A,A,A,A], lambdas['bb'], t['bb'][pA,pA,hC,hA], optimize=True)
	X['b'][pA,hC] += 1.0 * np.einsum('VW,UXVY,uYvX,vWuI->UI', eta1['b'], h['bb'][A,A,A,A], lambdas['ab'], t['ab'][pa,pA,ha,hC], optimize=True)
	X['b'][pA,hC] += 1.0 * np.einsum('VW,UXVY,YZXP,WPIZ->UI', eta1['b'], h['bb'][A,A,A,A], lambdas['bb'], t['bb'][pA,pA,hC,hA], optimize=True)
	X['b'][pA,hC] += 0.5 * np.einsum('VW,WXYZ,YZXP,UPIV->UI', eta1['b'], h['bb'][A,A,A,A], lambdas['bb'], t['bb'][pA,pA,hC,hA], optimize=True)
	X['b'][pA,hC] += -0.5 * np.einsum('VW,XYVZ,ZPXY,UWIP->UI', eta1['b'], h['bb'][A,A,A,A], lambdas['bb'], t['bb'][pA,pA,hC,hA], optimize=True)
	X['b'][pA,hC] += 1.0 * np.einsum('uv,va,aUuI->UI', gamma1['a'], h['a'][a,v], t['ab'][pv,pA,ha,hC], optimize=True)
	X['b'][pA,hC] += 0.5 * np.einsum('uv,vwxy,xywz,zUuI->UI', gamma1['a'], h['aa'][a,a,a,a], lambdas['aa'], t['ab'][pa,pA,ha,hC], optimize=True)
	X['b'][pA,hC] += -1.0 * np.einsum('uv,vJaI,aUuJ->UI', gamma1['a'], h['ab'][a,C,v,C], t['ab'][pv,pA,ha,hC], optimize=True)
	X['b'][pA,hC] += 1.0 * np.einsum('uv,vUwV,wVxW,xWuI->UI', gamma1['a'], h['ab'][a,A,a,A], lambdas['ab'], t['ab'][pa,pA,ha,hC], optimize=True)
	X['b'][pA,hC] += 1.0 * np.einsum('uv,vUaA,aAuI->UI', gamma1['a'], h['ab'][a,A,v,V], t['ab'][pv,pV,ha,hC], optimize=True)
	X['b'][pA,hC] += -1.0 * np.einsum('uv,vVwW,wWxV,xUuI->UI', gamma1['a'], h['ab'][a,A,a,A], lambdas['ab'], t['ab'][pa,pA,ha,hC], optimize=True)
	X['b'][pA,hC] += -0.5 * np.einsum('uv,wxuy,yzwx,vUzI->UI', gamma1['a'], h['aa'][a,a,a,a], lambdas['aa'], t['ab'][pa,pA,ha,hC], optimize=True)
	X['b'][pA,hC] += -1.0 * np.einsum('uv,wUuV,xVwW,vWxI->UI', gamma1['a'], h['ab'][a,A,a,A], lambdas['ab'], t['ab'][pa,pA,ha,hC], optimize=True)
	X['b'][pA,hC] += 1.0 * np.einsum('uv,wVuW,xWwV,vUxI->UI', gamma1['a'], h['ab'][a,A,a,A], lambdas['ab'], t['ab'][pa,pA,ha,hC], optimize=True)
	X['b'][pA,hC] += -1.0 * np.einsum('VW,uv,vWaI,aUuV->UI', gamma1['b'], gamma1['a'], h['ab'][a,A,v,C], t['ab'][pv,pA,ha,hA], optimize=True)
	X['b'][pA,hC] += -0.5 * np.einsum('VW,XY,WYIA,UAVX->UI', gamma1['b'], gamma1['b'], h['bb'][A,A,C,V], t['bb'][pA,pV,hA,hA], optimize=True)
	X['b'][pA,hC] += -1.0 * np.einsum('VW,iWaI,aUiV->UI', gamma1['b'], h['ab'][c,A,v,C], t['ab'][pv,pA,hc,hA], optimize=True)
	X['b'][pA,hC] += 1.0 * np.einsum('VW,uUvV,vwux,xWwI->UI', gamma1['b'], h['ab'][a,A,a,A], lambdas['aa'], t['ab'][pa,pA,ha,hC], optimize=True)
	X['b'][pA,hC] += 1.0 * np.einsum('VW,uUvV,vXuY,WYIX->UI', gamma1['b'], h['ab'][a,A,a,A], lambdas['ab'], t['bb'][pA,pA,hC,hA], optimize=True)
	X['b'][pA,hC] += -1.0 * np.einsum('VW,uWvX,vXuY,UYIV->UI', gamma1['b'], h['ab'][a,A,a,A], lambdas['ab'], t['bb'][pA,pA,hC,hA], optimize=True)
	X['b'][pA,hC] += 1.0 * np.einsum('VW,uXvV,vYuX,UWIY->UI', gamma1['b'], h['ab'][a,A,a,A], lambdas['ab'], t['bb'][pA,pA,hC,hA], optimize=True)
	X['b'][pA,hC] += -1.0 * np.einsum('VW,JWIA,UAJV->UI', gamma1['b'], h['bb'][C,A,C,V], t['bb'][pA,pV,hC,hA], optimize=True)
	X['b'][pA,hC] += 0.25 * np.einsum('VW,UWXY,XYZP,ZPIV->UI', gamma1['b'], h['bb'][A,A,A,A], lambdas['bb'], t['bb'][pA,pA,hC,hA], optimize=True)
	X['b'][pA,hC] += 0.5 * np.einsum('VW,UWAB,ABIV->UI', gamma1['b'], h['bb'][A,A,V,V], t['bb'][pV,pV,hC,hA], optimize=True)
	X['b'][pA,hC] += 1.0 * np.einsum('VW,UXVY,uYvX,vWuI->UI', gamma1['b'], h['bb'][A,A,A,A], lambdas['ab'], t['ab'][pa,pA,ha,hC], optimize=True)
	X['b'][pA,hC] += 1.0 * np.einsum('VW,UXVY,YZXP,WPIZ->UI', gamma1['b'], h['bb'][A,A,A,A], lambdas['bb'], t['bb'][pA,pA,hC,hA], optimize=True)
	X['b'][pA,hC] += 1.0 * np.einsum('VW,WA,UAIV->UI', gamma1['b'], h['b'][A,V], t['bb'][pA,pV,hC,hA], optimize=True)
	X['b'][pA,hC] += 0.5 * np.einsum('VW,WXYZ,YZXP,UPIV->UI', gamma1['b'], h['bb'][A,A,A,A], lambdas['bb'], t['bb'][pA,pA,hC,hA], optimize=True)
	X['b'][pA,hC] += -0.5 * np.einsum('VW,XYVZ,ZPXY,UWIP->UI', gamma1['b'], h['bb'][A,A,A,A], lambdas['bb'], t['bb'][pA,pA,hC,hA], optimize=True)
	X['b'][pA,hC] += 1.0 * np.einsum('ia,aUiI->UI', h['a'][c,v], t['ab'][pv,pA,hc,hC], optimize=True)
	X['b'][pA,hC] += 0.5 * np.einsum('iuvw,vwux,xUiI->UI', h['aa'][c,a,a,a], lambdas['aa'], t['ab'][pa,pA,hc,hC], optimize=True)
	X['b'][pA,hC] += -1.0 * np.einsum('iJaI,aUiJ->UI', h['ab'][c,C,v,C], t['ab'][pv,pA,hc,hC], optimize=True)
	X['b'][pA,hC] += -0.5 * np.einsum('iUuI,uvwx,wxiv->UI', h['ab'][c,A,a,C], lambdas['aa'], t['aa'][pa,pa,hc,ha], optimize=True)
	X['b'][pA,hC] += -1.0 * np.einsum('iUuI,uVvW,vWiV->UI', h['ab'][c,A,a,C], lambdas['ab'], t['ab'][pa,pA,hc,hA], optimize=True)
	X['b'][pA,hC] += 1.0 * np.einsum('iUuV,uVvW,vWiI->UI', h['ab'][c,A,a,A], lambdas['ab'], t['ab'][pa,pA,hc,hC], optimize=True)
	X['b'][pA,hC] += 1.0 * np.einsum('iUaA,aAiI->UI', h['ab'][c,A,v,V], t['ab'][pv,pV,hc,hC], optimize=True)
	X['b'][pA,hC] += 1.0 * np.einsum('iVuI,uWvV,vUiW->UI', h['ab'][c,A,a,C], lambdas['ab'], t['ab'][pa,pA,hc,hA], optimize=True)
	X['b'][pA,hC] += -1.0 * np.einsum('iVuW,uWvV,vUiI->UI', h['ab'][c,A,a,A], lambdas['ab'], t['ab'][pa,pA,hc,hC], optimize=True)
	X['b'][pA,hC] += 0.5 * np.einsum('uvwa,wxuv,aUxI->UI', h['aa'][a,a,a,v], lambdas['aa'], t['ab'][pv,pA,ha,hC], optimize=True)
	X['b'][pA,hC] += -1.0 * np.einsum('uJvI,vwux,xUwJ->UI', h['ab'][a,C,a,C], lambdas['aa'], t['ab'][pa,pA,ha,hC], optimize=True)
	X['b'][pA,hC] += -1.0 * np.einsum('uJvI,vVuW,UWJV->UI', h['ab'][a,C,a,C], lambdas['ab'], t['bb'][pA,pA,hC,hA], optimize=True)
	X['b'][pA,hC] += -1.0 * np.einsum('uJvV,vVuW,UWIJ->UI', h['ab'][a,C,a,A], lambdas['ab'], t['bb'][pA,pA,hC,hC], optimize=True)
	X['b'][pA,hC] += 1.0 * np.einsum('uUvA,vwux,xAwI->UI', h['ab'][a,A,a,V], lambdas['aa'], t['ab'][pa,pV,ha,hC], optimize=True)
	X['b'][pA,hC] += -1.0 * np.einsum('uUvA,vVuW,WAIV->UI', h['ab'][a,A,a,V], lambdas['ab'], t['bb'][pA,pV,hC,hA], optimize=True)
	X['b'][pA,hC] += -0.5 * np.einsum('uUaI,vwux,xavw->UI', h['ab'][a,A,v,C], lambdas['aa'], t['aa'][pa,pv,ha,ha], optimize=True)
	X['b'][pA,hC] += 1.0 * np.einsum('uUaI,vVuW,aWvV->UI', h['ab'][a,A,v,C], lambdas['ab'], t['ab'][pv,pA,ha,hA], optimize=True)
	X['b'][pA,hC] += -1.0 * np.einsum('uUaV,vVuW,aWvI->UI', h['ab'][a,A,v,A], lambdas['ab'], t['ab'][pv,pA,ha,hC], optimize=True)
	X['b'][pA,hC] += 1.0 * np.einsum('uVvA,vWuV,UAIW->UI', h['ab'][a,A,a,V], lambdas['ab'], t['bb'][pA,pV,hC,hA], optimize=True)
	X['b'][pA,hC] += -1.0 * np.einsum('uVaI,vWuV,aUvW->UI', h['ab'][a,A,v,C], lambdas['ab'], t['ab'][pv,pA,ha,hA], optimize=True)
	X['b'][pA,hC] += 1.0 * np.einsum('uVaW,vWuV,aUvI->UI', h['ab'][a,A,v,A], lambdas['ab'], t['ab'][pv,pA,ha,hC], optimize=True)
	X['b'][pA,hC] += 1.0 * np.einsum('JA,UAIJ->UI', h['b'][C,V], t['bb'][pA,pV,hC,hC], optimize=True)
	X['b'][pA,hC] += -0.5 * np.einsum('JKIA,UAJK->UI', h['bb'][C,C,C,V], t['bb'][pA,pV,hC,hC], optimize=True)
	X['b'][pA,hC] += 1.0 * np.einsum('JUIV,uVvW,vWuJ->UI', h['bb'][C,A,C,A], lambdas['ab'], t['ab'][pa,pA,ha,hC], optimize=True)
	X['b'][pA,hC] += 0.5 * np.einsum('JUIV,VWXY,XYJW->UI', h['bb'][C,A,C,A], lambdas['bb'], t['bb'][pA,pA,hC,hA], optimize=True)
	X['b'][pA,hC] += -0.25 * np.einsum('JUVW,VWXY,XYIJ->UI', h['bb'][C,A,A,A], lambdas['bb'], t['bb'][pA,pA,hC,hC], optimize=True)
	X['b'][pA,hC] += -0.5 * np.einsum('JUAB,ABIJ->UI', h['bb'][C,A,V,V], t['bb'][pV,pV,hC,hC], optimize=True)
	X['b'][pA,hC] += -1.0 * np.einsum('JVIW,uWvV,vUuJ->UI', h['bb'][C,A,C,A], lambdas['ab'], t['ab'][pa,pA,ha,hC], optimize=True)
	X['b'][pA,hC] += -1.0 * np.einsum('JVIW,WXVY,UYJX->UI', h['bb'][C,A,C,A], lambdas['bb'], t['bb'][pA,pA,hC,hA], optimize=True)
	X['b'][pA,hC] += 0.5 * np.einsum('JVWX,WXVY,UYIJ->UI', h['bb'][C,A,A,A], lambdas['bb'], t['bb'][pA,pA,hC,hC], optimize=True)
	X['b'][pA,hC] += 1.0 * np.einsum('UVIA,uWvV,vAuW->UI', h['bb'][A,A,C,V], lambdas['ab'], t['ab'][pa,pV,ha,hA], optimize=True)
	X['b'][pA,hC] += -0.5 * np.einsum('UVIA,WXVY,YAWX->UI', h['bb'][A,A,C,V], lambdas['bb'], t['bb'][pA,pV,hA,hA], optimize=True)
	X['b'][pA,hC] += -1.0 * np.einsum('UVWA,uWvV,vAuI->UI', h['bb'][A,A,A,V], lambdas['ab'], t['ab'][pa,pV,ha,hC], optimize=True)
	X['b'][pA,hC] += 1.0 * np.einsum('UVWA,WXVY,YAIX->UI', h['bb'][A,A,A,V], lambdas['bb'], t['bb'][pA,pV,hC,hA], optimize=True)
	X['b'][pA,hC] += -0.25 * np.einsum('VWIA,XYVW,UAXY->UI', h['bb'][A,A,C,V], lambdas['bb'], t['bb'][pA,pV,hA,hA], optimize=True)
	X['b'][pA,hC] += 0.5 * np.einsum('VWXA,XYVW,UAIY->UI', h['bb'][A,A,A,V], lambdas['bb'], t['bb'][pA,pV,hC,hA], optimize=True)
	# C|V
	X['b'][pV,hC] += -1.0 * np.einsum('uv,wx,vw,xAuI->AI', eta1['a'], gamma1['a'], h['a'][a,a], t['ab'][pa,pV,ha,hC], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('uv,wx,xu,vAwI->AI', eta1['a'], gamma1['a'], h['a'][a,a], t['ab'][pa,pV,ha,hC], optimize=True)
	X['b'][pV,hC] += -1.0 * np.einsum('uv,wx,xJuI,vAwJ->AI', eta1['a'], gamma1['a'], h['ab'][a,C,a,C], t['ab'][pa,pV,ha,hC], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('uv,wx,xAuB,vBwI->AI', eta1['a'], gamma1['a'], h['ab'][a,V,a,V], t['ab'][pa,pV,ha,hC], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('uv,UV,wx,vAwU,xVuI->AI', eta1['a'], gamma1['b'], gamma1['a'], h['ab'][a,V,a,A], t['ab'][pa,pA,ha,hC], optimize=True)
	X['b'][pV,hC] += -1.0 * np.einsum('uv,UV,wx,xVuI,vAwU->AI', eta1['a'], gamma1['b'], gamma1['a'], h['ab'][a,A,a,C], t['ab'][pa,pV,ha,hA], optimize=True)
	X['b'][pV,hC] += -1.0 * np.einsum('uv,UV,iVuI,vAiU->AI', eta1['a'], gamma1['b'], h['ab'][c,A,a,C], t['ab'][pa,pV,hc,hA], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('uv,iu,vAiI->AI', eta1['a'], h['a'][c,a], t['ab'][pa,pV,hc,hC], optimize=True)
	X['b'][pV,hC] += -1.0 * np.einsum('uv,iJuI,vAiJ->AI', eta1['a'], h['ab'][c,C,a,C], t['ab'][pa,pV,hc,hC], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('uv,iAuB,vBiI->AI', eta1['a'], h['ab'][c,V,a,V], t['ab'][pa,pV,hc,hC], optimize=True)
	X['b'][pV,hC] += 0.5 * np.einsum('uv,vwxy,xywz,zAuI->AI', eta1['a'], h['aa'][a,a,a,a], lambdas['aa'], t['ab'][pa,pV,ha,hC], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('uv,vUwI,wVxU,xAuV->AI', eta1['a'], h['ab'][a,A,a,C], lambdas['ab'], t['ab'][pa,pV,ha,hA], optimize=True)
	X['b'][pV,hC] += -1.0 * np.einsum('uv,vUwV,wVxU,xAuI->AI', eta1['a'], h['ab'][a,A,a,A], lambdas['ab'], t['ab'][pa,pV,ha,hC], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('uv,vAwU,wUxV,xVuI->AI', eta1['a'], h['ab'][a,V,a,A], lambdas['ab'], t['ab'][pa,pA,ha,hC], optimize=True)
	X['b'][pV,hC] += -0.5 * np.einsum('uv,wxuy,yzwx,vAzI->AI', eta1['a'], h['aa'][a,a,a,a], lambdas['aa'], t['ab'][pa,pV,ha,hC], optimize=True)
	X['b'][pV,hC] += -1.0 * np.einsum('uv,wUuI,xVwU,vAxV->AI', eta1['a'], h['ab'][a,A,a,C], lambdas['ab'], t['ab'][pa,pV,ha,hA], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('uv,wUuV,xVwU,vAxI->AI', eta1['a'], h['ab'][a,A,a,A], lambdas['ab'], t['ab'][pa,pV,ha,hC], optimize=True)
	X['b'][pV,hC] += -1.0 * np.einsum('uv,wAuU,xUwV,vVxI->AI', eta1['a'], h['ab'][a,V,a,A], lambdas['ab'], t['ab'][pa,pA,ha,hC], optimize=True)
	X['b'][pV,hC] += -1.0 * np.einsum('UV,uv,wx,vVwI,xAuU->AI', eta1['b'], eta1['a'], gamma1['a'], h['ab'][a,A,a,C], t['ab'][pa,pV,ha,hA], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('UV,uv,wx,xAuU,vVwI->AI', eta1['b'], eta1['a'], gamma1['a'], h['ab'][a,V,a,A], t['ab'][pa,pA,ha,hC], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('UV,uv,iAuU,vViI->AI', eta1['b'], eta1['a'], h['ab'][c,V,a,A], t['ab'][pa,pA,hc,hC], optimize=True)
	X['b'][pV,hC] += 0.5 * np.einsum('UV,WX,YZ,VXIY,ZAUW->AI', eta1['b'], eta1['b'], gamma1['b'], h['bb'][A,A,C,A], t['bb'][pA,pV,hA,hA], optimize=True)
	X['b'][pV,hC] += -0.5 * np.einsum('UV,WX,YZ,ZAUW,VXIY->AI', eta1['b'], eta1['b'], gamma1['b'], h['bb'][A,V,A,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['b'][pV,hC] += -0.5 * np.einsum('UV,WX,JAUW,VXIJ->AI', eta1['b'], eta1['b'], h['bb'][C,V,A,A], t['bb'][pA,pA,hC,hC], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('UV,uv,vAaU,aVuI->AI', eta1['b'], gamma1['a'], h['ab'][a,V,v,A], t['ab'][pv,pA,ha,hC], optimize=True)
	X['b'][pV,hC] += -0.5 * np.einsum('UV,WX,YZ,VAWY,XZIU->AI', eta1['b'], gamma1['b'], gamma1['b'], h['bb'][A,V,A,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['b'][pV,hC] += 0.5 * np.einsum('UV,WX,YZ,XZIU,VAWY->AI', eta1['b'], gamma1['b'], gamma1['b'], h['bb'][A,A,C,A], t['bb'][pA,pV,hA,hA], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('UV,WX,JXIU,VAJW->AI', eta1['b'], gamma1['b'], h['bb'][C,A,C,A], t['bb'][pA,pV,hC,hA], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('UV,WX,VW,XAIU->AI', eta1['b'], gamma1['b'], h['b'][A,A], t['bb'][pA,pV,hC,hA], optimize=True)
	X['b'][pV,hC] += -1.0 * np.einsum('UV,WX,XU,VAIW->AI', eta1['b'], gamma1['b'], h['b'][A,A], t['bb'][pA,pV,hC,hA], optimize=True)
	X['b'][pV,hC] += -1.0 * np.einsum('UV,WX,XAUB,VBIW->AI', eta1['b'], gamma1['b'], h['bb'][A,V,A,V], t['bb'][pA,pV,hC,hA], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('UV,iAaU,aViI->AI', eta1['b'], h['ab'][c,V,v,A], t['ab'][pv,pA,hc,hC], optimize=True)
	X['b'][pV,hC] += -1.0 * np.einsum('UV,uVvI,vwux,xAwU->AI', eta1['b'], h['ab'][a,A,a,C], lambdas['aa'], t['ab'][pa,pV,ha,hA], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('UV,uVvI,vWuX,XAUW->AI', eta1['b'], h['ab'][a,A,a,C], lambdas['ab'], t['bb'][pA,pV,hA,hA], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('UV,uVvW,vWuX,XAIU->AI', eta1['b'], h['ab'][a,A,a,A], lambdas['ab'], t['bb'][pA,pV,hC,hA], optimize=True)
	X['b'][pV,hC] += -1.0 * np.einsum('UV,uWvU,vXuW,VAIX->AI', eta1['b'], h['ab'][a,A,a,A], lambdas['ab'], t['bb'][pA,pV,hC,hA], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('UV,uAvU,vwux,xVwI->AI', eta1['b'], h['ab'][a,V,a,A], lambdas['aa'], t['ab'][pa,pA,ha,hC], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('UV,uAvU,vWuX,VXIW->AI', eta1['b'], h['ab'][a,V,a,A], lambdas['ab'], t['bb'][pA,pA,hC,hA], optimize=True)
	X['b'][pV,hC] += -1.0 * np.einsum('UV,JU,VAIJ->AI', eta1['b'], h['b'][C,A], t['bb'][pA,pV,hC,hC], optimize=True)
	X['b'][pV,hC] += 0.5 * np.einsum('UV,JKIU,VAJK->AI', eta1['b'], h['bb'][C,C,C,A], t['bb'][pA,pV,hC,hC], optimize=True)
	X['b'][pV,hC] += -1.0 * np.einsum('UV,JAUB,VBIJ->AI', eta1['b'], h['bb'][C,V,A,V], t['bb'][pA,pV,hC,hC], optimize=True)
	X['b'][pV,hC] += -1.0 * np.einsum('UV,VWIX,uXvW,vAuU->AI', eta1['b'], h['bb'][A,A,C,A], lambdas['ab'], t['ab'][pa,pV,ha,hA], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('UV,VWIX,XYWZ,ZAUY->AI', eta1['b'], h['bb'][A,A,C,A], lambdas['bb'], t['bb'][pA,pV,hA,hA], optimize=True)
	X['b'][pV,hC] += -0.5 * np.einsum('UV,VWXY,XYWZ,ZAIU->AI', eta1['b'], h['bb'][A,A,A,A], lambdas['bb'], t['bb'][pA,pV,hC,hA], optimize=True)
	X['b'][pV,hC] += -0.25 * np.einsum('UV,VAWX,WXYZ,YZIU->AI', eta1['b'], h['bb'][A,V,A,A], lambdas['bb'], t['bb'][pA,pA,hC,hA], optimize=True)
	X['b'][pV,hC] += 0.25 * np.einsum('UV,WXIU,YZWX,VAYZ->AI', eta1['b'], h['bb'][A,A,C,A], lambdas['bb'], t['bb'][pA,pV,hA,hA], optimize=True)
	X['b'][pV,hC] += 0.5 * np.einsum('UV,WXUY,YZWX,VAIZ->AI', eta1['b'], h['bb'][A,A,A,A], lambdas['bb'], t['bb'][pA,pV,hC,hA], optimize=True)
	X['b'][pV,hC] += -1.0 * np.einsum('UV,WAUX,uXvW,vVuI->AI', eta1['b'], h['bb'][A,V,A,A], lambdas['ab'], t['ab'][pa,pA,ha,hC], optimize=True)
	X['b'][pV,hC] += -1.0 * np.einsum('UV,WAUX,XYWZ,VZIY->AI', eta1['b'], h['bb'][A,V,A,A], lambdas['bb'], t['bb'][pA,pA,hC,hA], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('uv,va,aAuI->AI', gamma1['a'], h['a'][a,v], t['ab'][pv,pV,ha,hC], optimize=True)
	X['b'][pV,hC] += 0.5 * np.einsum('uv,vwxy,xywz,zAuI->AI', gamma1['a'], h['aa'][a,a,a,a], lambdas['aa'], t['ab'][pa,pV,ha,hC], optimize=True)
	X['b'][pV,hC] += -1.0 * np.einsum('uv,vJaI,aAuJ->AI', gamma1['a'], h['ab'][a,C,v,C], t['ab'][pv,pV,ha,hC], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('uv,vUwI,wVxU,xAuV->AI', gamma1['a'], h['ab'][a,A,a,C], lambdas['ab'], t['ab'][pa,pV,ha,hA], optimize=True)
	X['b'][pV,hC] += -1.0 * np.einsum('uv,vUwV,wVxU,xAuI->AI', gamma1['a'], h['ab'][a,A,a,A], lambdas['ab'], t['ab'][pa,pV,ha,hC], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('uv,vAwU,wUxV,xVuI->AI', gamma1['a'], h['ab'][a,V,a,A], lambdas['ab'], t['ab'][pa,pA,ha,hC], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('uv,vAaB,aBuI->AI', gamma1['a'], h['ab'][a,V,v,V], t['ab'][pv,pV,ha,hC], optimize=True)
	X['b'][pV,hC] += -0.5 * np.einsum('uv,wxuy,yzwx,vAzI->AI', gamma1['a'], h['aa'][a,a,a,a], lambdas['aa'], t['ab'][pa,pV,ha,hC], optimize=True)
	X['b'][pV,hC] += -1.0 * np.einsum('uv,wUuI,xVwU,vAxV->AI', gamma1['a'], h['ab'][a,A,a,C], lambdas['ab'], t['ab'][pa,pV,ha,hA], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('uv,wUuV,xVwU,vAxI->AI', gamma1['a'], h['ab'][a,A,a,A], lambdas['ab'], t['ab'][pa,pV,ha,hC], optimize=True)
	X['b'][pV,hC] += -1.0 * np.einsum('uv,wAuU,xUwV,vVxI->AI', gamma1['a'], h['ab'][a,V,a,A], lambdas['ab'], t['ab'][pa,pA,ha,hC], optimize=True)
	X['b'][pV,hC] += -1.0 * np.einsum('UV,uv,vVaI,aAuU->AI', gamma1['b'], gamma1['a'], h['ab'][a,A,v,C], t['ab'][pv,pV,ha,hA], optimize=True)
	X['b'][pV,hC] += -0.5 * np.einsum('UV,WX,VXIB,ABUW->AI', gamma1['b'], gamma1['b'], h['bb'][A,A,C,V], t['bb'][pV,pV,hA,hA], optimize=True)
	X['b'][pV,hC] += -1.0 * np.einsum('UV,iVaI,aAiU->AI', gamma1['b'], h['ab'][c,A,v,C], t['ab'][pv,pV,hc,hA], optimize=True)
	X['b'][pV,hC] += -1.0 * np.einsum('UV,uVvI,vwux,xAwU->AI', gamma1['b'], h['ab'][a,A,a,C], lambdas['aa'], t['ab'][pa,pV,ha,hA], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('UV,uVvI,vWuX,XAUW->AI', gamma1['b'], h['ab'][a,A,a,C], lambdas['ab'], t['bb'][pA,pV,hA,hA], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('UV,uVvW,vWuX,XAIU->AI', gamma1['b'], h['ab'][a,A,a,A], lambdas['ab'], t['bb'][pA,pV,hC,hA], optimize=True)
	X['b'][pV,hC] += -1.0 * np.einsum('UV,uWvU,vXuW,VAIX->AI', gamma1['b'], h['ab'][a,A,a,A], lambdas['ab'], t['bb'][pA,pV,hC,hA], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('UV,uAvU,vwux,xVwI->AI', gamma1['b'], h['ab'][a,V,a,A], lambdas['aa'], t['ab'][pa,pA,ha,hC], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('UV,uAvU,vWuX,VXIW->AI', gamma1['b'], h['ab'][a,V,a,A], lambdas['ab'], t['bb'][pA,pA,hC,hA], optimize=True)
	X['b'][pV,hC] += -1.0 * np.einsum('UV,JVIB,ABJU->AI', gamma1['b'], h['bb'][C,A,C,V], t['bb'][pV,pV,hC,hA], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('UV,VB,ABIU->AI', gamma1['b'], h['b'][A,V], t['bb'][pV,pV,hC,hA], optimize=True)
	X['b'][pV,hC] += -1.0 * np.einsum('UV,VWIX,uXvW,vAuU->AI', gamma1['b'], h['bb'][A,A,C,A], lambdas['ab'], t['ab'][pa,pV,ha,hA], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('UV,VWIX,XYWZ,ZAUY->AI', gamma1['b'], h['bb'][A,A,C,A], lambdas['bb'], t['bb'][pA,pV,hA,hA], optimize=True)
	X['b'][pV,hC] += -0.5 * np.einsum('UV,VWXY,XYWZ,ZAIU->AI', gamma1['b'], h['bb'][A,A,A,A], lambdas['bb'], t['bb'][pA,pV,hC,hA], optimize=True)
	X['b'][pV,hC] += -0.25 * np.einsum('UV,VAWX,WXYZ,YZIU->AI', gamma1['b'], h['bb'][A,V,A,A], lambdas['bb'], t['bb'][pA,pA,hC,hA], optimize=True)
	X['b'][pV,hC] += -0.5 * np.einsum('UV,VABC,BCIU->AI', gamma1['b'], h['bb'][A,V,V,V], t['bb'][pV,pV,hC,hA], optimize=True)
	X['b'][pV,hC] += 0.25 * np.einsum('UV,WXIU,YZWX,VAYZ->AI', gamma1['b'], h['bb'][A,A,C,A], lambdas['bb'], t['bb'][pA,pV,hA,hA], optimize=True)
	X['b'][pV,hC] += 0.5 * np.einsum('UV,WXUY,YZWX,VAIZ->AI', gamma1['b'], h['bb'][A,A,A,A], lambdas['bb'], t['bb'][pA,pV,hC,hA], optimize=True)
	X['b'][pV,hC] += -1.0 * np.einsum('UV,WAUX,uXvW,vVuI->AI', gamma1['b'], h['bb'][A,V,A,A], lambdas['ab'], t['ab'][pa,pA,ha,hC], optimize=True)
	X['b'][pV,hC] += -1.0 * np.einsum('UV,WAUX,XYWZ,VZIY->AI', gamma1['b'], h['bb'][A,V,A,A], lambdas['bb'], t['bb'][pA,pA,hC,hA], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('ia,aAiI->AI', h['a'][c,v], t['ab'][pv,pV,hc,hC], optimize=True)
	X['b'][pV,hC] += 0.5 * np.einsum('iuvw,vwux,xAiI->AI', h['aa'][c,a,a,a], lambdas['aa'], t['ab'][pa,pV,hc,hC], optimize=True)
	X['b'][pV,hC] += -1.0 * np.einsum('iJaI,aAiJ->AI', h['ab'][c,C,v,C], t['ab'][pv,pV,hc,hC], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('iUuI,uVvU,vAiV->AI', h['ab'][c,A,a,C], lambdas['ab'], t['ab'][pa,pV,hc,hA], optimize=True)
	X['b'][pV,hC] += -1.0 * np.einsum('iUuV,uVvU,vAiI->AI', h['ab'][c,A,a,A], lambdas['ab'], t['ab'][pa,pV,hc,hC], optimize=True)
	X['b'][pV,hC] += -0.5 * np.einsum('iAuI,uvwx,wxiv->AI', h['ab'][c,V,a,C], lambdas['aa'], t['aa'][pa,pa,hc,ha], optimize=True)
	X['b'][pV,hC] += -1.0 * np.einsum('iAuI,uUvV,vViU->AI', h['ab'][c,V,a,C], lambdas['ab'], t['ab'][pa,pA,hc,hA], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('iAuU,uUvV,vViI->AI', h['ab'][c,V,a,A], lambdas['ab'], t['ab'][pa,pA,hc,hC], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('iAaB,aBiI->AI', h['ab'][c,V,v,V], t['ab'][pv,pV,hc,hC], optimize=True)
	X['b'][pV,hC] += 0.5 * np.einsum('uvwa,wxuv,aAxI->AI', h['aa'][a,a,a,v], lambdas['aa'], t['ab'][pv,pV,ha,hC], optimize=True)
	X['b'][pV,hC] += -1.0 * np.einsum('uJvI,vwux,xAwJ->AI', h['ab'][a,C,a,C], lambdas['aa'], t['ab'][pa,pV,ha,hC], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('uJvI,vUuV,VAJU->AI', h['ab'][a,C,a,C], lambdas['ab'], t['bb'][pA,pV,hC,hA], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('uJvU,vUuV,VAIJ->AI', h['ab'][a,C,a,A], lambdas['ab'], t['bb'][pA,pV,hC,hC], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('uUvB,vVuU,ABIV->AI', h['ab'][a,A,a,V], lambdas['ab'], t['bb'][pV,pV,hC,hA], optimize=True)
	X['b'][pV,hC] += -1.0 * np.einsum('uUaI,vVuU,aAvV->AI', h['ab'][a,A,v,C], lambdas['ab'], t['ab'][pv,pV,ha,hA], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('uUaV,vVuU,aAvI->AI', h['ab'][a,A,v,A], lambdas['ab'], t['ab'][pv,pV,ha,hC], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('uAvB,vwux,xBwI->AI', h['ab'][a,V,a,V], lambdas['aa'], t['ab'][pa,pV,ha,hC], optimize=True)
	X['b'][pV,hC] += -1.0 * np.einsum('uAvB,vUuV,VBIU->AI', h['ab'][a,V,a,V], lambdas['ab'], t['bb'][pA,pV,hC,hA], optimize=True)
	X['b'][pV,hC] += -0.5 * np.einsum('uAaI,vwux,xavw->AI', h['ab'][a,V,v,C], lambdas['aa'], t['aa'][pa,pv,ha,ha], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('uAaI,vUuV,aVvU->AI', h['ab'][a,V,v,C], lambdas['ab'], t['ab'][pv,pA,ha,hA], optimize=True)
	X['b'][pV,hC] += -1.0 * np.einsum('uAaU,vUuV,aVvI->AI', h['ab'][a,V,v,A], lambdas['ab'], t['ab'][pv,pA,ha,hC], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('JB,ABIJ->AI', h['b'][C,V], t['bb'][pV,pV,hC,hC], optimize=True)
	X['b'][pV,hC] += -0.5 * np.einsum('JKIB,ABJK->AI', h['bb'][C,C,C,V], t['bb'][pV,pV,hC,hC], optimize=True)
	X['b'][pV,hC] += -1.0 * np.einsum('JUIV,uVvU,vAuJ->AI', h['bb'][C,A,C,A], lambdas['ab'], t['ab'][pa,pV,ha,hC], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('JUIV,VWUX,XAJW->AI', h['bb'][C,A,C,A], lambdas['bb'], t['bb'][pA,pV,hC,hA], optimize=True)
	X['b'][pV,hC] += -0.5 * np.einsum('JUVW,VWUX,XAIJ->AI', h['bb'][C,A,A,A], lambdas['bb'], t['bb'][pA,pV,hC,hC], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('JAIU,uUvV,vVuJ->AI', h['bb'][C,V,C,A], lambdas['ab'], t['ab'][pa,pA,ha,hC], optimize=True)
	X['b'][pV,hC] += 0.5 * np.einsum('JAIU,UVWX,WXJV->AI', h['bb'][C,V,C,A], lambdas['bb'], t['bb'][pA,pA,hC,hA], optimize=True)
	X['b'][pV,hC] += -0.25 * np.einsum('JAUV,UVWX,WXIJ->AI', h['bb'][C,V,A,A], lambdas['bb'], t['bb'][pA,pA,hC,hC], optimize=True)
	X['b'][pV,hC] += -0.5 * np.einsum('JABC,BCIJ->AI', h['bb'][C,V,V,V], t['bb'][pV,pV,hC,hC], optimize=True)
	X['b'][pV,hC] += -0.25 * np.einsum('UVIB,WXUV,ABWX->AI', h['bb'][A,A,C,V], lambdas['bb'], t['bb'][pV,pV,hA,hA], optimize=True)
	X['b'][pV,hC] += 0.5 * np.einsum('UVWB,WXUV,ABIX->AI', h['bb'][A,A,A,V], lambdas['bb'], t['bb'][pV,pV,hC,hA], optimize=True)
	X['b'][pV,hC] += -1.0 * np.einsum('UAIB,uVvU,vBuV->AI', h['bb'][A,V,C,V], lambdas['ab'], t['ab'][pa,pV,ha,hA], optimize=True)
	X['b'][pV,hC] += 0.5 * np.einsum('UAIB,VWUX,XBVW->AI', h['bb'][A,V,C,V], lambdas['bb'], t['bb'][pA,pV,hA,hA], optimize=True)
	X['b'][pV,hC] += 1.0 * np.einsum('UAVB,uVvU,vBuI->AI', h['bb'][A,V,A,V], lambdas['ab'], t['ab'][pa,pV,ha,hC], optimize=True)
	X['b'][pV,hC] += -1.0 * np.einsum('UAVB,VWUX,XBIW->AI', h['bb'][A,V,A,V], lambdas['bb'], t['bb'][pA,pV,hC,hA], optimize=True)
	# a|v
	X['a'][pv,ha] += 0.5 * np.einsum('vw,xy,zp,wyuz,pavx->au', eta1['a'], eta1['a'], gamma1['a'], h['aa'][a,a,a,a], t['aa'][pa,pv,ha,ha], optimize=True)
	X['a'][pv,ha] += 0.5 * np.einsum('vw,xy,iavx,wyiu->au', eta1['a'], eta1['a'], h['aa'][c,v,a,a], t['aa'][pa,pa,hc,ha], optimize=True)
	X['a'][pv,ha] += 0.5 * np.einsum('vw,xy,zp,ypuv,waxz->au', eta1['a'], gamma1['a'], gamma1['a'], h['aa'][a,a,a,a], t['aa'][pa,pv,ha,ha], optimize=True)
	X['a'][pv,ha] += 1.0 * np.einsum('vw,xy,iyuv,waix->au', eta1['a'], gamma1['a'], h['aa'][c,a,a,a], t['aa'][pa,pv,hc,ha], optimize=True)
	X['a'][pv,ha] += 1.0 * np.einsum('vw,xy,wx,yauv->au', eta1['a'], gamma1['a'], h['a'][a,a], t['aa'][pa,pv,ha,ha], optimize=True)
	X['a'][pv,ha] += -1.0 * np.einsum('vw,xy,yv,waux->au', eta1['a'], gamma1['a'], h['a'][a,a], t['aa'][pa,pv,ha,ha], optimize=True)
	X['a'][pv,ha] += -1.0 * np.einsum('vw,xy,yavb,wbux->au', eta1['a'], gamma1['a'], h['aa'][a,v,a,v], t['aa'][pa,pv,ha,ha], optimize=True)
	X['a'][pv,ha] += 1.0 * np.einsum('vw,UV,aVvA,wAuU->au', eta1['a'], gamma1['b'], h['ab'][v,A,a,V], t['ab'][pa,pV,ha,hA], optimize=True)
	X['a'][pv,ha] += 1.0 * np.einsum('vw,iv,waiu->au', eta1['a'], h['a'][c,a], t['aa'][pa,pv,hc,ha], optimize=True)
	X['a'][pv,ha] += 0.5 * np.einsum('vw,ijuv,waij->au', eta1['a'], h['aa'][c,c,a,a], t['aa'][pa,pv,hc,hc], optimize=True)
	X['a'][pv,ha] += 1.0 * np.einsum('vw,iavb,wbiu->au', eta1['a'], h['aa'][c,v,a,v], t['aa'][pa,pv,hc,ha], optimize=True)
	X['a'][pv,ha] += 1.0 * np.einsum('vw,wxuy,yzxp,pavz->au', eta1['a'], h['aa'][a,a,a,a], lambdas['aa'], t['aa'][pa,pv,ha,ha], optimize=True)
	X['a'][pv,ha] += -1.0 * np.einsum('vw,wxuy,yUxV,aVvU->au', eta1['a'], h['aa'][a,a,a,a], lambdas['ab'], t['ab'][pv,pA,ha,hA], optimize=True)
	X['a'][pv,ha] += -0.5 * np.einsum('vw,wxyz,yzxp,pauv->au', eta1['a'], h['aa'][a,a,a,a], lambdas['aa'], t['aa'][pa,pv,ha,ha], optimize=True)
	X['a'][pv,ha] += 1.0 * np.einsum('vw,wUuV,xVyU,yavx->au', eta1['a'], h['ab'][a,A,a,A], lambdas['ab'], t['aa'][pa,pv,ha,ha], optimize=True)
	X['a'][pv,ha] += -1.0 * np.einsum('vw,wUuV,VWUX,aXvW->au', eta1['a'], h['ab'][a,A,a,A], lambdas['bb'], t['ab'][pv,pA,ha,hA], optimize=True)
	X['a'][pv,ha] += 1.0 * np.einsum('vw,wUxV,xVyU,yauv->au', eta1['a'], h['ab'][a,A,a,A], lambdas['ab'], t['aa'][pa,pv,ha,ha], optimize=True)
	X['a'][pv,ha] += 0.25 * np.einsum('vw,xyuv,zpxy,wazp->au', eta1['a'], h['aa'][a,a,a,a], lambdas['aa'], t['aa'][pa,pv,ha,ha], optimize=True)
	X['a'][pv,ha] += 0.5 * np.einsum('vw,xyvz,zpxy,waup->au', eta1['a'], h['aa'][a,a,a,a], lambdas['aa'], t['aa'][pa,pv,ha,ha], optimize=True)
	X['a'][pv,ha] += -1.0 * np.einsum('vw,xUvV,yVxU,wauy->au', eta1['a'], h['ab'][a,A,a,A], lambdas['ab'], t['aa'][pa,pv,ha,ha], optimize=True)
	X['a'][pv,ha] += 1.0 * np.einsum('vw,aIvA,wAuI->au', eta1['a'], h['ab'][v,C,a,V], t['ab'][pa,pV,ha,hC], optimize=True)
	X['a'][pv,ha] += -1.0 * np.einsum('UV,vw,WX,wVuW,aXvU->au', eta1['b'], eta1['a'], gamma1['b'], h['ab'][a,A,a,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['a'][pv,ha] += 1.0 * np.einsum('UV,vw,aIvU,wVuI->au', eta1['b'], eta1['a'], h['ab'][v,C,a,A], t['ab'][pa,pA,ha,hC], optimize=True)
	X['a'][pv,ha] += -1.0 * np.einsum('UV,vw,wIuU,aVvI->au', eta1['b'], gamma1['a'], h['ab'][a,C,a,A], t['ab'][pv,pA,ha,hC], optimize=True)
	X['a'][pv,ha] += -1.0 * np.einsum('UV,WX,vw,wXuU,aVvW->au', eta1['b'], gamma1['b'], gamma1['a'], h['ab'][a,A,a,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['a'][pv,ha] += -1.0 * np.einsum('UV,WX,iXuU,aViW->au', eta1['b'], gamma1['b'], h['ab'][c,A,a,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['a'][pv,ha] += 1.0 * np.einsum('UV,WX,aXbU,bVuW->au', eta1['b'], gamma1['b'], h['ab'][v,A,v,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['a'][pv,ha] += -1.0 * np.einsum('UV,WX,VW,aXuU->au', eta1['b'], gamma1['b'], h['b'][A,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['a'][pv,ha] += 1.0 * np.einsum('UV,WX,XU,aVuW->au', eta1['b'], gamma1['b'], h['b'][A,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['a'][pv,ha] += -1.0 * np.einsum('UV,iIuU,aViI->au', eta1['b'], h['ab'][c,C,a,A], t['ab'][pv,pA,hc,hC], optimize=True)
	X['a'][pv,ha] += 1.0 * np.einsum('UV,vVuW,wWvX,aXwU->au', eta1['b'], h['ab'][a,A,a,A], lambdas['ab'], t['ab'][pv,pA,ha,hA], optimize=True)
	X['a'][pv,ha] += -1.0 * np.einsum('UV,vVwW,wWvX,aXuU->au', eta1['b'], h['ab'][a,A,a,A], lambdas['ab'], t['ab'][pv,pA,ha,hA], optimize=True)
	X['a'][pv,ha] += -1.0 * np.einsum('UV,vWuU,wXvW,aVwX->au', eta1['b'], h['ab'][a,A,a,A], lambdas['ab'], t['ab'][pv,pA,ha,hA], optimize=True)
	X['a'][pv,ha] += 1.0 * np.einsum('UV,vWwU,wXvW,aVuX->au', eta1['b'], h['ab'][a,A,a,A], lambdas['ab'], t['ab'][pv,pA,ha,hA], optimize=True)
	X['a'][pv,ha] += 1.0 * np.einsum('UV,aIbU,bVuI->au', eta1['b'], h['ab'][v,C,v,A], t['ab'][pv,pA,ha,hC], optimize=True)
	X['a'][pv,ha] += 1.0 * np.einsum('UV,IU,aVuI->au', eta1['b'], h['b'][C,A], t['ab'][pv,pA,ha,hC], optimize=True)
	X['a'][pv,ha] += 0.5 * np.einsum('UV,VWXY,XYWZ,aZuU->au', eta1['b'], h['bb'][A,A,A,A], lambdas['bb'], t['ab'][pv,pA,ha,hA], optimize=True)
	X['a'][pv,ha] += -0.5 * np.einsum('UV,WXUY,YZWX,aVuZ->au', eta1['b'], h['bb'][A,A,A,A], lambdas['bb'], t['ab'][pv,pA,ha,hA], optimize=True)
	X['a'][pv,ha] += -0.5 * np.einsum('vw,xy,wyub,abvx->au', gamma1['a'], gamma1['a'], h['aa'][a,a,a,v], t['aa'][pv,pv,ha,ha], optimize=True)
	X['a'][pv,ha] += -1.0 * np.einsum('vw,iwub,abiv->au', gamma1['a'], h['aa'][c,a,a,v], t['aa'][pv,pv,hc,ha], optimize=True)
	X['a'][pv,ha] += 1.0 * np.einsum('vw,wb,abuv->au', gamma1['a'], h['a'][a,v], t['aa'][pv,pv,ha,ha], optimize=True)
	X['a'][pv,ha] += 1.0 * np.einsum('vw,wxuy,yzxp,pavz->au', gamma1['a'], h['aa'][a,a,a,a], lambdas['aa'], t['aa'][pa,pv,ha,ha], optimize=True)
	X['a'][pv,ha] += -1.0 * np.einsum('vw,wxuy,yUxV,aVvU->au', gamma1['a'], h['aa'][a,a,a,a], lambdas['ab'], t['ab'][pv,pA,ha,hA], optimize=True)
	X['a'][pv,ha] += -0.5 * np.einsum('vw,wxyz,yzxp,pauv->au', gamma1['a'], h['aa'][a,a,a,a], lambdas['aa'], t['aa'][pa,pv,ha,ha], optimize=True)
	X['a'][pv,ha] += -0.5 * np.einsum('vw,wabc,bcuv->au', gamma1['a'], h['aa'][a,v,v,v], t['aa'][pv,pv,ha,ha], optimize=True)
	X['a'][pv,ha] += -1.0 * np.einsum('vw,wIuA,aAvI->au', gamma1['a'], h['ab'][a,C,a,V], t['ab'][pv,pV,ha,hC], optimize=True)
	X['a'][pv,ha] += 1.0 * np.einsum('vw,wUuV,xVyU,yavx->au', gamma1['a'], h['ab'][a,A,a,A], lambdas['ab'], t['aa'][pa,pv,ha,ha], optimize=True)
	X['a'][pv,ha] += -1.0 * np.einsum('vw,wUuV,VWUX,aXvW->au', gamma1['a'], h['ab'][a,A,a,A], lambdas['bb'], t['ab'][pv,pA,ha,hA], optimize=True)
	X['a'][pv,ha] += 1.0 * np.einsum('vw,wUxV,xVyU,yauv->au', gamma1['a'], h['ab'][a,A,a,A], lambdas['ab'], t['aa'][pa,pv,ha,ha], optimize=True)
	X['a'][pv,ha] += 0.25 * np.einsum('vw,xyuv,zpxy,wazp->au', gamma1['a'], h['aa'][a,a,a,a], lambdas['aa'], t['aa'][pa,pv,ha,ha], optimize=True)
	X['a'][pv,ha] += 0.5 * np.einsum('vw,xyvz,zpxy,waup->au', gamma1['a'], h['aa'][a,a,a,a], lambdas['aa'], t['aa'][pa,pv,ha,ha], optimize=True)
	X['a'][pv,ha] += -1.0 * np.einsum('vw,xUvV,yVxU,wauy->au', gamma1['a'], h['ab'][a,A,a,A], lambdas['ab'], t['aa'][pa,pv,ha,ha], optimize=True)
	X['a'][pv,ha] += -1.0 * np.einsum('UV,vw,wVuA,aAvU->au', gamma1['b'], gamma1['a'], h['ab'][a,A,a,V], t['ab'][pv,pV,ha,hA], optimize=True)
	X['a'][pv,ha] += -1.0 * np.einsum('UV,iVuA,aAiU->au', gamma1['b'], h['ab'][c,A,a,V], t['ab'][pv,pV,hc,hA], optimize=True)
	X['a'][pv,ha] += 1.0 * np.einsum('UV,vVuW,wWvX,aXwU->au', gamma1['b'], h['ab'][a,A,a,A], lambdas['ab'], t['ab'][pv,pA,ha,hA], optimize=True)
	X['a'][pv,ha] += -1.0 * np.einsum('UV,vVwW,wWvX,aXuU->au', gamma1['b'], h['ab'][a,A,a,A], lambdas['ab'], t['ab'][pv,pA,ha,hA], optimize=True)
	X['a'][pv,ha] += -1.0 * np.einsum('UV,vWuU,wXvW,aVwX->au', gamma1['b'], h['ab'][a,A,a,A], lambdas['ab'], t['ab'][pv,pA,ha,hA], optimize=True)
	X['a'][pv,ha] += 1.0 * np.einsum('UV,vWwU,wXvW,aVuX->au', gamma1['b'], h['ab'][a,A,a,A], lambdas['ab'], t['ab'][pv,pA,ha,hA], optimize=True)
	X['a'][pv,ha] += 1.0 * np.einsum('UV,aVbA,bAuU->au', gamma1['b'], h['ab'][v,A,v,V], t['ab'][pv,pV,ha,hA], optimize=True)
	X['a'][pv,ha] += 1.0 * np.einsum('UV,VA,aAuU->au', gamma1['b'], h['b'][A,V], t['ab'][pv,pV,ha,hA], optimize=True)
	X['a'][pv,ha] += 0.5 * np.einsum('UV,VWXY,XYWZ,aZuU->au', gamma1['b'], h['bb'][A,A,A,A], lambdas['bb'], t['ab'][pv,pA,ha,hA], optimize=True)
	X['a'][pv,ha] += -0.5 * np.einsum('UV,WXUY,YZWX,aVuZ->au', gamma1['b'], h['bb'][A,A,A,A], lambdas['bb'], t['ab'][pv,pA,ha,hA], optimize=True)
	X['a'][pv,ha] += -1.0 * np.einsum('ib,abiu->au', h['a'][c,v], t['aa'][pv,pv,hc,ha], optimize=True)
	X['a'][pv,ha] += -0.5 * np.einsum('ijub,abij->au', h['aa'][c,c,a,v], t['aa'][pv,pv,hc,hc], optimize=True)
	X['a'][pv,ha] += 1.0 * np.einsum('ivuw,wxvy,yaix->au', h['aa'][c,a,a,a], lambdas['aa'], t['aa'][pa,pv,hc,ha], optimize=True)
	X['a'][pv,ha] += -1.0 * np.einsum('ivuw,wUvV,aViU->au', h['aa'][c,a,a,a], lambdas['ab'], t['ab'][pv,pA,hc,hA], optimize=True)
	X['a'][pv,ha] += 0.5 * np.einsum('ivwx,wxvy,yaiu->au', h['aa'][c,a,a,a], lambdas['aa'], t['aa'][pa,pv,hc,ha], optimize=True)
	X['a'][pv,ha] += 0.5 * np.einsum('iauv,vwxy,xyiw->au', h['aa'][c,v,a,a], lambdas['aa'], t['aa'][pa,pa,hc,ha], optimize=True)
	X['a'][pv,ha] += 1.0 * np.einsum('iauv,vUwV,wViU->au', h['aa'][c,v,a,a], lambdas['ab'], t['ab'][pa,pA,hc,hA], optimize=True)
	X['a'][pv,ha] += 0.25 * np.einsum('iavw,vwxy,xyiu->au', h['aa'][c,v,a,a], lambdas['aa'], t['aa'][pa,pa,hc,ha], optimize=True)
	X['a'][pv,ha] += 0.5 * np.einsum('iabc,bciu->au', h['aa'][c,v,v,v], t['aa'][pv,pv,hc,ha], optimize=True)
	X['a'][pv,ha] += -1.0 * np.einsum('iIuA,aAiI->au', h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], optimize=True)
	X['a'][pv,ha] += 1.0 * np.einsum('iUuV,vVwU,waiv->au', h['ab'][c,A,a,A], lambdas['ab'], t['aa'][pa,pv,hc,ha], optimize=True)
	X['a'][pv,ha] += -1.0 * np.einsum('iUuV,VWUX,aXiW->au', h['ab'][c,A,a,A], lambdas['bb'], t['ab'][pv,pA,hc,hA], optimize=True)
	X['a'][pv,ha] += -1.0 * np.einsum('iUvV,vVwU,waiu->au', h['ab'][c,A,a,A], lambdas['ab'], t['aa'][pa,pv,hc,ha], optimize=True)
	X['a'][pv,ha] += -0.25 * np.einsum('vwub,xyvw,abxy->au', h['aa'][a,a,a,v], lambdas['aa'], t['aa'][pv,pv,ha,ha], optimize=True)
	X['a'][pv,ha] += 0.5 * np.einsum('vwxb,xyvw,abuy->au', h['aa'][a,a,a,v], lambdas['aa'], t['aa'][pv,pv,ha,ha], optimize=True)
	X['a'][pv,ha] += 0.5 * np.einsum('vaub,wxvy,ybwx->au', h['aa'][a,v,a,v], lambdas['aa'], t['aa'][pa,pv,ha,ha], optimize=True)
	X['a'][pv,ha] += -1.0 * np.einsum('vaub,wUvV,bVwU->au', h['aa'][a,v,a,v], lambdas['ab'], t['ab'][pv,pA,ha,hA], optimize=True)
	X['a'][pv,ha] += -1.0 * np.einsum('vawb,wxvy,ybux->au', h['aa'][a,v,a,v], lambdas['aa'], t['aa'][pa,pv,ha,ha], optimize=True)
	X['a'][pv,ha] += 1.0 * np.einsum('vawb,wUvV,bVuU->au', h['aa'][a,v,a,v], lambdas['ab'], t['ab'][pv,pA,ha,hA], optimize=True)
	X['a'][pv,ha] += 1.0 * np.einsum('vIuU,wUvV,aVwI->au', h['ab'][a,C,a,A], lambdas['ab'], t['ab'][pv,pA,ha,hC], optimize=True)
	X['a'][pv,ha] += -1.0 * np.einsum('vIwU,wUvV,aVuI->au', h['ab'][a,C,a,A], lambdas['ab'], t['ab'][pv,pA,ha,hC], optimize=True)
	X['a'][pv,ha] += -1.0 * np.einsum('vUuA,wVvU,aAwV->au', h['ab'][a,A,a,V], lambdas['ab'], t['ab'][pv,pV,ha,hA], optimize=True)
	X['a'][pv,ha] += 1.0 * np.einsum('vUwA,wVvU,aAuV->au', h['ab'][a,A,a,V], lambdas['ab'], t['ab'][pv,pV,ha,hA], optimize=True)
	X['a'][pv,ha] += 1.0 * np.einsum('vUbV,wVvU,abuw->au', h['ab'][a,A,v,A], lambdas['ab'], t['aa'][pv,pv,ha,ha], optimize=True)
	X['a'][pv,ha] += -1.0 * np.einsum('aIuU,vUwV,wVvI->au', h['ab'][v,C,a,A], lambdas['ab'], t['ab'][pa,pA,ha,hC], optimize=True)
	X['a'][pv,ha] += -0.5 * np.einsum('aIuU,UVWX,WXIV->au', h['ab'][v,C,a,A], lambdas['bb'], t['bb'][pA,pA,hC,hA], optimize=True)
	X['a'][pv,ha] += 1.0 * np.einsum('aIvU,vUwV,wVuI->au', h['ab'][v,C,a,A], lambdas['ab'], t['ab'][pa,pA,ha,hC], optimize=True)
	X['a'][pv,ha] += 1.0 * np.einsum('aIbA,bAuI->au', h['ab'][v,C,v,V], t['ab'][pv,pV,ha,hC], optimize=True)
	X['a'][pv,ha] += 1.0 * np.einsum('aUuA,vVwU,wAvV->au', h['ab'][v,A,a,V], lambdas['ab'], t['ab'][pa,pV,ha,hA], optimize=True)
	X['a'][pv,ha] += -0.5 * np.einsum('aUuA,VWUX,XAVW->au', h['ab'][v,A,a,V], lambdas['bb'], t['bb'][pA,pV,hA,hA], optimize=True)
	X['a'][pv,ha] += -1.0 * np.einsum('aUvA,vVwU,wAuV->au', h['ab'][v,A,a,V], lambdas['ab'], t['ab'][pa,pV,ha,hA], optimize=True)
	X['a'][pv,ha] += -1.0 * np.einsum('aUbV,vVwU,wbuv->au', h['ab'][v,A,v,A], lambdas['ab'], t['aa'][pa,pv,ha,ha], optimize=True)
	X['a'][pv,ha] += 1.0 * np.einsum('aUbV,VWUX,bXuW->au', h['ab'][v,A,v,A], lambdas['bb'], t['ab'][pv,pA,ha,hA], optimize=True)
	X['a'][pv,ha] += 1.0 * np.einsum('IA,aAuI->au', h['b'][C,V], t['ab'][pv,pV,ha,hC], optimize=True)
	X['a'][pv,ha] += 0.5 * np.einsum('IUVW,VWUX,aXuI->au', h['bb'][C,A,A,A], lambdas['bb'], t['ab'][pv,pA,ha,hC], optimize=True)
	X['a'][pv,ha] += 0.5 * np.einsum('UVWA,WXUV,aAuX->au', h['bb'][A,A,A,V], lambdas['bb'], t['ab'][pv,pV,ha,hA], optimize=True)
	# c|a
	X['a'][pa,hc] += 0.5 * np.einsum('vw,xy,zp,upvx,wyiz->ui', eta1['a'], eta1['a'], gamma1['a'], h['aa'][a,a,a,a], t['aa'][pa,pa,hc,ha], optimize=True)
	X['a'][pa,hc] += -0.5 * np.einsum('vw,xy,juvx,wyij->ui', eta1['a'], eta1['a'], h['aa'][c,a,a,a], t['aa'][pa,pa,hc,hc], optimize=True)
	X['a'][pa,hc] += 0.5 * np.einsum('vw,xy,zp,uwxz,ypiv->ui', eta1['a'], gamma1['a'], gamma1['a'], h['aa'][a,a,a,a], t['aa'][pa,pa,hc,ha], optimize=True)
	X['a'][pa,hc] += -1.0 * np.einsum('vw,xy,jyiv,uwjx->ui', eta1['a'], gamma1['a'], h['aa'][c,a,c,a], t['aa'][pa,pa,hc,ha], optimize=True)
	X['a'][pa,hc] += 1.0 * np.einsum('vw,xy,uyva,waix->ui', eta1['a'], gamma1['a'], h['aa'][a,a,a,v], t['aa'][pa,pv,hc,ha], optimize=True)
	X['a'][pa,hc] += -1.0 * np.einsum('vw,xy,wx,uyiv->ui', eta1['a'], gamma1['a'], h['a'][a,a], t['aa'][pa,pa,hc,ha], optimize=True)
	X['a'][pa,hc] += 1.0 * np.einsum('vw,xy,yv,uwix->ui', eta1['a'], gamma1['a'], h['a'][a,a], t['aa'][pa,pa,hc,ha], optimize=True)
	X['a'][pa,hc] += 1.0 * np.einsum('vw,UV,uVvA,wAiU->ui', eta1['a'], gamma1['b'], h['ab'][a,A,a,V], t['ab'][pa,pV,hc,hA], optimize=True)
	X['a'][pa,hc] += 1.0 * np.einsum('vw,jv,uwij->ui', eta1['a'], h['a'][c,a], t['aa'][pa,pa,hc,hc], optimize=True)
	X['a'][pa,hc] += -0.5 * np.einsum('vw,jkiv,uwjk->ui', eta1['a'], h['aa'][c,c,c,a], t['aa'][pa,pa,hc,hc], optimize=True)
	X['a'][pa,hc] += -1.0 * np.einsum('vw,juva,waij->ui', eta1['a'], h['aa'][c,a,a,v], t['aa'][pa,pv,hc,hc], optimize=True)
	X['a'][pa,hc] += 0.25 * np.einsum('vw,uwxy,xyzp,zpiv->ui', eta1['a'], h['aa'][a,a,a,a], lambdas['aa'], t['aa'][pa,pa,hc,ha], optimize=True)
	X['a'][pa,hc] += 1.0 * np.einsum('vw,uxvy,yzxp,wpiz->ui', eta1['a'], h['aa'][a,a,a,a], lambdas['aa'], t['aa'][pa,pa,hc,ha], optimize=True)
	X['a'][pa,hc] += 1.0 * np.einsum('vw,uxvy,yUxV,wViU->ui', eta1['a'], h['aa'][a,a,a,a], lambdas['ab'], t['ab'][pa,pA,hc,hA], optimize=True)
	X['a'][pa,hc] += 1.0 * np.einsum('vw,uIvA,wAiI->ui', eta1['a'], h['ab'][a,C,a,V], t['ab'][pa,pV,hc,hC], optimize=True)
	X['a'][pa,hc] += 1.0 * np.einsum('vw,uUvV,xVyU,wyix->ui', eta1['a'], h['ab'][a,A,a,A], lambdas['ab'], t['aa'][pa,pa,hc,ha], optimize=True)
	X['a'][pa,hc] += 1.0 * np.einsum('vw,uUvV,VWUX,wXiW->ui', eta1['a'], h['ab'][a,A,a,A], lambdas['bb'], t['ab'][pa,pA,hc,hA], optimize=True)
	X['a'][pa,hc] += 0.5 * np.einsum('vw,wxyz,yzxp,upiv->ui', eta1['a'], h['aa'][a,a,a,a], lambdas['aa'], t['aa'][pa,pa,hc,ha], optimize=True)
	X['a'][pa,hc] += -1.0 * np.einsum('vw,wUxV,xVyU,uyiv->ui', eta1['a'], h['ab'][a,A,a,A], lambdas['ab'], t['aa'][pa,pa,hc,ha], optimize=True)
	X['a'][pa,hc] += -0.5 * np.einsum('vw,xyvz,zpxy,uwip->ui', eta1['a'], h['aa'][a,a,a,a], lambdas['aa'], t['aa'][pa,pa,hc,ha], optimize=True)
	X['a'][pa,hc] += 1.0 * np.einsum('vw,xUvV,yVxU,uwiy->ui', eta1['a'], h['ab'][a,A,a,A], lambdas['ab'], t['aa'][pa,pa,hc,ha], optimize=True)
	X['a'][pa,hc] += 1.0 * np.einsum('UV,vw,WX,uXvU,wViW->ui', eta1['b'], eta1['a'], gamma1['b'], h['ab'][a,A,a,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['a'][pa,hc] += 1.0 * np.einsum('UV,vw,uIvU,wViI->ui', eta1['b'], eta1['a'], h['ab'][a,C,a,A], t['ab'][pa,pA,hc,hC], optimize=True)
	X['a'][pa,hc] += -1.0 * np.einsum('UV,vw,wIiU,uVvI->ui', eta1['b'], gamma1['a'], h['ab'][a,C,c,A], t['ab'][pa,pA,ha,hC], optimize=True)
	X['a'][pa,hc] += 1.0 * np.einsum('UV,WX,vw,uVvW,wXiU->ui', eta1['b'], gamma1['b'], gamma1['a'], h['ab'][a,A,a,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['a'][pa,hc] += -1.0 * np.einsum('UV,WX,jXiU,uVjW->ui', eta1['b'], gamma1['b'], h['ab'][c,A,c,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['a'][pa,hc] += 1.0 * np.einsum('UV,WX,uXaU,aViW->ui', eta1['b'], gamma1['b'], h['ab'][a,A,v,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['a'][pa,hc] += -1.0 * np.einsum('UV,WX,VW,uXiU->ui', eta1['b'], gamma1['b'], h['b'][A,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['a'][pa,hc] += 1.0 * np.einsum('UV,WX,XU,uViW->ui', eta1['b'], gamma1['b'], h['b'][A,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['a'][pa,hc] += -1.0 * np.einsum('UV,jIiU,uVjI->ui', eta1['b'], h['ab'][c,C,c,A], t['ab'][pa,pA,hc,hC], optimize=True)
	X['a'][pa,hc] += 1.0 * np.einsum('UV,uIaU,aViI->ui', eta1['b'], h['ab'][a,C,v,A], t['ab'][pv,pA,hc,hC], optimize=True)
	X['a'][pa,hc] += 1.0 * np.einsum('UV,uVvW,vWwX,wXiU->ui', eta1['b'], h['ab'][a,A,a,A], lambdas['ab'], t['ab'][pa,pA,hc,hA], optimize=True)
	X['a'][pa,hc] += -1.0 * np.einsum('UV,uWvU,vXwW,wViX->ui', eta1['b'], h['ab'][a,A,a,A], lambdas['ab'], t['ab'][pa,pA,hc,hA], optimize=True)
	X['a'][pa,hc] += -1.0 * np.einsum('UV,vVwW,wWvX,uXiU->ui', eta1['b'], h['ab'][a,A,a,A], lambdas['ab'], t['ab'][pa,pA,hc,hA], optimize=True)
	X['a'][pa,hc] += 1.0 * np.einsum('UV,vWwU,wXvW,uViX->ui', eta1['b'], h['ab'][a,A,a,A], lambdas['ab'], t['ab'][pa,pA,hc,hA], optimize=True)
	X['a'][pa,hc] += 1.0 * np.einsum('UV,IU,uViI->ui', eta1['b'], h['b'][C,A], t['ab'][pa,pA,hc,hC], optimize=True)
	X['a'][pa,hc] += 0.5 * np.einsum('UV,VWXY,XYWZ,uZiU->ui', eta1['b'], h['bb'][A,A,A,A], lambdas['bb'], t['ab'][pa,pA,hc,hA], optimize=True)
	X['a'][pa,hc] += -0.5 * np.einsum('UV,WXUY,YZWX,uViZ->ui', eta1['b'], h['bb'][A,A,A,A], lambdas['bb'], t['ab'][pa,pA,hc,hA], optimize=True)
	X['a'][pa,hc] += -0.5 * np.einsum('vw,xy,wyia,uavx->ui', gamma1['a'], gamma1['a'], h['aa'][a,a,c,v], t['aa'][pa,pv,ha,ha], optimize=True)
	X['a'][pa,hc] += -1.0 * np.einsum('vw,jwia,uajv->ui', gamma1['a'], h['aa'][c,a,c,v], t['aa'][pa,pv,hc,ha], optimize=True)
	X['a'][pa,hc] += 0.25 * np.einsum('vw,uwxy,xyzp,zpiv->ui', gamma1['a'], h['aa'][a,a,a,a], lambdas['aa'], t['aa'][pa,pa,hc,ha], optimize=True)
	X['a'][pa,hc] += 0.5 * np.einsum('vw,uwab,abiv->ui', gamma1['a'], h['aa'][a,a,v,v], t['aa'][pv,pv,hc,ha], optimize=True)
	X['a'][pa,hc] += 1.0 * np.einsum('vw,uxvy,yzxp,wpiz->ui', gamma1['a'], h['aa'][a,a,a,a], lambdas['aa'], t['aa'][pa,pa,hc,ha], optimize=True)
	X['a'][pa,hc] += 1.0 * np.einsum('vw,uxvy,yUxV,wViU->ui', gamma1['a'], h['aa'][a,a,a,a], lambdas['ab'], t['ab'][pa,pA,hc,hA], optimize=True)
	X['a'][pa,hc] += 1.0 * np.einsum('vw,uUvV,xVyU,wyix->ui', gamma1['a'], h['ab'][a,A,a,A], lambdas['ab'], t['aa'][pa,pa,hc,ha], optimize=True)
	X['a'][pa,hc] += 1.0 * np.einsum('vw,uUvV,VWUX,wXiW->ui', gamma1['a'], h['ab'][a,A,a,A], lambdas['bb'], t['ab'][pa,pA,hc,hA], optimize=True)
	X['a'][pa,hc] += 1.0 * np.einsum('vw,wa,uaiv->ui', gamma1['a'], h['a'][a,v], t['aa'][pa,pv,hc,ha], optimize=True)
	X['a'][pa,hc] += 0.5 * np.einsum('vw,wxyz,yzxp,upiv->ui', gamma1['a'], h['aa'][a,a,a,a], lambdas['aa'], t['aa'][pa,pa,hc,ha], optimize=True)
	X['a'][pa,hc] += -1.0 * np.einsum('vw,wIiA,uAvI->ui', gamma1['a'], h['ab'][a,C,c,V], t['ab'][pa,pV,ha,hC], optimize=True)
	X['a'][pa,hc] += -1.0 * np.einsum('vw,wUxV,xVyU,uyiv->ui', gamma1['a'], h['ab'][a,A,a,A], lambdas['ab'], t['aa'][pa,pa,hc,ha], optimize=True)
	X['a'][pa,hc] += -0.5 * np.einsum('vw,xyvz,zpxy,uwip->ui', gamma1['a'], h['aa'][a,a,a,a], lambdas['aa'], t['aa'][pa,pa,hc,ha], optimize=True)
	X['a'][pa,hc] += 1.0 * np.einsum('vw,xUvV,yVxU,uwiy->ui', gamma1['a'], h['ab'][a,A,a,A], lambdas['ab'], t['aa'][pa,pa,hc,ha], optimize=True)
	X['a'][pa,hc] += -1.0 * np.einsum('UV,vw,wViA,uAvU->ui', gamma1['b'], gamma1['a'], h['ab'][a,A,c,V], t['ab'][pa,pV,ha,hA], optimize=True)
	X['a'][pa,hc] += -1.0 * np.einsum('UV,jViA,uAjU->ui', gamma1['b'], h['ab'][c,A,c,V], t['ab'][pa,pV,hc,hA], optimize=True)
	X['a'][pa,hc] += 1.0 * np.einsum('UV,uVvW,vWwX,wXiU->ui', gamma1['b'], h['ab'][a,A,a,A], lambdas['ab'], t['ab'][pa,pA,hc,hA], optimize=True)
	X['a'][pa,hc] += 1.0 * np.einsum('UV,uVaA,aAiU->ui', gamma1['b'], h['ab'][a,A,v,V], t['ab'][pv,pV,hc,hA], optimize=True)
	X['a'][pa,hc] += -1.0 * np.einsum('UV,uWvU,vXwW,wViX->ui', gamma1['b'], h['ab'][a,A,a,A], lambdas['ab'], t['ab'][pa,pA,hc,hA], optimize=True)
	X['a'][pa,hc] += -1.0 * np.einsum('UV,vVwW,wWvX,uXiU->ui', gamma1['b'], h['ab'][a,A,a,A], lambdas['ab'], t['ab'][pa,pA,hc,hA], optimize=True)
	X['a'][pa,hc] += 1.0 * np.einsum('UV,vWwU,wXvW,uViX->ui', gamma1['b'], h['ab'][a,A,a,A], lambdas['ab'], t['ab'][pa,pA,hc,hA], optimize=True)
	X['a'][pa,hc] += 1.0 * np.einsum('UV,VA,uAiU->ui', gamma1['b'], h['b'][A,V], t['ab'][pa,pV,hc,hA], optimize=True)
	X['a'][pa,hc] += 0.5 * np.einsum('UV,VWXY,XYWZ,uZiU->ui', gamma1['b'], h['bb'][A,A,A,A], lambdas['bb'], t['ab'][pa,pA,hc,hA], optimize=True)
	X['a'][pa,hc] += -0.5 * np.einsum('UV,WXUY,YZWX,uViZ->ui', gamma1['b'], h['bb'][A,A,A,A], lambdas['bb'], t['ab'][pa,pA,hc,hA], optimize=True)
	X['a'][pa,hc] += 1.0 * np.einsum('ja,uaij->ui', h['a'][c,v], t['aa'][pa,pv,hc,hc], optimize=True)
	X['a'][pa,hc] += -0.5 * np.einsum('jkia,uajk->ui', h['aa'][c,c,c,v], t['aa'][pa,pv,hc,hc], optimize=True)
	X['a'][pa,hc] += 0.5 * np.einsum('juiv,vwxy,xyjw->ui', h['aa'][c,a,c,a], lambdas['aa'], t['aa'][pa,pa,hc,ha], optimize=True)
	X['a'][pa,hc] += 1.0 * np.einsum('juiv,vUwV,wVjU->ui', h['aa'][c,a,c,a], lambdas['ab'], t['ab'][pa,pA,hc,hA], optimize=True)
	X['a'][pa,hc] += -0.25 * np.einsum('juvw,vwxy,xyij->ui', h['aa'][c,a,a,a], lambdas['aa'], t['aa'][pa,pa,hc,hc], optimize=True)
	X['a'][pa,hc] += -0.5 * np.einsum('juab,abij->ui', h['aa'][c,a,v,v], t['aa'][pv,pv,hc,hc], optimize=True)
	X['a'][pa,hc] += -1.0 * np.einsum('jviw,wxvy,uyjx->ui', h['aa'][c,a,c,a], lambdas['aa'], t['aa'][pa,pa,hc,ha], optimize=True)
	X['a'][pa,hc] += -1.0 * np.einsum('jviw,wUvV,uVjU->ui', h['aa'][c,a,c,a], lambdas['ab'], t['ab'][pa,pA,hc,hA], optimize=True)
	X['a'][pa,hc] += 0.5 * np.einsum('jvwx,wxvy,uyij->ui', h['aa'][c,a,a,a], lambdas['aa'], t['aa'][pa,pa,hc,hc], optimize=True)
	X['a'][pa,hc] += -1.0 * np.einsum('jIiA,uAjI->ui', h['ab'][c,C,c,V], t['ab'][pa,pV,hc,hC], optimize=True)
	X['a'][pa,hc] += -1.0 * np.einsum('jUiV,vVwU,uwjv->ui', h['ab'][c,A,c,A], lambdas['ab'], t['aa'][pa,pa,hc,ha], optimize=True)
	X['a'][pa,hc] += -1.0 * np.einsum('jUiV,VWUX,uXjW->ui', h['ab'][c,A,c,A], lambdas['bb'], t['ab'][pa,pA,hc,hA], optimize=True)
	X['a'][pa,hc] += -1.0 * np.einsum('jUvV,vVwU,uwij->ui', h['ab'][c,A,a,A], lambdas['ab'], t['aa'][pa,pa,hc,hc], optimize=True)
	X['a'][pa,hc] += -0.5 * np.einsum('uvia,wxvy,yawx->ui', h['aa'][a,a,c,v], lambdas['aa'], t['aa'][pa,pv,ha,ha], optimize=True)
	X['a'][pa,hc] += 1.0 * np.einsum('uvia,wUvV,aVwU->ui', h['aa'][a,a,c,v], lambdas['ab'], t['ab'][pv,pA,ha,hA], optimize=True)
	X['a'][pa,hc] += 1.0 * np.einsum('uvwa,wxvy,yaix->ui', h['aa'][a,a,a,v], lambdas['aa'], t['aa'][pa,pv,hc,ha], optimize=True)
	X['a'][pa,hc] += -1.0 * np.einsum('uvwa,wUvV,aViU->ui', h['aa'][a,a,a,v], lambdas['ab'], t['ab'][pv,pA,hc,hA], optimize=True)
	X['a'][pa,hc] += -1.0 * np.einsum('uIiU,vUwV,wVvI->ui', h['ab'][a,C,c,A], lambdas['ab'], t['ab'][pa,pA,ha,hC], optimize=True)
	X['a'][pa,hc] += -0.5 * np.einsum('uIiU,UVWX,WXIV->ui', h['ab'][a,C,c,A], lambdas['bb'], t['bb'][pA,pA,hC,hA], optimize=True)
	X['a'][pa,hc] += 1.0 * np.einsum('uIvU,vUwV,wViI->ui', h['ab'][a,C,a,A], lambdas['ab'], t['ab'][pa,pA,hc,hC], optimize=True)
	X['a'][pa,hc] += 1.0 * np.einsum('uIaA,aAiI->ui', h['ab'][a,C,v,V], t['ab'][pv,pV,hc,hC], optimize=True)
	X['a'][pa,hc] += 1.0 * np.einsum('uUiA,vVwU,wAvV->ui', h['ab'][a,A,c,V], lambdas['ab'], t['ab'][pa,pV,ha,hA], optimize=True)
	X['a'][pa,hc] += -0.5 * np.einsum('uUiA,VWUX,XAVW->ui', h['ab'][a,A,c,V], lambdas['bb'], t['bb'][pA,pV,hA,hA], optimize=True)
	X['a'][pa,hc] += -1.0 * np.einsum('uUvA,vVwU,wAiV->ui', h['ab'][a,A,a,V], lambdas['ab'], t['ab'][pa,pV,hc,hA], optimize=True)
	X['a'][pa,hc] += -1.0 * np.einsum('uUaV,vVwU,waiv->ui', h['ab'][a,A,v,A], lambdas['ab'], t['aa'][pa,pv,hc,ha], optimize=True)
	X['a'][pa,hc] += 1.0 * np.einsum('uUaV,VWUX,aXiW->ui', h['ab'][a,A,v,A], lambdas['bb'], t['ab'][pv,pA,hc,hA], optimize=True)
	X['a'][pa,hc] += -0.25 * np.einsum('vwia,xyvw,uaxy->ui', h['aa'][a,a,c,v], lambdas['aa'], t['aa'][pa,pv,ha,ha], optimize=True)
	X['a'][pa,hc] += 0.5 * np.einsum('vwxa,xyvw,uaiy->ui', h['aa'][a,a,a,v], lambdas['aa'], t['aa'][pa,pv,hc,ha], optimize=True)
	X['a'][pa,hc] += 1.0 * np.einsum('vIiU,wUvV,uVwI->ui', h['ab'][a,C,c,A], lambdas['ab'], t['ab'][pa,pA,ha,hC], optimize=True)
	X['a'][pa,hc] += -1.0 * np.einsum('vIwU,wUvV,uViI->ui', h['ab'][a,C,a,A], lambdas['ab'], t['ab'][pa,pA,hc,hC], optimize=True)
	X['a'][pa,hc] += -1.0 * np.einsum('vUiA,wVvU,uAwV->ui', h['ab'][a,A,c,V], lambdas['ab'], t['ab'][pa,pV,ha,hA], optimize=True)
	X['a'][pa,hc] += 1.0 * np.einsum('vUwA,wVvU,uAiV->ui', h['ab'][a,A,a,V], lambdas['ab'], t['ab'][pa,pV,hc,hA], optimize=True)
	X['a'][pa,hc] += 1.0 * np.einsum('vUaV,wVvU,uaiw->ui', h['ab'][a,A,v,A], lambdas['ab'], t['aa'][pa,pv,hc,ha], optimize=True)
	X['a'][pa,hc] += 1.0 * np.einsum('IA,uAiI->ui', h['b'][C,V], t['ab'][pa,pV,hc,hC], optimize=True)
	X['a'][pa,hc] += 0.5 * np.einsum('IUVW,VWUX,uXiI->ui', h['bb'][C,A,A,A], lambdas['bb'], t['ab'][pa,pA,hc,hC], optimize=True)
	X['a'][pa,hc] += 0.5 * np.einsum('UVWA,WXUV,uAiX->ui', h['bb'][A,A,A,V], lambdas['bb'], t['ab'][pa,pV,hc,hA], optimize=True)
	# c|v
	X['a'][pv,hc] += 0.5 * np.einsum('uv,wx,yz,vxiy,zauw->ai', eta1['a'], eta1['a'], gamma1['a'], h['aa'][a,a,c,a], t['aa'][pa,pv,ha,ha], optimize=True)
	X['a'][pv,hc] += -0.5 * np.einsum('uv,wx,yz,zauw,vxiy->ai', eta1['a'], eta1['a'], gamma1['a'], h['aa'][a,v,a,a], t['aa'][pa,pa,hc,ha], optimize=True)
	X['a'][pv,hc] += -0.5 * np.einsum('uv,wx,jauw,vxij->ai', eta1['a'], eta1['a'], h['aa'][c,v,a,a], t['aa'][pa,pa,hc,hc], optimize=True)
	X['a'][pv,hc] += -0.5 * np.einsum('uv,wx,yz,vawy,xziu->ai', eta1['a'], gamma1['a'], gamma1['a'], h['aa'][a,v,a,a], t['aa'][pa,pa,hc,ha], optimize=True)
	X['a'][pv,hc] += 0.5 * np.einsum('uv,wx,yz,xziu,vawy->ai', eta1['a'], gamma1['a'], gamma1['a'], h['aa'][a,a,c,a], t['aa'][pa,pv,ha,ha], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('uv,wx,jxiu,vajw->ai', eta1['a'], gamma1['a'], h['aa'][c,a,c,a], t['aa'][pa,pv,hc,ha], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('uv,wx,vw,xaiu->ai', eta1['a'], gamma1['a'], h['a'][a,a], t['aa'][pa,pv,hc,ha], optimize=True)
	X['a'][pv,hc] += -1.0 * np.einsum('uv,wx,xu,vaiw->ai', eta1['a'], gamma1['a'], h['a'][a,a], t['aa'][pa,pv,hc,ha], optimize=True)
	X['a'][pv,hc] += -1.0 * np.einsum('uv,wx,xaub,vbiw->ai', eta1['a'], gamma1['a'], h['aa'][a,v,a,v], t['aa'][pa,pv,hc,ha], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('uv,UV,aVuA,vAiU->ai', eta1['a'], gamma1['b'], h['ab'][v,A,a,V], t['ab'][pa,pV,hc,hA], optimize=True)
	X['a'][pv,hc] += -1.0 * np.einsum('uv,ju,vaij->ai', eta1['a'], h['a'][c,a], t['aa'][pa,pv,hc,hc], optimize=True)
	X['a'][pv,hc] += 0.5 * np.einsum('uv,jkiu,vajk->ai', eta1['a'], h['aa'][c,c,c,a], t['aa'][pa,pv,hc,hc], optimize=True)
	X['a'][pv,hc] += -1.0 * np.einsum('uv,jaub,vbij->ai', eta1['a'], h['aa'][c,v,a,v], t['aa'][pa,pv,hc,hc], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('uv,vwix,xywz,zauy->ai', eta1['a'], h['aa'][a,a,c,a], lambdas['aa'], t['aa'][pa,pv,ha,ha], optimize=True)
	X['a'][pv,hc] += -1.0 * np.einsum('uv,vwix,xUwV,aVuU->ai', eta1['a'], h['aa'][a,a,c,a], lambdas['ab'], t['ab'][pv,pA,ha,hA], optimize=True)
	X['a'][pv,hc] += -0.5 * np.einsum('uv,vwxy,xywz,zaiu->ai', eta1['a'], h['aa'][a,a,a,a], lambdas['aa'], t['aa'][pa,pv,hc,ha], optimize=True)
	X['a'][pv,hc] += -0.25 * np.einsum('uv,vawx,wxyz,yziu->ai', eta1['a'], h['aa'][a,v,a,a], lambdas['aa'], t['aa'][pa,pa,hc,ha], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('uv,vUiV,wVxU,xauw->ai', eta1['a'], h['ab'][a,A,c,A], lambdas['ab'], t['aa'][pa,pv,ha,ha], optimize=True)
	X['a'][pv,hc] += -1.0 * np.einsum('uv,vUiV,VWUX,aXuW->ai', eta1['a'], h['ab'][a,A,c,A], lambdas['bb'], t['ab'][pv,pA,ha,hA], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('uv,vUwV,wVxU,xaiu->ai', eta1['a'], h['ab'][a,A,a,A], lambdas['ab'], t['aa'][pa,pv,hc,ha], optimize=True)
	X['a'][pv,hc] += 0.25 * np.einsum('uv,wxiu,yzwx,vayz->ai', eta1['a'], h['aa'][a,a,c,a], lambdas['aa'], t['aa'][pa,pv,ha,ha], optimize=True)
	X['a'][pv,hc] += 0.5 * np.einsum('uv,wxuy,yzwx,vaiz->ai', eta1['a'], h['aa'][a,a,a,a], lambdas['aa'], t['aa'][pa,pv,hc,ha], optimize=True)
	X['a'][pv,hc] += -1.0 * np.einsum('uv,waux,xywz,vziy->ai', eta1['a'], h['aa'][a,v,a,a], lambdas['aa'], t['aa'][pa,pa,hc,ha], optimize=True)
	X['a'][pv,hc] += -1.0 * np.einsum('uv,waux,xUwV,vViU->ai', eta1['a'], h['aa'][a,v,a,a], lambdas['ab'], t['ab'][pa,pA,hc,hA], optimize=True)
	X['a'][pv,hc] += -1.0 * np.einsum('uv,wUuV,xVwU,vaix->ai', eta1['a'], h['ab'][a,A,a,A], lambdas['ab'], t['aa'][pa,pv,hc,ha], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('uv,aIuA,vAiI->ai', eta1['a'], h['ab'][v,C,a,V], t['ab'][pa,pV,hc,hC], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('uv,aUuV,wVxU,vxiw->ai', eta1['a'], h['ab'][v,A,a,A], lambdas['ab'], t['aa'][pa,pa,hc,ha], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('uv,aUuV,VWUX,vXiW->ai', eta1['a'], h['ab'][v,A,a,A], lambdas['bb'], t['ab'][pa,pA,hc,hA], optimize=True)
	X['a'][pv,hc] += -1.0 * np.einsum('UV,uv,WX,vViW,aXuU->ai', eta1['b'], eta1['a'], gamma1['b'], h['ab'][a,A,c,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('UV,uv,WX,aXuU,vViW->ai', eta1['b'], eta1['a'], gamma1['b'], h['ab'][v,A,a,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('UV,uv,aIuU,vViI->ai', eta1['b'], eta1['a'], h['ab'][v,C,a,A], t['ab'][pa,pA,hc,hC], optimize=True)
	X['a'][pv,hc] += -1.0 * np.einsum('UV,uv,vIiU,aVuI->ai', eta1['b'], gamma1['a'], h['ab'][a,C,c,A], t['ab'][pv,pA,ha,hC], optimize=True)
	X['a'][pv,hc] += -1.0 * np.einsum('UV,WX,uv,vXiU,aVuW->ai', eta1['b'], gamma1['b'], gamma1['a'], h['ab'][a,A,c,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('UV,WX,uv,aVuW,vXiU->ai', eta1['b'], gamma1['b'], gamma1['a'], h['ab'][v,A,a,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['a'][pv,hc] += -1.0 * np.einsum('UV,WX,jXiU,aVjW->ai', eta1['b'], gamma1['b'], h['ab'][c,A,c,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('UV,WX,aXbU,bViW->ai', eta1['b'], gamma1['b'], h['ab'][v,A,v,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['a'][pv,hc] += -1.0 * np.einsum('UV,WX,VW,aXiU->ai', eta1['b'], gamma1['b'], h['b'][A,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('UV,WX,XU,aViW->ai', eta1['b'], gamma1['b'], h['b'][A,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['a'][pv,hc] += -1.0 * np.einsum('UV,jIiU,aVjI->ai', eta1['b'], h['ab'][c,C,c,A], t['ab'][pv,pA,hc,hC], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('UV,uViW,vWuX,aXvU->ai', eta1['b'], h['ab'][a,A,c,A], lambdas['ab'], t['ab'][pv,pA,ha,hA], optimize=True)
	X['a'][pv,hc] += -1.0 * np.einsum('UV,uVvW,vWuX,aXiU->ai', eta1['b'], h['ab'][a,A,a,A], lambdas['ab'], t['ab'][pv,pA,hc,hA], optimize=True)
	X['a'][pv,hc] += -1.0 * np.einsum('UV,uWiU,vXuW,aVvX->ai', eta1['b'], h['ab'][a,A,c,A], lambdas['ab'], t['ab'][pv,pA,ha,hA], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('UV,uWvU,vXuW,aViX->ai', eta1['b'], h['ab'][a,A,a,A], lambdas['ab'], t['ab'][pv,pA,hc,hA], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('UV,aIbU,bViI->ai', eta1['b'], h['ab'][v,C,v,A], t['ab'][pv,pA,hc,hC], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('UV,aVuW,uWvX,vXiU->ai', eta1['b'], h['ab'][v,A,a,A], lambdas['ab'], t['ab'][pa,pA,hc,hA], optimize=True)
	X['a'][pv,hc] += -1.0 * np.einsum('UV,aWuU,uXvW,vViX->ai', eta1['b'], h['ab'][v,A,a,A], lambdas['ab'], t['ab'][pa,pA,hc,hA], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('UV,IU,aViI->ai', eta1['b'], h['b'][C,A], t['ab'][pv,pA,hc,hC], optimize=True)
	X['a'][pv,hc] += 0.5 * np.einsum('UV,VWXY,XYWZ,aZiU->ai', eta1['b'], h['bb'][A,A,A,A], lambdas['bb'], t['ab'][pv,pA,hc,hA], optimize=True)
	X['a'][pv,hc] += -0.5 * np.einsum('UV,WXUY,YZWX,aViZ->ai', eta1['b'], h['bb'][A,A,A,A], lambdas['bb'], t['ab'][pv,pA,hc,hA], optimize=True)
	X['a'][pv,hc] += -0.5 * np.einsum('uv,wx,vxib,abuw->ai', gamma1['a'], gamma1['a'], h['aa'][a,a,c,v], t['aa'][pv,pv,ha,ha], optimize=True)
	X['a'][pv,hc] += -1.0 * np.einsum('uv,jvib,abju->ai', gamma1['a'], h['aa'][c,a,c,v], t['aa'][pv,pv,hc,ha], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('uv,vb,abiu->ai', gamma1['a'], h['a'][a,v], t['aa'][pv,pv,hc,ha], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('uv,vwix,xywz,zauy->ai', gamma1['a'], h['aa'][a,a,c,a], lambdas['aa'], t['aa'][pa,pv,ha,ha], optimize=True)
	X['a'][pv,hc] += -1.0 * np.einsum('uv,vwix,xUwV,aVuU->ai', gamma1['a'], h['aa'][a,a,c,a], lambdas['ab'], t['ab'][pv,pA,ha,hA], optimize=True)
	X['a'][pv,hc] += -0.5 * np.einsum('uv,vwxy,xywz,zaiu->ai', gamma1['a'], h['aa'][a,a,a,a], lambdas['aa'], t['aa'][pa,pv,hc,ha], optimize=True)
	X['a'][pv,hc] += -0.25 * np.einsum('uv,vawx,wxyz,yziu->ai', gamma1['a'], h['aa'][a,v,a,a], lambdas['aa'], t['aa'][pa,pa,hc,ha], optimize=True)
	X['a'][pv,hc] += -0.5 * np.einsum('uv,vabc,bciu->ai', gamma1['a'], h['aa'][a,v,v,v], t['aa'][pv,pv,hc,ha], optimize=True)
	X['a'][pv,hc] += -1.0 * np.einsum('uv,vIiA,aAuI->ai', gamma1['a'], h['ab'][a,C,c,V], t['ab'][pv,pV,ha,hC], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('uv,vUiV,wVxU,xauw->ai', gamma1['a'], h['ab'][a,A,c,A], lambdas['ab'], t['aa'][pa,pv,ha,ha], optimize=True)
	X['a'][pv,hc] += -1.0 * np.einsum('uv,vUiV,VWUX,aXuW->ai', gamma1['a'], h['ab'][a,A,c,A], lambdas['bb'], t['ab'][pv,pA,ha,hA], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('uv,vUwV,wVxU,xaiu->ai', gamma1['a'], h['ab'][a,A,a,A], lambdas['ab'], t['aa'][pa,pv,hc,ha], optimize=True)
	X['a'][pv,hc] += 0.25 * np.einsum('uv,wxiu,yzwx,vayz->ai', gamma1['a'], h['aa'][a,a,c,a], lambdas['aa'], t['aa'][pa,pv,ha,ha], optimize=True)
	X['a'][pv,hc] += 0.5 * np.einsum('uv,wxuy,yzwx,vaiz->ai', gamma1['a'], h['aa'][a,a,a,a], lambdas['aa'], t['aa'][pa,pv,hc,ha], optimize=True)
	X['a'][pv,hc] += -1.0 * np.einsum('uv,waux,xywz,vziy->ai', gamma1['a'], h['aa'][a,v,a,a], lambdas['aa'], t['aa'][pa,pa,hc,ha], optimize=True)
	X['a'][pv,hc] += -1.0 * np.einsum('uv,waux,xUwV,vViU->ai', gamma1['a'], h['aa'][a,v,a,a], lambdas['ab'], t['ab'][pa,pA,hc,hA], optimize=True)
	X['a'][pv,hc] += -1.0 * np.einsum('uv,wUuV,xVwU,vaix->ai', gamma1['a'], h['ab'][a,A,a,A], lambdas['ab'], t['aa'][pa,pv,hc,ha], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('uv,aUuV,wVxU,vxiw->ai', gamma1['a'], h['ab'][v,A,a,A], lambdas['ab'], t['aa'][pa,pa,hc,ha], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('uv,aUuV,VWUX,vXiW->ai', gamma1['a'], h['ab'][v,A,a,A], lambdas['bb'], t['ab'][pa,pA,hc,hA], optimize=True)
	X['a'][pv,hc] += -1.0 * np.einsum('UV,uv,vViA,aAuU->ai', gamma1['b'], gamma1['a'], h['ab'][a,A,c,V], t['ab'][pv,pV,ha,hA], optimize=True)
	X['a'][pv,hc] += -1.0 * np.einsum('UV,jViA,aAjU->ai', gamma1['b'], h['ab'][c,A,c,V], t['ab'][pv,pV,hc,hA], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('UV,uViW,vWuX,aXvU->ai', gamma1['b'], h['ab'][a,A,c,A], lambdas['ab'], t['ab'][pv,pA,ha,hA], optimize=True)
	X['a'][pv,hc] += -1.0 * np.einsum('UV,uVvW,vWuX,aXiU->ai', gamma1['b'], h['ab'][a,A,a,A], lambdas['ab'], t['ab'][pv,pA,hc,hA], optimize=True)
	X['a'][pv,hc] += -1.0 * np.einsum('UV,uWiU,vXuW,aVvX->ai', gamma1['b'], h['ab'][a,A,c,A], lambdas['ab'], t['ab'][pv,pA,ha,hA], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('UV,uWvU,vXuW,aViX->ai', gamma1['b'], h['ab'][a,A,a,A], lambdas['ab'], t['ab'][pv,pA,hc,hA], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('UV,aVuW,uWvX,vXiU->ai', gamma1['b'], h['ab'][v,A,a,A], lambdas['ab'], t['ab'][pa,pA,hc,hA], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('UV,aVbA,bAiU->ai', gamma1['b'], h['ab'][v,A,v,V], t['ab'][pv,pV,hc,hA], optimize=True)
	X['a'][pv,hc] += -1.0 * np.einsum('UV,aWuU,uXvW,vViX->ai', gamma1['b'], h['ab'][v,A,a,A], lambdas['ab'], t['ab'][pa,pA,hc,hA], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('UV,VA,aAiU->ai', gamma1['b'], h['b'][A,V], t['ab'][pv,pV,hc,hA], optimize=True)
	X['a'][pv,hc] += 0.5 * np.einsum('UV,VWXY,XYWZ,aZiU->ai', gamma1['b'], h['bb'][A,A,A,A], lambdas['bb'], t['ab'][pv,pA,hc,hA], optimize=True)
	X['a'][pv,hc] += -0.5 * np.einsum('UV,WXUY,YZWX,aViZ->ai', gamma1['b'], h['bb'][A,A,A,A], lambdas['bb'], t['ab'][pv,pA,hc,hA], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('jb,abij->ai', h['a'][c,v], t['aa'][pv,pv,hc,hc], optimize=True)
	X['a'][pv,hc] += -0.5 * np.einsum('jkib,abjk->ai', h['aa'][c,c,c,v], t['aa'][pv,pv,hc,hc], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('juiv,vwux,xajw->ai', h['aa'][c,a,c,a], lambdas['aa'], t['aa'][pa,pv,hc,ha], optimize=True)
	X['a'][pv,hc] += -1.0 * np.einsum('juiv,vUuV,aVjU->ai', h['aa'][c,a,c,a], lambdas['ab'], t['ab'][pv,pA,hc,hA], optimize=True)
	X['a'][pv,hc] += -0.5 * np.einsum('juvw,vwux,xaij->ai', h['aa'][c,a,a,a], lambdas['aa'], t['aa'][pa,pv,hc,hc], optimize=True)
	X['a'][pv,hc] += 0.5 * np.einsum('jaiu,uvwx,wxjv->ai', h['aa'][c,v,c,a], lambdas['aa'], t['aa'][pa,pa,hc,ha], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('jaiu,uUvV,vVjU->ai', h['aa'][c,v,c,a], lambdas['ab'], t['ab'][pa,pA,hc,hA], optimize=True)
	X['a'][pv,hc] += -0.25 * np.einsum('jauv,uvwx,wxij->ai', h['aa'][c,v,a,a], lambdas['aa'], t['aa'][pa,pa,hc,hc], optimize=True)
	X['a'][pv,hc] += -0.5 * np.einsum('jabc,bcij->ai', h['aa'][c,v,v,v], t['aa'][pv,pv,hc,hc], optimize=True)
	X['a'][pv,hc] += -1.0 * np.einsum('jIiA,aAjI->ai', h['ab'][c,C,c,V], t['ab'][pv,pV,hc,hC], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('jUiV,uVvU,vaju->ai', h['ab'][c,A,c,A], lambdas['ab'], t['aa'][pa,pv,hc,ha], optimize=True)
	X['a'][pv,hc] += -1.0 * np.einsum('jUiV,VWUX,aXjW->ai', h['ab'][c,A,c,A], lambdas['bb'], t['ab'][pv,pA,hc,hA], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('jUuV,uVvU,vaij->ai', h['ab'][c,A,a,A], lambdas['ab'], t['aa'][pa,pv,hc,hc], optimize=True)
	X['a'][pv,hc] += -0.25 * np.einsum('uvib,wxuv,abwx->ai', h['aa'][a,a,c,v], lambdas['aa'], t['aa'][pv,pv,ha,ha], optimize=True)
	X['a'][pv,hc] += 0.5 * np.einsum('uvwb,wxuv,abix->ai', h['aa'][a,a,a,v], lambdas['aa'], t['aa'][pv,pv,hc,ha], optimize=True)
	X['a'][pv,hc] += 0.5 * np.einsum('uaib,vwux,xbvw->ai', h['aa'][a,v,c,v], lambdas['aa'], t['aa'][pa,pv,ha,ha], optimize=True)
	X['a'][pv,hc] += -1.0 * np.einsum('uaib,vUuV,bVvU->ai', h['aa'][a,v,c,v], lambdas['ab'], t['ab'][pv,pA,ha,hA], optimize=True)
	X['a'][pv,hc] += -1.0 * np.einsum('uavb,vwux,xbiw->ai', h['aa'][a,v,a,v], lambdas['aa'], t['aa'][pa,pv,hc,ha], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('uavb,vUuV,bViU->ai', h['aa'][a,v,a,v], lambdas['ab'], t['ab'][pv,pA,hc,hA], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('uIiU,vUuV,aVvI->ai', h['ab'][a,C,c,A], lambdas['ab'], t['ab'][pv,pA,ha,hC], optimize=True)
	X['a'][pv,hc] += -1.0 * np.einsum('uIvU,vUuV,aViI->ai', h['ab'][a,C,a,A], lambdas['ab'], t['ab'][pv,pA,hc,hC], optimize=True)
	X['a'][pv,hc] += -1.0 * np.einsum('uUiA,vVuU,aAvV->ai', h['ab'][a,A,c,V], lambdas['ab'], t['ab'][pv,pV,ha,hA], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('uUvA,vVuU,aAiV->ai', h['ab'][a,A,a,V], lambdas['ab'], t['ab'][pv,pV,hc,hA], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('uUbV,vVuU,abiv->ai', h['ab'][a,A,v,A], lambdas['ab'], t['aa'][pv,pv,hc,ha], optimize=True)
	X['a'][pv,hc] += -1.0 * np.einsum('aIiU,uUvV,vVuI->ai', h['ab'][v,C,c,A], lambdas['ab'], t['ab'][pa,pA,ha,hC], optimize=True)
	X['a'][pv,hc] += -0.5 * np.einsum('aIiU,UVWX,WXIV->ai', h['ab'][v,C,c,A], lambdas['bb'], t['bb'][pA,pA,hC,hA], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('aIuU,uUvV,vViI->ai', h['ab'][v,C,a,A], lambdas['ab'], t['ab'][pa,pA,hc,hC], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('aIbA,bAiI->ai', h['ab'][v,C,v,V], t['ab'][pv,pV,hc,hC], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('aUiA,uVvU,vAuV->ai', h['ab'][v,A,c,V], lambdas['ab'], t['ab'][pa,pV,ha,hA], optimize=True)
	X['a'][pv,hc] += -0.5 * np.einsum('aUiA,VWUX,XAVW->ai', h['ab'][v,A,c,V], lambdas['bb'], t['bb'][pA,pV,hA,hA], optimize=True)
	X['a'][pv,hc] += -1.0 * np.einsum('aUuA,uVvU,vAiV->ai', h['ab'][v,A,a,V], lambdas['ab'], t['ab'][pa,pV,hc,hA], optimize=True)
	X['a'][pv,hc] += -1.0 * np.einsum('aUbV,uVvU,vbiu->ai', h['ab'][v,A,v,A], lambdas['ab'], t['aa'][pa,pv,hc,ha], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('aUbV,VWUX,bXiW->ai', h['ab'][v,A,v,A], lambdas['bb'], t['ab'][pv,pA,hc,hA], optimize=True)
	X['a'][pv,hc] += 1.0 * np.einsum('IA,aAiI->ai', h['b'][C,V], t['ab'][pv,pV,hc,hC], optimize=True)
	X['a'][pv,hc] += 0.5 * np.einsum('IUVW,VWUX,aXiI->ai', h['bb'][C,A,A,A], lambdas['bb'], t['ab'][pv,pA,hc,hC], optimize=True)
	X['a'][pv,hc] += 0.5 * np.einsum('UVWA,WXUV,aAiX->ai', h['bb'][A,A,A,V], lambdas['bb'], t['ab'][pv,pV,hc,hA], optimize=True)
	toc = time.time()
	elapsed_time = toc - tic
	if verbose:
		print(f'Took {elapsed_time} seconds.')
	return X


def H_T_ncomm1_nbody2(X, h, t, gamma1, eta1, lambdas, orbspace, verbose=False):
	tic = time.time()
	c = orbspace['core_alpha']
	C = orbspace['core_beta']
	a = orbspace['active_alpha']
	A = orbspace['active_beta']
	v = orbspace['virt_alpha']
	V = orbspace['virt_beta']
	hc = orbspace['hole_core_alpha']
	hC = orbspace['hole_core_beta']
	ha = orbspace['hole_active_alpha']
	hA = orbspace['hole_active_beta']
	pa = orbspace['particle_active_alpha']
	pA = orbspace['particle_active_beta']
	pv = orbspace['particle_virt_alpha']
	pV = orbspace['particle_virt_beta']

	# AA|VA
	X['bb'][pA,pV,hA,hA] += -1.0 * np.einsum('uv,wx,vUwV,xAuW->UAVW', eta1['a'], gamma1['a'], h['ab'][a,A,a,A], t['ab'][pa,pV,ha,hA], optimize=True)
	X['bb'][pA,pV,hA,hA] += 1.0 * np.einsum('uv,wx,xUuV,vAwW->UAVW', eta1['a'], gamma1['a'], h['ab'][a,A,a,A], t['ab'][pa,pV,ha,hA], optimize=True)
	X['bb'][pA,pV,hA,hA] += 1.0 * np.einsum('uv,iUuV,vAiW->UAVW', eta1['a'], h['ab'][c,A,a,A], t['ab'][pa,pV,hc,hA], optimize=True)
	X['bb'][pA,pV,hA,hA] += -1.0 * np.einsum('uv,iAuU,vViW->VAUW', eta1['a'], h['ab'][c,V,a,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['bb'][pA,pV,hA,hA] += -0.25 * np.einsum('XY,ZP,YPUV,WAXZ->WAUV', eta1['b'], eta1['b'], h['bb'][A,A,A,A], t['bb'][pA,pV,hA,hA], optimize=True)
	X['bb'][pA,pV,hA,hA] += 1.0 * np.einsum('XY,ZP,UYVZ,PAWX->UAVW', eta1['b'], gamma1['b'], h['bb'][A,A,A,A], t['bb'][pA,pV,hA,hA], optimize=True)
	X['bb'][pA,pV,hA,hA] += -1.0 * np.einsum('XY,ZP,UPVX,YAWZ->UAVW', eta1['b'], gamma1['b'], h['bb'][A,A,A,A], t['bb'][pA,pV,hA,hA], optimize=True)
	X['bb'][pA,pV,hA,hA] += -1.0 * np.einsum('XY,IUVX,YAIW->UAVW', eta1['b'], h['bb'][C,A,A,A], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pA,pV,hA,hA] += -1.0 * np.einsum('XY,IAUX,VYIW->VAUW', eta1['b'], h['bb'][C,V,A,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['bb'][pA,pV,hA,hA] += 0.5 * np.einsum('XY,UX,YAVW->UAVW', eta1['b'], h['b'][A,A], t['bb'][pA,pV,hA,hA], optimize=True)
	X['bb'][pA,pV,hA,hA] += 0.5 * np.einsum('XY,UAXB,YBVW->UAVW', eta1['b'], h['bb'][A,V,A,V], t['bb'][pA,pV,hA,hA], optimize=True)
	X['bb'][pA,pV,hA,hA] += 1.0 * np.einsum('XY,YU,VAWX->VAUW', eta1['b'], h['b'][A,A], t['bb'][pA,pV,hA,hA], optimize=True)
	X['bb'][pA,pV,hA,hA] += 1.0 * np.einsum('uv,vUaV,aAuW->UAVW', gamma1['a'], h['ab'][a,A,v,A], t['ab'][pv,pV,ha,hA], optimize=True)
	X['bb'][pA,pV,hA,hA] += -1.0 * np.einsum('uv,vAaU,aVuW->VAUW', gamma1['a'], h['ab'][a,V,v,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['bb'][pA,pV,hA,hA] += 0.25 * np.einsum('XY,ZP,YPUV,WAXZ->WAUV', gamma1['b'], gamma1['b'], h['bb'][A,A,A,A], t['bb'][pA,pV,hA,hA], optimize=True)
	X['bb'][pA,pV,hA,hA] += 0.5 * np.einsum('XY,IYUV,WAIX->WAUV', gamma1['b'], h['bb'][C,A,A,A], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pA,pV,hA,hA] += 0.5 * np.einsum('XY,UX,YAVW->UAVW', gamma1['b'], h['b'][A,A], t['bb'][pA,pV,hA,hA], optimize=True)
	X['bb'][pA,pV,hA,hA] += 1.0 * np.einsum('XY,UYVB,ABWX->UAVW', gamma1['b'], h['bb'][A,A,A,V], t['bb'][pV,pV,hA,hA], optimize=True)
	X['bb'][pA,pV,hA,hA] += 1.0 * np.einsum('XY,YU,VAWX->VAUW', gamma1['b'], h['b'][A,A], t['bb'][pA,pV,hA,hA], optimize=True)
	X['bb'][pA,pV,hA,hA] += 1.0 * np.einsum('XY,YAUB,VBWX->VAUW', gamma1['b'], h['bb'][A,V,A,V], t['bb'][pA,pV,hA,hA], optimize=True)
	X['bb'][pA,pV,hA,hA] += 1.0 * np.einsum('iUaV,aAiW->UAVW', h['ab'][c,A,v,A], t['ab'][pv,pV,hc,hA], optimize=True)
	X['bb'][pA,pV,hA,hA] += -1.0 * np.einsum('iAaU,aViW->VAUW', h['ab'][c,V,v,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['bb'][pA,pV,hA,hA] += -1.0 * np.einsum('IU,VAIW->VAUW', h['b'][C,A], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pA,pV,hA,hA] += 0.25 * np.einsum('IJUV,WAIJ->WAUV', h['bb'][C,C,A,A], t['bb'][pA,pV,hC,hC], optimize=True)
	X['bb'][pA,pV,hA,hA] += 1.0 * np.einsum('IUVB,ABIW->UAVW', h['bb'][C,A,A,V], t['bb'][pV,pV,hC,hA], optimize=True)
	X['bb'][pA,pV,hA,hA] += -1.0 * np.einsum('IAUB,VBIW->VAUW', h['bb'][C,V,A,V], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pA,pV,hA,hA] += -0.5 * np.einsum('UB,ABVW->UAVW', h['b'][A,V], t['bb'][pV,pV,hA,hA], optimize=True)
	X['bb'][pA,pV,hA,hA] += 0.25 * np.einsum('UABC,BCVW->UAVW', h['bb'][A,V,V,V], t['bb'][pV,pV,hA,hA], optimize=True)
	X['bb'][pA,pV,hA,hA] += 0.5 * np.einsum('AB,UBVW->UAVW', h['b'][V,V], t['bb'][pA,pV,hA,hA], optimize=True)
	# AA|VV
	X['bb'][pV,pV,hA,hA] += -1.0 * np.einsum('uv,wx,vAwU,xBuV->ABUV', eta1['a'], gamma1['a'], h['ab'][a,V,a,A], t['ab'][pa,pV,ha,hA], optimize=True)
	X['bb'][pV,pV,hA,hA] += 1.0 * np.einsum('uv,wx,xAuU,vBwV->ABUV', eta1['a'], gamma1['a'], h['ab'][a,V,a,A], t['ab'][pa,pV,ha,hA], optimize=True)
	X['bb'][pV,pV,hA,hA] += 1.0 * np.einsum('uv,iAuU,vBiV->ABUV', eta1['a'], h['ab'][c,V,a,A], t['ab'][pa,pV,hc,hA], optimize=True)
	X['bb'][pV,pV,hA,hA] += -0.125 * np.einsum('WX,YZ,XZUV,ABWY->ABUV', eta1['b'], eta1['b'], h['bb'][A,A,A,A], t['bb'][pV,pV,hA,hA], optimize=True)
	X['bb'][pV,pV,hA,hA] += -1.0 * np.einsum('WX,YZ,XAUY,ZBVW->ABUV', eta1['b'], gamma1['b'], h['bb'][A,V,A,A], t['bb'][pA,pV,hA,hA], optimize=True)
	X['bb'][pV,pV,hA,hA] += 1.0 * np.einsum('WX,YZ,ZAUW,XBVY->ABUV', eta1['b'], gamma1['b'], h['bb'][A,V,A,A], t['bb'][pA,pV,hA,hA], optimize=True)
	X['bb'][pV,pV,hA,hA] += -1.0 * np.einsum('WX,IAUW,XBIV->ABUV', eta1['b'], h['bb'][C,V,A,A], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pV,pV,hA,hA] += 0.5 * np.einsum('WX,XU,ABVW->ABUV', eta1['b'], h['b'][A,A], t['bb'][pV,pV,hA,hA], optimize=True)
	X['bb'][pV,pV,hA,hA] += 0.5 * np.einsum('WX,AW,XBUV->ABUV', eta1['b'], h['b'][V,A], t['bb'][pA,pV,hA,hA], optimize=True)
	X['bb'][pV,pV,hA,hA] += 0.25 * np.einsum('WX,ABWC,XCUV->ABUV', eta1['b'], h['bb'][V,V,A,V], t['bb'][pA,pV,hA,hA], optimize=True)
	X['bb'][pV,pV,hA,hA] += 1.0 * np.einsum('uv,vAaU,aBuV->ABUV', gamma1['a'], h['ab'][a,V,v,A], t['ab'][pv,pV,ha,hA], optimize=True)
	X['bb'][pV,pV,hA,hA] += 0.125 * np.einsum('WX,YZ,XZUV,ABWY->ABUV', gamma1['b'], gamma1['b'], h['bb'][A,A,A,A], t['bb'][pV,pV,hA,hA], optimize=True)
	X['bb'][pV,pV,hA,hA] += 0.25 * np.einsum('WX,IXUV,ABIW->ABUV', gamma1['b'], h['bb'][C,A,A,A], t['bb'][pV,pV,hC,hA], optimize=True)
	X['bb'][pV,pV,hA,hA] += 0.5 * np.einsum('WX,XU,ABVW->ABUV', gamma1['b'], h['b'][A,A], t['bb'][pV,pV,hA,hA], optimize=True)
	X['bb'][pV,pV,hA,hA] += -1.0 * np.einsum('WX,XAUC,BCVW->ABUV', gamma1['b'], h['bb'][A,V,A,V], t['bb'][pV,pV,hA,hA], optimize=True)
	X['bb'][pV,pV,hA,hA] += 0.5 * np.einsum('WX,AW,XBUV->ABUV', gamma1['b'], h['b'][V,A], t['bb'][pA,pV,hA,hA], optimize=True)
	X['bb'][pV,pV,hA,hA] += 1.0 * np.einsum('iAaU,aBiV->ABUV', h['ab'][c,V,v,A], t['ab'][pv,pV,hc,hA], optimize=True)
	X['bb'][pV,pV,hA,hA] += -0.5 * np.einsum('IU,ABIV->ABUV', h['b'][C,A], t['bb'][pV,pV,hC,hA], optimize=True)
	X['bb'][pV,pV,hA,hA] += 0.125 * np.einsum('IJUV,ABIJ->ABUV', h['bb'][C,C,A,A], t['bb'][pV,pV,hC,hC], optimize=True)
	X['bb'][pV,pV,hA,hA] += 1.0 * np.einsum('IAUC,BCIV->ABUV', h['bb'][C,V,A,V], t['bb'][pV,pV,hC,hA], optimize=True)
	X['bb'][pV,pV,hA,hA] += -0.5 * np.einsum('AC,BCUV->ABUV', h['b'][V,V], t['bb'][pV,pV,hA,hA], optimize=True)
	X['bb'][pV,pV,hA,hA] += 0.125 * np.einsum('ABCD,CDUV->ABUV', h['bb'][V,V,V,V], t['bb'][pV,pV,hA,hA], optimize=True)
	# CA|AA
	X['bb'][pA,pA,hC,hA] += 1.0 * np.einsum('uv,wx,vUwV,xWuI->UWIV', eta1['a'], gamma1['a'], h['ab'][a,A,a,A], t['ab'][pa,pA,ha,hC], optimize=True)
	X['bb'][pA,pA,hC,hA] += -1.0 * np.einsum('uv,wx,xUuV,vWwI->UWIV', eta1['a'], gamma1['a'], h['ab'][a,A,a,A], t['ab'][pa,pA,ha,hC], optimize=True)
	X['bb'][pA,pA,hC,hA] += 1.0 * np.einsum('uv,iUuI,vViW->UVIW', eta1['a'], h['ab'][c,A,a,C], t['ab'][pa,pA,hc,hA], optimize=True)
	X['bb'][pA,pA,hC,hA] += -1.0 * np.einsum('uv,iUuV,vWiI->UWIV', eta1['a'], h['ab'][c,A,a,A], t['ab'][pa,pA,hc,hC], optimize=True)
	X['bb'][pA,pA,hC,hA] += 0.25 * np.einsum('XY,ZP,UVXZ,YPIW->UVIW', eta1['b'], eta1['b'], h['bb'][A,A,A,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['bb'][pA,pA,hC,hA] += 1.0 * np.einsum('XY,ZP,UYVZ,WPIX->UWIV', eta1['b'], gamma1['b'], h['bb'][A,A,A,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['bb'][pA,pA,hC,hA] += -1.0 * np.einsum('XY,ZP,UPVX,WYIZ->UWIV', eta1['b'], gamma1['b'], h['bb'][A,A,A,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['bb'][pA,pA,hC,hA] += 1.0 * np.einsum('XY,JUIX,VYJW->UVIW', eta1['b'], h['bb'][C,A,C,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['bb'][pA,pA,hC,hA] += 1.0 * np.einsum('XY,JUVX,WYIJ->UWIV', eta1['b'], h['bb'][C,A,A,A], t['bb'][pA,pA,hC,hC], optimize=True)
	X['bb'][pA,pA,hC,hA] += -1.0 * np.einsum('XY,UX,VYIW->UVIW', eta1['b'], h['b'][A,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['bb'][pA,pA,hC,hA] += 0.5 * np.einsum('XY,UVXA,YAIW->UVIW', eta1['b'], h['bb'][A,A,A,V], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pA,pA,hC,hA] += -0.5 * np.einsum('XY,YU,VWIX->VWIU', eta1['b'], h['b'][A,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['bb'][pA,pA,hC,hA] += 1.0 * np.einsum('uv,vUaI,aVuW->UVIW', gamma1['a'], h['ab'][a,A,v,C], t['ab'][pv,pA,ha,hA], optimize=True)
	X['bb'][pA,pA,hC,hA] += -1.0 * np.einsum('uv,vUaV,aWuI->UWIV', gamma1['a'], h['ab'][a,A,v,A], t['ab'][pv,pA,ha,hC], optimize=True)
	X['bb'][pA,pA,hC,hA] += -0.25 * np.einsum('XY,ZP,UVXZ,YPIW->UVIW', gamma1['b'], gamma1['b'], h['bb'][A,A,A,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['bb'][pA,pA,hC,hA] += 0.5 * np.einsum('XY,JYIU,VWJX->VWIU', gamma1['b'], h['bb'][C,A,C,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['bb'][pA,pA,hC,hA] += -1.0 * np.einsum('XY,UX,VYIW->UVIW', gamma1['b'], h['b'][A,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['bb'][pA,pA,hC,hA] += 1.0 * np.einsum('XY,UYIA,VAWX->UVIW', gamma1['b'], h['bb'][A,A,C,V], t['bb'][pA,pV,hA,hA], optimize=True)
	X['bb'][pA,pA,hC,hA] += -1.0 * np.einsum('XY,UYVA,WAIX->UWIV', gamma1['b'], h['bb'][A,A,A,V], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pA,pA,hC,hA] += -0.5 * np.einsum('XY,YU,VWIX->VWIU', gamma1['b'], h['b'][A,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['bb'][pA,pA,hC,hA] += 1.0 * np.einsum('iUaI,aViW->UVIW', h['ab'][c,A,v,C], t['ab'][pv,pA,hc,hA], optimize=True)
	X['bb'][pA,pA,hC,hA] += -1.0 * np.einsum('iUaV,aWiI->UWIV', h['ab'][c,A,v,A], t['ab'][pv,pA,hc,hC], optimize=True)
	X['bb'][pA,pA,hC,hA] += -0.5 * np.einsum('JI,UVJW->UVIW', h['b'][C,C], t['bb'][pA,pA,hC,hA], optimize=True)
	X['bb'][pA,pA,hC,hA] += -0.5 * np.einsum('JU,VWIJ->VWIU', h['b'][C,A], t['bb'][pA,pA,hC,hC], optimize=True)
	X['bb'][pA,pA,hC,hA] += 0.25 * np.einsum('JKIU,VWJK->VWIU', h['bb'][C,C,C,A], t['bb'][pA,pA,hC,hC], optimize=True)
	X['bb'][pA,pA,hC,hA] += 1.0 * np.einsum('JUIA,VAJW->UVIW', h['bb'][C,A,C,V], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pA,pA,hC,hA] += 1.0 * np.einsum('JUVA,WAIJ->UWIV', h['bb'][C,A,A,V], t['bb'][pA,pV,hC,hC], optimize=True)
	X['bb'][pA,pA,hC,hA] += -1.0 * np.einsum('UA,VAIW->UVIW', h['b'][A,V], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pA,pA,hC,hA] += 0.25 * np.einsum('UVAB,ABIW->UVIW', h['bb'][A,A,V,V], t['bb'][pV,pV,hC,hA], optimize=True)
	# CA|VA
	X['bb'][pA,pV,hC,hA] += -1.0 * np.einsum('uv,wx,vUwI,xAuV->UAIV', eta1['a'], gamma1['a'], h['ab'][a,A,a,C], t['ab'][pa,pV,ha,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += 1.0 * np.einsum('uv,wx,vUwV,xAuI->UAIV', eta1['a'], gamma1['a'], h['ab'][a,A,a,A], t['ab'][pa,pV,ha,hC], optimize=True)
	X['bb'][pA,pV,hC,hA] += -1.0 * np.einsum('uv,wx,vAwU,xVuI->VAIU', eta1['a'], gamma1['a'], h['ab'][a,V,a,A], t['ab'][pa,pA,ha,hC], optimize=True)
	X['bb'][pA,pV,hC,hA] += 1.0 * np.einsum('uv,wx,xUuI,vAwV->UAIV', eta1['a'], gamma1['a'], h['ab'][a,A,a,C], t['ab'][pa,pV,ha,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += -1.0 * np.einsum('uv,wx,xUuV,vAwI->UAIV', eta1['a'], gamma1['a'], h['ab'][a,A,a,A], t['ab'][pa,pV,ha,hC], optimize=True)
	X['bb'][pA,pV,hC,hA] += 1.0 * np.einsum('uv,wx,xAuU,vVwI->VAIU', eta1['a'], gamma1['a'], h['ab'][a,V,a,A], t['ab'][pa,pA,ha,hC], optimize=True)
	X['bb'][pA,pV,hC,hA] += 1.0 * np.einsum('uv,iUuI,vAiV->UAIV', eta1['a'], h['ab'][c,A,a,C], t['ab'][pa,pV,hc,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += -1.0 * np.einsum('uv,iUuV,vAiI->UAIV', eta1['a'], h['ab'][c,A,a,A], t['ab'][pa,pV,hc,hC], optimize=True)
	X['bb'][pA,pV,hC,hA] += -1.0 * np.einsum('uv,iAuI,vUiV->UAIV', eta1['a'], h['ab'][c,V,a,C], t['ab'][pa,pA,hc,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += 1.0 * np.einsum('uv,iAuU,vViI->VAIU', eta1['a'], h['ab'][c,V,a,A], t['ab'][pa,pA,hc,hC], optimize=True)
	X['bb'][pA,pV,hC,hA] += 0.5 * np.einsum('WX,YZ,UAWY,XZIV->UAIV', eta1['b'], eta1['b'], h['bb'][A,V,A,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += -0.5 * np.einsum('WX,YZ,XZIU,VAWY->VAIU', eta1['b'], eta1['b'], h['bb'][A,A,C,A], t['bb'][pA,pV,hA,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += 1.0 * np.einsum('WX,YZ,UXIY,ZAVW->UAIV', eta1['b'], gamma1['b'], h['bb'][A,A,C,A], t['bb'][pA,pV,hA,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += -1.0 * np.einsum('WX,YZ,UXVY,ZAIW->UAIV', eta1['b'], gamma1['b'], h['bb'][A,A,A,A], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += -1.0 * np.einsum('WX,YZ,UZIW,XAVY->UAIV', eta1['b'], gamma1['b'], h['bb'][A,A,C,A], t['bb'][pA,pV,hA,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += 1.0 * np.einsum('WX,YZ,UZVW,XAIY->UAIV', eta1['b'], gamma1['b'], h['bb'][A,A,A,A], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += 1.0 * np.einsum('WX,YZ,XAUY,VZIW->VAIU', eta1['b'], gamma1['b'], h['bb'][A,V,A,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += -1.0 * np.einsum('WX,YZ,ZAUW,VXIY->VAIU', eta1['b'], gamma1['b'], h['bb'][A,V,A,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += -1.0 * np.einsum('WX,JUIW,XAJV->UAIV', eta1['b'], h['bb'][C,A,C,A], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += -1.0 * np.einsum('WX,JUVW,XAIJ->UAIV', eta1['b'], h['bb'][C,A,A,A], t['bb'][pA,pV,hC,hC], optimize=True)
	X['bb'][pA,pV,hC,hA] += -1.0 * np.einsum('WX,JAIW,UXJV->UAIV', eta1['b'], h['bb'][C,V,C,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += -1.0 * np.einsum('WX,JAUW,VXIJ->VAIU', eta1['b'], h['bb'][C,V,A,A], t['bb'][pA,pA,hC,hC], optimize=True)
	X['bb'][pA,pV,hC,hA] += 1.0 * np.einsum('WX,UW,XAIV->UAIV', eta1['b'], h['b'][A,A], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += 1.0 * np.einsum('WX,UAWB,XBIV->UAIV', eta1['b'], h['bb'][A,V,A,V], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += 1.0 * np.einsum('WX,XI,UAVW->UAIV', eta1['b'], h['b'][A,C], t['bb'][pA,pV,hA,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += -1.0 * np.einsum('WX,XU,VAIW->VAIU', eta1['b'], h['b'][A,A], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += 1.0 * np.einsum('WX,AW,UXIV->UAIV', eta1['b'], h['b'][V,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += 1.0 * np.einsum('uv,vUaI,aAuV->UAIV', gamma1['a'], h['ab'][a,A,v,C], t['ab'][pv,pV,ha,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += -1.0 * np.einsum('uv,vUaV,aAuI->UAIV', gamma1['a'], h['ab'][a,A,v,A], t['ab'][pv,pV,ha,hC], optimize=True)
	X['bb'][pA,pV,hC,hA] += -1.0 * np.einsum('uv,vAaI,aUuV->UAIV', gamma1['a'], h['ab'][a,V,v,C], t['ab'][pv,pA,ha,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += 1.0 * np.einsum('uv,vAaU,aVuI->VAIU', gamma1['a'], h['ab'][a,V,v,A], t['ab'][pv,pA,ha,hC], optimize=True)
	X['bb'][pA,pV,hC,hA] += -0.5 * np.einsum('WX,YZ,UAWY,XZIV->UAIV', gamma1['b'], gamma1['b'], h['bb'][A,V,A,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += 0.5 * np.einsum('WX,YZ,XZIU,VAWY->VAIU', gamma1['b'], gamma1['b'], h['bb'][A,A,C,A], t['bb'][pA,pV,hA,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += 1.0 * np.einsum('WX,JXIU,VAJW->VAIU', gamma1['b'], h['bb'][C,A,C,A], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += 1.0 * np.einsum('WX,UW,XAIV->UAIV', gamma1['b'], h['b'][A,A], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += 1.0 * np.einsum('WX,UXIB,ABVW->UAIV', gamma1['b'], h['bb'][A,A,C,V], t['bb'][pV,pV,hA,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += -1.0 * np.einsum('WX,UXVB,ABIW->UAIV', gamma1['b'], h['bb'][A,A,A,V], t['bb'][pV,pV,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += 1.0 * np.einsum('WX,XI,UAVW->UAIV', gamma1['b'], h['b'][A,C], t['bb'][pA,pV,hA,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += -1.0 * np.einsum('WX,XU,VAIW->VAIU', gamma1['b'], h['b'][A,A], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += 1.0 * np.einsum('WX,XAIB,UBVW->UAIV', gamma1['b'], h['bb'][A,V,C,V], t['bb'][pA,pV,hA,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += -1.0 * np.einsum('WX,XAUB,VBIW->VAIU', gamma1['b'], h['bb'][A,V,A,V], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += 1.0 * np.einsum('WX,AW,UXIV->UAIV', gamma1['b'], h['b'][V,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += 1.0 * np.einsum('iUaI,aAiV->UAIV', h['ab'][c,A,v,C], t['ab'][pv,pV,hc,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += -1.0 * np.einsum('iUaV,aAiI->UAIV', h['ab'][c,A,v,A], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pA,pV,hC,hA] += -1.0 * np.einsum('iAaI,aUiV->UAIV', h['ab'][c,V,v,C], t['ab'][pv,pA,hc,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += 1.0 * np.einsum('iAaU,aViI->VAIU', h['ab'][c,V,v,A], t['ab'][pv,pA,hc,hC], optimize=True)
	X['bb'][pA,pV,hC,hA] += -1.0 * np.einsum('JI,UAJV->UAIV', h['b'][C,C], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += -1.0 * np.einsum('JU,VAIJ->VAIU', h['b'][C,A], t['bb'][pA,pV,hC,hC], optimize=True)
	X['bb'][pA,pV,hC,hA] += 0.5 * np.einsum('JKIU,VAJK->VAIU', h['bb'][C,C,C,A], t['bb'][pA,pV,hC,hC], optimize=True)
	X['bb'][pA,pV,hC,hA] += 1.0 * np.einsum('JUIB,ABJV->UAIV', h['bb'][C,A,C,V], t['bb'][pV,pV,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += 1.0 * np.einsum('JUVB,ABIJ->UAIV', h['bb'][C,A,A,V], t['bb'][pV,pV,hC,hC], optimize=True)
	X['bb'][pA,pV,hC,hA] += -1.0 * np.einsum('JAIB,UBJV->UAIV', h['bb'][C,V,C,V], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += -1.0 * np.einsum('JAUB,VBIJ->VAIU', h['bb'][C,V,A,V], t['bb'][pA,pV,hC,hC], optimize=True)
	X['bb'][pA,pV,hC,hA] += -1.0 * np.einsum('UB,ABIV->UAIV', h['b'][A,V], t['bb'][pV,pV,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += 0.5 * np.einsum('UABC,BCIV->UAIV', h['bb'][A,V,V,V], t['bb'][pV,pV,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += 1.0 * np.einsum('AB,UBIV->UAIV', h['b'][V,V], t['bb'][pA,pV,hC,hA], optimize=True)
	# CA|VV
	X['bb'][pV,pV,hC,hA] += -1.0 * np.einsum('uv,wx,vAwI,xBuU->ABIU', eta1['a'], gamma1['a'], h['ab'][a,V,a,C], t['ab'][pa,pV,ha,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += 1.0 * np.einsum('uv,wx,vAwU,xBuI->ABIU', eta1['a'], gamma1['a'], h['ab'][a,V,a,A], t['ab'][pa,pV,ha,hC], optimize=True)
	X['bb'][pV,pV,hC,hA] += 1.0 * np.einsum('uv,wx,xAuI,vBwU->ABIU', eta1['a'], gamma1['a'], h['ab'][a,V,a,C], t['ab'][pa,pV,ha,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += -1.0 * np.einsum('uv,wx,xAuU,vBwI->ABIU', eta1['a'], gamma1['a'], h['ab'][a,V,a,A], t['ab'][pa,pV,ha,hC], optimize=True)
	X['bb'][pV,pV,hC,hA] += 1.0 * np.einsum('uv,iAuI,vBiU->ABIU', eta1['a'], h['ab'][c,V,a,C], t['ab'][pa,pV,hc,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += -1.0 * np.einsum('uv,iAuU,vBiI->ABIU', eta1['a'], h['ab'][c,V,a,A], t['ab'][pa,pV,hc,hC], optimize=True)
	X['bb'][pV,pV,hC,hA] += -0.25 * np.einsum('VW,XY,WYIU,ABVX->ABIU', eta1['b'], eta1['b'], h['bb'][A,A,C,A], t['bb'][pV,pV,hA,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += 0.25 * np.einsum('VW,XY,ABVX,WYIU->ABIU', eta1['b'], eta1['b'], h['bb'][V,V,A,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += -1.0 * np.einsum('VW,XY,WAIX,YBUV->ABIU', eta1['b'], gamma1['b'], h['bb'][A,V,C,A], t['bb'][pA,pV,hA,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += 1.0 * np.einsum('VW,XY,WAUX,YBIV->ABIU', eta1['b'], gamma1['b'], h['bb'][A,V,A,A], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += 1.0 * np.einsum('VW,XY,YAIV,WBUX->ABIU', eta1['b'], gamma1['b'], h['bb'][A,V,C,A], t['bb'][pA,pV,hA,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += -1.0 * np.einsum('VW,XY,YAUV,WBIX->ABIU', eta1['b'], gamma1['b'], h['bb'][A,V,A,A], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += -1.0 * np.einsum('VW,JAIV,WBJU->ABIU', eta1['b'], h['bb'][C,V,C,A], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += -1.0 * np.einsum('VW,JAUV,WBIJ->ABIU', eta1['b'], h['bb'][C,V,A,A], t['bb'][pA,pV,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hA] += 0.5 * np.einsum('VW,WI,ABUV->ABIU', eta1['b'], h['b'][A,C], t['bb'][pV,pV,hA,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += -0.5 * np.einsum('VW,WU,ABIV->ABIU', eta1['b'], h['b'][A,A], t['bb'][pV,pV,hC,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += 1.0 * np.einsum('VW,AV,WBIU->ABIU', eta1['b'], h['b'][V,A], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += 0.5 * np.einsum('VW,ABVC,WCIU->ABIU', eta1['b'], h['bb'][V,V,A,V], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += 1.0 * np.einsum('uv,vAaI,aBuU->ABIU', gamma1['a'], h['ab'][a,V,v,C], t['ab'][pv,pV,ha,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += -1.0 * np.einsum('uv,vAaU,aBuI->ABIU', gamma1['a'], h['ab'][a,V,v,A], t['ab'][pv,pV,ha,hC], optimize=True)
	X['bb'][pV,pV,hC,hA] += 0.25 * np.einsum('VW,XY,WYIU,ABVX->ABIU', gamma1['b'], gamma1['b'], h['bb'][A,A,C,A], t['bb'][pV,pV,hA,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += -0.25 * np.einsum('VW,XY,ABVX,WYIU->ABIU', gamma1['b'], gamma1['b'], h['bb'][V,V,A,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += 0.5 * np.einsum('VW,JWIU,ABJV->ABIU', gamma1['b'], h['bb'][C,A,C,A], t['bb'][pV,pV,hC,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += 0.5 * np.einsum('VW,WI,ABUV->ABIU', gamma1['b'], h['b'][A,C], t['bb'][pV,pV,hA,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += -0.5 * np.einsum('VW,WU,ABIV->ABIU', gamma1['b'], h['b'][A,A], t['bb'][pV,pV,hC,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += -1.0 * np.einsum('VW,WAIC,BCUV->ABIU', gamma1['b'], h['bb'][A,V,C,V], t['bb'][pV,pV,hA,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += 1.0 * np.einsum('VW,WAUC,BCIV->ABIU', gamma1['b'], h['bb'][A,V,A,V], t['bb'][pV,pV,hC,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += 1.0 * np.einsum('VW,AV,WBIU->ABIU', gamma1['b'], h['b'][V,A], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += 1.0 * np.einsum('iAaI,aBiU->ABIU', h['ab'][c,V,v,C], t['ab'][pv,pV,hc,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += -1.0 * np.einsum('iAaU,aBiI->ABIU', h['ab'][c,V,v,A], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pV,pV,hC,hA] += -0.5 * np.einsum('JI,ABJU->ABIU', h['b'][C,C], t['bb'][pV,pV,hC,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += -0.5 * np.einsum('JU,ABIJ->ABIU', h['b'][C,A], t['bb'][pV,pV,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hA] += 0.25 * np.einsum('JKIU,ABJK->ABIU', h['bb'][C,C,C,A], t['bb'][pV,pV,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hA] += 1.0 * np.einsum('JAIC,BCJU->ABIU', h['bb'][C,V,C,V], t['bb'][pV,pV,hC,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += 1.0 * np.einsum('JAUC,BCIJ->ABIU', h['bb'][C,V,A,V], t['bb'][pV,pV,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hA] += -1.0 * np.einsum('AC,BCIU->ABIU', h['b'][V,V], t['bb'][pV,pV,hC,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += 0.25 * np.einsum('ABCD,CDIU->ABIU', h['bb'][V,V,V,V], t['bb'][pV,pV,hC,hA], optimize=True)
	# CC|AA
	X['bb'][pA,pA,hC,hC] += -1.0 * np.einsum('uv,wx,vUwI,xVuJ->UVIJ', eta1['a'], gamma1['a'], h['ab'][a,A,a,C], t['ab'][pa,pA,ha,hC], optimize=True)
	X['bb'][pA,pA,hC,hC] += 1.0 * np.einsum('uv,wx,xUuI,vVwJ->UVIJ', eta1['a'], gamma1['a'], h['ab'][a,A,a,C], t['ab'][pa,pA,ha,hC], optimize=True)
	X['bb'][pA,pA,hC,hC] += 1.0 * np.einsum('uv,iUuI,vViJ->UVIJ', eta1['a'], h['ab'][c,A,a,C], t['ab'][pa,pA,hc,hC], optimize=True)
	X['bb'][pA,pA,hC,hC] += 0.125 * np.einsum('WX,YZ,UVWY,XZIJ->UVIJ', eta1['b'], eta1['b'], h['bb'][A,A,A,A], t['bb'][pA,pA,hC,hC], optimize=True)
	X['bb'][pA,pA,hC,hC] += -1.0 * np.einsum('WX,YZ,UXIY,VZJW->UVIJ', eta1['b'], gamma1['b'], h['bb'][A,A,C,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['bb'][pA,pA,hC,hC] += 1.0 * np.einsum('WX,YZ,UZIW,VXJY->UVIJ', eta1['b'], gamma1['b'], h['bb'][A,A,C,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['bb'][pA,pA,hC,hC] += -1.0 * np.einsum('WX,KUIW,VXJK->UVIJ', eta1['b'], h['bb'][C,A,C,A], t['bb'][pA,pA,hC,hC], optimize=True)
	X['bb'][pA,pA,hC,hC] += -0.5 * np.einsum('WX,UW,VXIJ->UVIJ', eta1['b'], h['b'][A,A], t['bb'][pA,pA,hC,hC], optimize=True)
	X['bb'][pA,pA,hC,hC] += 0.25 * np.einsum('WX,UVWA,XAIJ->UVIJ', eta1['b'], h['bb'][A,A,A,V], t['bb'][pA,pV,hC,hC], optimize=True)
	X['bb'][pA,pA,hC,hC] += 0.5 * np.einsum('WX,XI,UVJW->UVIJ', eta1['b'], h['b'][A,C], t['bb'][pA,pA,hC,hA], optimize=True)
	X['bb'][pA,pA,hC,hC] += 1.0 * np.einsum('uv,vUaI,aVuJ->UVIJ', gamma1['a'], h['ab'][a,A,v,C], t['ab'][pv,pA,ha,hC], optimize=True)
	X['bb'][pA,pA,hC,hC] += -0.125 * np.einsum('WX,YZ,UVWY,XZIJ->UVIJ', gamma1['b'], gamma1['b'], h['bb'][A,A,A,A], t['bb'][pA,pA,hC,hC], optimize=True)
	X['bb'][pA,pA,hC,hC] += 0.25 * np.einsum('WX,KXIJ,UVKW->UVIJ', gamma1['b'], h['bb'][C,A,C,C], t['bb'][pA,pA,hC,hA], optimize=True)
	X['bb'][pA,pA,hC,hC] += -0.5 * np.einsum('WX,UW,VXIJ->UVIJ', gamma1['b'], h['b'][A,A], t['bb'][pA,pA,hC,hC], optimize=True)
	X['bb'][pA,pA,hC,hC] += 1.0 * np.einsum('WX,UXIA,VAJW->UVIJ', gamma1['b'], h['bb'][A,A,C,V], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pA,pA,hC,hC] += 0.5 * np.einsum('WX,XI,UVJW->UVIJ', gamma1['b'], h['b'][A,C], t['bb'][pA,pA,hC,hA], optimize=True)
	X['bb'][pA,pA,hC,hC] += 1.0 * np.einsum('iUaI,aViJ->UVIJ', h['ab'][c,A,v,C], t['ab'][pv,pA,hc,hC], optimize=True)
	X['bb'][pA,pA,hC,hC] += 0.5 * np.einsum('KI,UVJK->UVIJ', h['b'][C,C], t['bb'][pA,pA,hC,hC], optimize=True)
	X['bb'][pA,pA,hC,hC] += 0.125 * np.einsum('KLIJ,UVKL->UVIJ', h['bb'][C,C,C,C], t['bb'][pA,pA,hC,hC], optimize=True)
	X['bb'][pA,pA,hC,hC] += -1.0 * np.einsum('KUIA,VAJK->UVIJ', h['bb'][C,A,C,V], t['bb'][pA,pV,hC,hC], optimize=True)
	X['bb'][pA,pA,hC,hC] += -0.5 * np.einsum('UA,VAIJ->UVIJ', h['b'][A,V], t['bb'][pA,pV,hC,hC], optimize=True)
	X['bb'][pA,pA,hC,hC] += 0.125 * np.einsum('UVAB,ABIJ->UVIJ', h['bb'][A,A,V,V], t['bb'][pV,pV,hC,hC], optimize=True)
	# CC|VA
	X['bb'][pA,pV,hC,hC] += -1.0 * np.einsum('uv,wx,vUwI,xAuJ->UAIJ', eta1['a'], gamma1['a'], h['ab'][a,A,a,C], t['ab'][pa,pV,ha,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += 1.0 * np.einsum('uv,wx,vAwI,xUuJ->UAIJ', eta1['a'], gamma1['a'], h['ab'][a,V,a,C], t['ab'][pa,pA,ha,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += 1.0 * np.einsum('uv,wx,xUuI,vAwJ->UAIJ', eta1['a'], gamma1['a'], h['ab'][a,A,a,C], t['ab'][pa,pV,ha,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += -1.0 * np.einsum('uv,wx,xAuI,vUwJ->UAIJ', eta1['a'], gamma1['a'], h['ab'][a,V,a,C], t['ab'][pa,pA,ha,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += 1.0 * np.einsum('uv,iUuI,vAiJ->UAIJ', eta1['a'], h['ab'][c,A,a,C], t['ab'][pa,pV,hc,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += -1.0 * np.einsum('uv,iAuI,vUiJ->UAIJ', eta1['a'], h['ab'][c,V,a,C], t['ab'][pa,pA,hc,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += 0.25 * np.einsum('VW,XY,UAVX,WYIJ->UAIJ', eta1['b'], eta1['b'], h['bb'][A,V,A,A], t['bb'][pA,pA,hC,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += -0.25 * np.einsum('VW,XY,WYIJ,UAVX->UAIJ', eta1['b'], eta1['b'], h['bb'][A,A,C,C], t['bb'][pA,pV,hA,hA], optimize=True)
	X['bb'][pA,pV,hC,hC] += 1.0 * np.einsum('VW,XY,UWIX,YAJV->UAIJ', eta1['b'], gamma1['b'], h['bb'][A,A,C,A], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hC] += -1.0 * np.einsum('VW,XY,UYIV,WAJX->UAIJ', eta1['b'], gamma1['b'], h['bb'][A,A,C,A], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hC] += -1.0 * np.einsum('VW,XY,WAIX,UYJV->UAIJ', eta1['b'], gamma1['b'], h['bb'][A,V,C,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hC] += 1.0 * np.einsum('VW,XY,YAIV,UWJX->UAIJ', eta1['b'], gamma1['b'], h['bb'][A,V,C,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hC] += 1.0 * np.einsum('VW,KUIV,WAJK->UAIJ', eta1['b'], h['bb'][C,A,C,A], t['bb'][pA,pV,hC,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += 1.0 * np.einsum('VW,KAIV,UWJK->UAIJ', eta1['b'], h['bb'][C,V,C,A], t['bb'][pA,pA,hC,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += 0.5 * np.einsum('VW,UV,WAIJ->UAIJ', eta1['b'], h['b'][A,A], t['bb'][pA,pV,hC,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += 0.5 * np.einsum('VW,UAVB,WBIJ->UAIJ', eta1['b'], h['bb'][A,V,A,V], t['bb'][pA,pV,hC,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += 1.0 * np.einsum('VW,WI,UAJV->UAIJ', eta1['b'], h['b'][A,C], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hC] += 0.5 * np.einsum('VW,AV,UWIJ->UAIJ', eta1['b'], h['b'][V,A], t['bb'][pA,pA,hC,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += 1.0 * np.einsum('uv,vUaI,aAuJ->UAIJ', gamma1['a'], h['ab'][a,A,v,C], t['ab'][pv,pV,ha,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += -1.0 * np.einsum('uv,vAaI,aUuJ->UAIJ', gamma1['a'], h['ab'][a,V,v,C], t['ab'][pv,pA,ha,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += -0.25 * np.einsum('VW,XY,UAVX,WYIJ->UAIJ', gamma1['b'], gamma1['b'], h['bb'][A,V,A,A], t['bb'][pA,pA,hC,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += 0.25 * np.einsum('VW,XY,WYIJ,UAVX->UAIJ', gamma1['b'], gamma1['b'], h['bb'][A,A,C,C], t['bb'][pA,pV,hA,hA], optimize=True)
	X['bb'][pA,pV,hC,hC] += 0.5 * np.einsum('VW,KWIJ,UAKV->UAIJ', gamma1['b'], h['bb'][C,A,C,C], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hC] += 0.5 * np.einsum('VW,UV,WAIJ->UAIJ', gamma1['b'], h['b'][A,A], t['bb'][pA,pV,hC,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += 1.0 * np.einsum('VW,UWIB,ABJV->UAIJ', gamma1['b'], h['bb'][A,A,C,V], t['bb'][pV,pV,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hC] += 1.0 * np.einsum('VW,WI,UAJV->UAIJ', gamma1['b'], h['b'][A,C], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hC] += 1.0 * np.einsum('VW,WAIB,UBJV->UAIJ', gamma1['b'], h['bb'][A,V,C,V], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hC] += 0.5 * np.einsum('VW,AV,UWIJ->UAIJ', gamma1['b'], h['b'][V,A], t['bb'][pA,pA,hC,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += 1.0 * np.einsum('iUaI,aAiJ->UAIJ', h['ab'][c,A,v,C], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += -1.0 * np.einsum('iAaI,aUiJ->UAIJ', h['ab'][c,V,v,C], t['ab'][pv,pA,hc,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += 1.0 * np.einsum('KI,UAJK->UAIJ', h['b'][C,C], t['bb'][pA,pV,hC,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += 0.25 * np.einsum('KLIJ,UAKL->UAIJ', h['bb'][C,C,C,C], t['bb'][pA,pV,hC,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += -1.0 * np.einsum('KUIB,ABJK->UAIJ', h['bb'][C,A,C,V], t['bb'][pV,pV,hC,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += 1.0 * np.einsum('KAIB,UBJK->UAIJ', h['bb'][C,V,C,V], t['bb'][pA,pV,hC,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += -0.5 * np.einsum('UB,ABIJ->UAIJ', h['b'][A,V], t['bb'][pV,pV,hC,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += 0.25 * np.einsum('UABC,BCIJ->UAIJ', h['bb'][A,V,V,V], t['bb'][pV,pV,hC,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += 0.5 * np.einsum('AB,UBIJ->UAIJ', h['b'][V,V], t['bb'][pA,pV,hC,hC], optimize=True)
	# CC|VV
	X['bb'][pV,pV,hC,hC] += -1.0 * np.einsum('uv,wx,vAwI,xBuJ->ABIJ', eta1['a'], gamma1['a'], h['ab'][a,V,a,C], t['ab'][pa,pV,ha,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += 1.0 * np.einsum('uv,wx,xAuI,vBwJ->ABIJ', eta1['a'], gamma1['a'], h['ab'][a,V,a,C], t['ab'][pa,pV,ha,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += 1.0 * np.einsum('uv,iAuI,vBiJ->ABIJ', eta1['a'], h['ab'][c,V,a,C], t['ab'][pa,pV,hc,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += -0.125 * np.einsum('UV,WX,VXIJ,ABUW->ABIJ', eta1['b'], eta1['b'], h['bb'][A,A,C,C], t['bb'][pV,pV,hA,hA], optimize=True)
	X['bb'][pV,pV,hC,hC] += 0.125 * np.einsum('UV,WX,ABUW,VXIJ->ABIJ', eta1['b'], eta1['b'], h['bb'][V,V,A,A], t['bb'][pA,pA,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += -1.0 * np.einsum('UV,WX,VAIW,XBJU->ABIJ', eta1['b'], gamma1['b'], h['bb'][A,V,C,A], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pV,pV,hC,hC] += 1.0 * np.einsum('UV,WX,XAIU,VBJW->ABIJ', eta1['b'], gamma1['b'], h['bb'][A,V,C,A], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pV,pV,hC,hC] += 1.0 * np.einsum('UV,KAIU,VBJK->ABIJ', eta1['b'], h['bb'][C,V,C,A], t['bb'][pA,pV,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += 0.5 * np.einsum('UV,VI,ABJU->ABIJ', eta1['b'], h['b'][A,C], t['bb'][pV,pV,hC,hA], optimize=True)
	X['bb'][pV,pV,hC,hC] += 0.5 * np.einsum('UV,AU,VBIJ->ABIJ', eta1['b'], h['b'][V,A], t['bb'][pA,pV,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += 0.25 * np.einsum('UV,ABUC,VCIJ->ABIJ', eta1['b'], h['bb'][V,V,A,V], t['bb'][pA,pV,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += 1.0 * np.einsum('uv,vAaI,aBuJ->ABIJ', gamma1['a'], h['ab'][a,V,v,C], t['ab'][pv,pV,ha,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += 0.125 * np.einsum('UV,WX,VXIJ,ABUW->ABIJ', gamma1['b'], gamma1['b'], h['bb'][A,A,C,C], t['bb'][pV,pV,hA,hA], optimize=True)
	X['bb'][pV,pV,hC,hC] += -0.125 * np.einsum('UV,WX,ABUW,VXIJ->ABIJ', gamma1['b'], gamma1['b'], h['bb'][V,V,A,A], t['bb'][pA,pA,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += 0.25 * np.einsum('UV,KVIJ,ABKU->ABIJ', gamma1['b'], h['bb'][C,A,C,C], t['bb'][pV,pV,hC,hA], optimize=True)
	X['bb'][pV,pV,hC,hC] += 0.5 * np.einsum('UV,VI,ABJU->ABIJ', gamma1['b'], h['b'][A,C], t['bb'][pV,pV,hC,hA], optimize=True)
	X['bb'][pV,pV,hC,hC] += -1.0 * np.einsum('UV,VAIC,BCJU->ABIJ', gamma1['b'], h['bb'][A,V,C,V], t['bb'][pV,pV,hC,hA], optimize=True)
	X['bb'][pV,pV,hC,hC] += 0.5 * np.einsum('UV,AU,VBIJ->ABIJ', gamma1['b'], h['b'][V,A], t['bb'][pA,pV,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += 1.0 * np.einsum('iAaI,aBiJ->ABIJ', h['ab'][c,V,v,C], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += 0.5 * np.einsum('KI,ABJK->ABIJ', h['b'][C,C], t['bb'][pV,pV,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += 0.125 * np.einsum('KLIJ,ABKL->ABIJ', h['bb'][C,C,C,C], t['bb'][pV,pV,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += -1.0 * np.einsum('KAIC,BCJK->ABIJ', h['bb'][C,V,C,V], t['bb'][pV,pV,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += -0.5 * np.einsum('AC,BCIJ->ABIJ', h['b'][V,V], t['bb'][pV,pV,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += 0.125 * np.einsum('ABCD,CDIJ->ABIJ', h['bb'][V,V,V,V], t['bb'][pV,pV,hC,hC], optimize=True)
	# aA|Av
	X['ab'][pv,pA,ha,hA] += 1.0 * np.einsum('vw,xy,wUxV,yauv->aUuV', eta1['a'], gamma1['a'], h['ab'][a,A,a,A], t['aa'][pa,pv,ha,ha], optimize=True)
	X['ab'][pv,pA,ha,hA] += -1.0 * np.einsum('vw,xy,yUvV,waux->aUuV', eta1['a'], gamma1['a'], h['ab'][a,A,a,A], t['aa'][pa,pv,ha,ha], optimize=True)
	X['ab'][pv,pA,ha,hA] += 1.0 * np.einsum('vw,WX,wUuW,aXvV->aUuV', eta1['a'], gamma1['b'], h['ab'][a,A,a,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,ha,hA] += -1.0 * np.einsum('vw,iauv,wUiV->aUuV', eta1['a'], h['aa'][c,v,a,a], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,ha,hA] += 1.0 * np.einsum('vw,iUvV,waiu->aUuV', eta1['a'], h['ab'][c,A,a,A], t['aa'][pa,pv,hc,ha], optimize=True)
	X['ab'][pv,pA,ha,hA] += -1.0 * np.einsum('vw,wu,aUvV->aUuV', eta1['a'], h['a'][a,a], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,ha,hA] += -1.0 * np.einsum('vw,aIvU,wVuI->aVuU', eta1['a'], h['ab'][v,C,a,A], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,ha,hA] += 1.0 * np.einsum('vw,aUvA,wAuV->aUuV', eta1['a'], h['ab'][v,A,a,V], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pv,pA,ha,hA] += -1.0 * np.einsum('WX,vw,wXuU,aVvW->aVuU', eta1['b'], eta1['a'], h['ab'][a,A,a,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,ha,hA] += -1.0 * np.einsum('WX,vw,wUuW,aXvV->aUuV', eta1['b'], gamma1['a'], h['ab'][a,A,a,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,ha,hA] += -1.0 * np.einsum('WX,YZ,UXVY,aZuW->aUuV', eta1['b'], gamma1['b'], h['bb'][A,A,A,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,ha,hA] += 1.0 * np.einsum('WX,YZ,UZVW,aXuY->aUuV', eta1['b'], gamma1['b'], h['bb'][A,A,A,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,ha,hA] += -1.0 * np.einsum('WX,iUuW,aXiV->aUuV', eta1['b'], h['ab'][c,A,a,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,ha,hA] += -1.0 * np.einsum('WX,aIuW,UXIV->aUuV', eta1['b'], h['ab'][v,C,a,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['ab'][pv,pA,ha,hA] += 1.0 * np.einsum('WX,aUbW,bXuV->aUuV', eta1['b'], h['ab'][v,A,v,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,ha,hA] += -1.0 * np.einsum('WX,IUVW,aXuI->aUuV', eta1['b'], h['bb'][C,A,A,A], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,ha,hA] += 1.0 * np.einsum('WX,UW,aXuV->aUuV', eta1['b'], h['b'][A,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,ha,hA] += -1.0 * np.einsum('WX,XU,aVuW->aVuU', eta1['b'], h['b'][A,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,ha,hA] += -1.0 * np.einsum('vw,wu,aUvV->aUuV', gamma1['a'], h['a'][a,a], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,ha,hA] += -1.0 * np.einsum('vw,waub,bUvV->aUuV', gamma1['a'], h['aa'][a,v,a,v], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,ha,hA] += 1.0 * np.einsum('vw,wIuU,aVvI->aVuU', gamma1['a'], h['ab'][a,C,a,A], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,ha,hA] += -1.0 * np.einsum('vw,wUuA,aAvV->aUuV', gamma1['a'], h['ab'][a,A,a,V], t['ab'][pv,pV,ha,hA], optimize=True)
	X['ab'][pv,pA,ha,hA] += 1.0 * np.einsum('vw,wUbV,abuv->aUuV', gamma1['a'], h['ab'][a,A,v,A], t['aa'][pv,pv,ha,ha], optimize=True)
	X['ab'][pv,pA,ha,hA] += 1.0 * np.einsum('WX,vw,wXuU,aVvW->aVuU', gamma1['b'], gamma1['a'], h['ab'][a,A,a,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,ha,hA] += 1.0 * np.einsum('WX,iXuU,aViW->aVuU', gamma1['b'], h['ab'][c,A,a,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,ha,hA] += 1.0 * np.einsum('WX,aXuA,UAVW->aUuV', gamma1['b'], h['ab'][v,A,a,V], t['bb'][pA,pV,hA,hA], optimize=True)
	X['ab'][pv,pA,ha,hA] += -1.0 * np.einsum('WX,aXbU,bVuW->aVuU', gamma1['b'], h['ab'][v,A,v,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,ha,hA] += 1.0 * np.einsum('WX,UW,aXuV->aUuV', gamma1['b'], h['b'][A,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,ha,hA] += 1.0 * np.einsum('WX,UXVA,aAuW->aUuV', gamma1['b'], h['bb'][A,A,A,V], t['ab'][pv,pV,ha,hA], optimize=True)
	X['ab'][pv,pA,ha,hA] += -1.0 * np.einsum('WX,XU,aVuW->aVuU', gamma1['b'], h['b'][A,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,ha,hA] += -1.0 * np.einsum('iu,aUiV->aUuV', h['a'][c,a], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,ha,hA] += -1.0 * np.einsum('iaub,bUiV->aUuV', h['aa'][c,v,a,v], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,ha,hA] += 1.0 * np.einsum('iIuU,aViI->aVuU', h['ab'][c,C,a,A], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,ha,hA] += -1.0 * np.einsum('iUuA,aAiV->aUuV', h['ab'][c,A,a,V], t['ab'][pv,pV,hc,hA], optimize=True)
	X['ab'][pv,pA,ha,hA] += -1.0 * np.einsum('iUbV,abiu->aUuV', h['ab'][c,A,v,A], t['aa'][pv,pv,hc,ha], optimize=True)
	X['ab'][pv,pA,ha,hA] += 1.0 * np.einsum('ab,bUuV->aUuV', h['a'][v,v], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,ha,hA] += -1.0 * np.einsum('aIuA,UAIV->aUuV', h['ab'][v,C,a,V], t['bb'][pA,pV,hC,hA], optimize=True)
	X['ab'][pv,pA,ha,hA] += -1.0 * np.einsum('aIbU,bVuI->aVuU', h['ab'][v,C,v,A], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,ha,hA] += 1.0 * np.einsum('aUbA,bAuV->aUuV', h['ab'][v,A,v,V], t['ab'][pv,pV,ha,hA], optimize=True)
	X['ab'][pv,pA,ha,hA] += -1.0 * np.einsum('IU,aVuI->aVuU', h['b'][C,A], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,ha,hA] += -1.0 * np.einsum('IUVA,aAuI->aUuV', h['bb'][C,A,A,V], t['ab'][pv,pV,ha,hC], optimize=True)
	X['ab'][pv,pA,ha,hA] += 1.0 * np.einsum('UA,aAuV->aUuV', h['b'][A,V], t['ab'][pv,pV,ha,hA], optimize=True)
	# aA|Va
	X['ab'][pa,pV,ha,hA] += -1.0 * np.einsum('wx,yz,uxvy,zAwU->uAvU', eta1['a'], gamma1['a'], h['aa'][a,a,a,a], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,ha,hA] += 1.0 * np.einsum('wx,yz,uzvw,xAyU->uAvU', eta1['a'], gamma1['a'], h['aa'][a,a,a,a], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,ha,hA] += -1.0 * np.einsum('wx,VW,uWwU,xAvV->uAvU', eta1['a'], gamma1['b'], h['ab'][a,A,a,A], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,ha,hA] += -1.0 * np.einsum('wx,iuvw,xAiU->uAvU', eta1['a'], h['aa'][c,a,a,a], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pa,pV,ha,hA] += -1.0 * np.einsum('wx,iAwU,uxiv->uAvU', eta1['a'], h['ab'][c,V,a,A], t['aa'][pa,pa,hc,ha], optimize=True)
	X['ab'][pa,pV,ha,hA] += 1.0 * np.einsum('wx,uw,xAvU->uAvU', eta1['a'], h['a'][a,a], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,ha,hA] += -1.0 * np.einsum('wx,uIwU,xAvI->uAvU', eta1['a'], h['ab'][a,C,a,A], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pa,pV,ha,hA] += 1.0 * np.einsum('wx,uAwB,xBvU->uAvU', eta1['a'], h['ab'][a,V,a,V], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,ha,hA] += -1.0 * np.einsum('wx,xu,vAwU->vAuU', eta1['a'], h['a'][a,a], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,ha,hA] += -1.0 * np.einsum('VW,wx,xWuU,vAwV->vAuU', eta1['b'], eta1['a'], h['ab'][a,A,a,A], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,ha,hA] += 1.0 * np.einsum('VW,wx,uWwU,xAvV->uAvU', eta1['b'], gamma1['a'], h['ab'][a,A,a,A], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,ha,hA] += 1.0 * np.einsum('VW,XY,uWvX,YAUV->uAvU', eta1['b'], gamma1['b'], h['ab'][a,A,a,A], t['bb'][pA,pV,hA,hA], optimize=True)
	X['ab'][pa,pV,ha,hA] += -1.0 * np.einsum('VW,XY,uYvV,WAUX->uAvU', eta1['b'], gamma1['b'], h['ab'][a,A,a,A], t['bb'][pA,pV,hA,hA], optimize=True)
	X['ab'][pa,pV,ha,hA] += -1.0 * np.einsum('VW,iAuV,vWiU->vAuU', eta1['b'], h['ab'][c,V,a,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pV,ha,hA] += 1.0 * np.einsum('VW,uIvV,WAIU->uAvU', eta1['b'], h['ab'][a,C,a,A], t['bb'][pA,pV,hC,hA], optimize=True)
	X['ab'][pa,pV,ha,hA] += 1.0 * np.einsum('VW,uAaV,aWvU->uAvU', eta1['b'], h['ab'][a,V,v,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pa,pV,ha,hA] += -1.0 * np.einsum('VW,IAUV,uWvI->uAvU', eta1['b'], h['bb'][C,V,A,A], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pV,ha,hA] += -1.0 * np.einsum('VW,WU,uAvV->uAvU', eta1['b'], h['b'][A,A], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,ha,hA] += 1.0 * np.einsum('wx,uw,xAvU->uAvU', gamma1['a'], h['a'][a,a], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,ha,hA] += 1.0 * np.einsum('wx,uxva,aAwU->uAvU', gamma1['a'], h['aa'][a,a,a,v], t['ab'][pv,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,ha,hA] += -1.0 * np.einsum('wx,xu,vAwU->vAuU', gamma1['a'], h['a'][a,a], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,ha,hA] += 1.0 * np.einsum('wx,xIuU,vAwI->vAuU', gamma1['a'], h['ab'][a,C,a,A], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pa,pV,ha,hA] += -1.0 * np.einsum('wx,xAuB,vBwU->vAuU', gamma1['a'], h['ab'][a,V,a,V], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,ha,hA] += 1.0 * np.einsum('wx,xAaU,uavw->uAvU', gamma1['a'], h['ab'][a,V,v,A], t['aa'][pa,pv,ha,ha], optimize=True)
	X['ab'][pa,pV,ha,hA] += 1.0 * np.einsum('VW,wx,xWuU,vAwV->vAuU', gamma1['b'], gamma1['a'], h['ab'][a,A,a,A], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,ha,hA] += 1.0 * np.einsum('VW,iWuU,vAiV->vAuU', gamma1['b'], h['ab'][c,A,a,A], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pa,pV,ha,hA] += 1.0 * np.einsum('VW,uWvB,ABUV->uAvU', gamma1['b'], h['ab'][a,A,a,V], t['bb'][pV,pV,hA,hA], optimize=True)
	X['ab'][pa,pV,ha,hA] += -1.0 * np.einsum('VW,uWaU,aAvV->uAvU', gamma1['b'], h['ab'][a,A,v,A], t['ab'][pv,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,ha,hA] += -1.0 * np.einsum('VW,WU,uAvV->uAvU', gamma1['b'], h['b'][A,A], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,ha,hA] += -1.0 * np.einsum('VW,WAUB,uBvV->uAvU', gamma1['b'], h['bb'][A,V,A,V], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,ha,hA] += -1.0 * np.einsum('iu,vAiU->vAuU', h['a'][c,a], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pa,pV,ha,hA] += -1.0 * np.einsum('iuva,aAiU->uAvU', h['aa'][c,a,a,v], t['ab'][pv,pV,hc,hA], optimize=True)
	X['ab'][pa,pV,ha,hA] += 1.0 * np.einsum('iIuU,vAiI->vAuU', h['ab'][c,C,a,A], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pa,pV,ha,hA] += -1.0 * np.einsum('iAuB,vBiU->vAuU', h['ab'][c,V,a,V], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pa,pV,ha,hA] += -1.0 * np.einsum('iAaU,uaiv->uAvU', h['ab'][c,V,v,A], t['aa'][pa,pv,hc,ha], optimize=True)
	X['ab'][pa,pV,ha,hA] += 1.0 * np.einsum('ua,aAvU->uAvU', h['a'][a,v], t['ab'][pv,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,ha,hA] += -1.0 * np.einsum('uIvB,ABIU->uAvU', h['ab'][a,C,a,V], t['bb'][pV,pV,hC,hA], optimize=True)
	X['ab'][pa,pV,ha,hA] += -1.0 * np.einsum('uIaU,aAvI->uAvU', h['ab'][a,C,v,A], t['ab'][pv,pV,ha,hC], optimize=True)
	X['ab'][pa,pV,ha,hA] += 1.0 * np.einsum('uAaB,aBvU->uAvU', h['ab'][a,V,v,V], t['ab'][pv,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,ha,hA] += -1.0 * np.einsum('IU,uAvI->uAvU', h['b'][C,A], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pa,pV,ha,hA] += -1.0 * np.einsum('IAUB,uBvI->uAvU', h['bb'][C,V,A,V], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pa,pV,ha,hA] += 1.0 * np.einsum('AB,uBvU->uAvU', h['b'][V,V], t['ab'][pa,pV,ha,hA], optimize=True)
	# aA|Vv
	X['ab'][pv,pV,ha,hA] += 1.0 * np.einsum('vw,xy,waux,yAvU->aAuU', eta1['a'], gamma1['a'], h['aa'][a,v,a,a], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += 1.0 * np.einsum('vw,xy,wAxU,yauv->aAuU', eta1['a'], gamma1['a'], h['ab'][a,V,a,A], t['aa'][pa,pv,ha,ha], optimize=True)
	X['ab'][pv,pV,ha,hA] += -1.0 * np.einsum('vw,xy,yauv,wAxU->aAuU', eta1['a'], gamma1['a'], h['aa'][a,v,a,a], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += -1.0 * np.einsum('vw,xy,yAvU,waux->aAuU', eta1['a'], gamma1['a'], h['ab'][a,V,a,A], t['aa'][pa,pv,ha,ha], optimize=True)
	X['ab'][pv,pV,ha,hA] += 1.0 * np.einsum('vw,VW,wAuV,aWvU->aAuU', eta1['a'], gamma1['b'], h['ab'][a,V,a,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += -1.0 * np.einsum('vw,VW,aWvU,wAuV->aAuU', eta1['a'], gamma1['b'], h['ab'][v,A,a,A], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += -1.0 * np.einsum('vw,iauv,wAiU->aAuU', eta1['a'], h['aa'][c,v,a,a], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += 1.0 * np.einsum('vw,iAvU,waiu->aAuU', eta1['a'], h['ab'][c,V,a,A], t['aa'][pa,pv,hc,ha], optimize=True)
	X['ab'][pv,pV,ha,hA] += -1.0 * np.einsum('vw,wu,aAvU->aAuU', eta1['a'], h['a'][a,a], t['ab'][pv,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += 1.0 * np.einsum('vw,av,wAuU->aAuU', eta1['a'], h['a'][v,a], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += -1.0 * np.einsum('vw,aIvU,wAuI->aAuU', eta1['a'], h['ab'][v,C,a,A], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hA] += 1.0 * np.einsum('vw,aAvB,wBuU->aAuU', eta1['a'], h['ab'][v,V,a,V], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += -1.0 * np.einsum('VW,vw,wWuU,aAvV->aAuU', eta1['b'], eta1['a'], h['ab'][a,A,a,A], t['ab'][pv,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += -1.0 * np.einsum('VW,vw,wAuV,aWvU->aAuU', eta1['b'], gamma1['a'], h['ab'][a,V,a,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += 1.0 * np.einsum('VW,vw,aWvU,wAuV->aAuU', eta1['b'], gamma1['a'], h['ab'][v,A,a,A], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += 1.0 * np.einsum('VW,XY,aWuX,YAUV->aAuU', eta1['b'], gamma1['b'], h['ab'][v,A,a,A], t['bb'][pA,pV,hA,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += -1.0 * np.einsum('VW,XY,aYuV,WAUX->aAuU', eta1['b'], gamma1['b'], h['ab'][v,A,a,A], t['bb'][pA,pV,hA,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += 1.0 * np.einsum('VW,XY,WAUX,aYuV->aAuU', eta1['b'], gamma1['b'], h['bb'][A,V,A,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += -1.0 * np.einsum('VW,XY,YAUV,aWuX->aAuU', eta1['b'], gamma1['b'], h['bb'][A,V,A,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += -1.0 * np.einsum('VW,iAuV,aWiU->aAuU', eta1['b'], h['ab'][c,V,a,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += 1.0 * np.einsum('VW,aIuV,WAIU->aAuU', eta1['b'], h['ab'][v,C,a,A], t['bb'][pA,pV,hC,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += 1.0 * np.einsum('VW,aAbV,bWuU->aAuU', eta1['b'], h['ab'][v,V,v,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += -1.0 * np.einsum('VW,IAUV,aWuI->aAuU', eta1['b'], h['bb'][C,V,A,A], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hA] += -1.0 * np.einsum('VW,WU,aAuV->aAuU', eta1['b'], h['b'][A,A], t['ab'][pv,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += 1.0 * np.einsum('VW,AV,aWuU->aAuU', eta1['b'], h['b'][V,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += -1.0 * np.einsum('vw,wu,aAvU->aAuU', gamma1['a'], h['a'][a,a], t['ab'][pv,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += -1.0 * np.einsum('vw,waub,bAvU->aAuU', gamma1['a'], h['aa'][a,v,a,v], t['ab'][pv,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += 1.0 * np.einsum('vw,wIuU,aAvI->aAuU', gamma1['a'], h['ab'][a,C,a,A], t['ab'][pv,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hA] += -1.0 * np.einsum('vw,wAuB,aBvU->aAuU', gamma1['a'], h['ab'][a,V,a,V], t['ab'][pv,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += 1.0 * np.einsum('vw,wAbU,abuv->aAuU', gamma1['a'], h['ab'][a,V,v,A], t['aa'][pv,pv,ha,ha], optimize=True)
	X['ab'][pv,pV,ha,hA] += 1.0 * np.einsum('vw,av,wAuU->aAuU', gamma1['a'], h['a'][v,a], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += 1.0 * np.einsum('VW,vw,wWuU,aAvV->aAuU', gamma1['b'], gamma1['a'], h['ab'][a,A,a,A], t['ab'][pv,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += 1.0 * np.einsum('VW,iWuU,aAiV->aAuU', gamma1['b'], h['ab'][c,A,a,A], t['ab'][pv,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += 1.0 * np.einsum('VW,aWuB,ABUV->aAuU', gamma1['b'], h['ab'][v,A,a,V], t['bb'][pV,pV,hA,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += -1.0 * np.einsum('VW,aWbU,bAuV->aAuU', gamma1['b'], h['ab'][v,A,v,A], t['ab'][pv,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += -1.0 * np.einsum('VW,WU,aAuV->aAuU', gamma1['b'], h['b'][A,A], t['ab'][pv,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += -1.0 * np.einsum('VW,WAUB,aBuV->aAuU', gamma1['b'], h['bb'][A,V,A,V], t['ab'][pv,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += 1.0 * np.einsum('VW,AV,aWuU->aAuU', gamma1['b'], h['b'][V,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += -1.0 * np.einsum('iu,aAiU->aAuU', h['a'][c,a], t['ab'][pv,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += -1.0 * np.einsum('iaub,bAiU->aAuU', h['aa'][c,v,a,v], t['ab'][pv,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += 1.0 * np.einsum('iIuU,aAiI->aAuU', h['ab'][c,C,a,A], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,ha,hA] += -1.0 * np.einsum('iAuB,aBiU->aAuU', h['ab'][c,V,a,V], t['ab'][pv,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += -1.0 * np.einsum('iAbU,abiu->aAuU', h['ab'][c,V,v,A], t['aa'][pv,pv,hc,ha], optimize=True)
	X['ab'][pv,pV,ha,hA] += 1.0 * np.einsum('ab,bAuU->aAuU', h['a'][v,v], t['ab'][pv,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += -1.0 * np.einsum('aIuB,ABIU->aAuU', h['ab'][v,C,a,V], t['bb'][pV,pV,hC,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += -1.0 * np.einsum('aIbU,bAuI->aAuU', h['ab'][v,C,v,A], t['ab'][pv,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hA] += 1.0 * np.einsum('aAbB,bBuU->aAuU', h['ab'][v,V,v,V], t['ab'][pv,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += -1.0 * np.einsum('IU,aAuI->aAuU', h['b'][C,A], t['ab'][pv,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hA] += -1.0 * np.einsum('IAUB,aBuI->aAuU', h['bb'][C,V,A,V], t['ab'][pv,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hA] += 1.0 * np.einsum('AB,aBuU->aAuU', h['b'][V,V], t['ab'][pv,pV,ha,hA], optimize=True)
	# aC|Aa
	X['ab'][pa,pA,ha,hC] += -1.0 * np.einsum('wx,yz,uxvy,zUwI->uUvI', eta1['a'], gamma1['a'], h['aa'][a,a,a,a], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pA,ha,hC] += 1.0 * np.einsum('wx,yz,uzvw,xUyI->uUvI', eta1['a'], gamma1['a'], h['aa'][a,a,a,a], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pA,ha,hC] += 1.0 * np.einsum('wx,VW,xUuV,vWwI->vUuI', eta1['a'], gamma1['b'], h['ab'][a,A,a,A], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pA,ha,hC] += -1.0 * np.einsum('wx,iuvw,xUiI->uUvI', eta1['a'], h['aa'][c,a,a,a], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pa,pA,ha,hC] += -1.0 * np.einsum('wx,iUwI,uxiv->uUvI', eta1['a'], h['ab'][c,A,a,C], t['aa'][pa,pa,hc,ha], optimize=True)
	X['ab'][pa,pA,ha,hC] += 1.0 * np.einsum('wx,uw,xUvI->uUvI', eta1['a'], h['a'][a,a], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pA,ha,hC] += -1.0 * np.einsum('wx,uJwI,xUvJ->uUvI', eta1['a'], h['ab'][a,C,a,C], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pA,ha,hC] += 1.0 * np.einsum('wx,uUwA,xAvI->uUvI', eta1['a'], h['ab'][a,A,a,V], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pa,pA,ha,hC] += -1.0 * np.einsum('wx,xu,vUwI->vUuI', eta1['a'], h['a'][a,a], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pA,ha,hC] += 1.0 * np.einsum('VW,wx,uUwV,xWvI->uUvI', eta1['b'], eta1['a'], h['ab'][a,A,a,A], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pA,ha,hC] += -1.0 * np.einsum('VW,wx,xUuV,vWwI->vUuI', eta1['b'], gamma1['a'], h['ab'][a,A,a,A], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pA,ha,hC] += -1.0 * np.einsum('VW,XY,uWvX,UYIV->uUvI', eta1['b'], gamma1['b'], h['ab'][a,A,a,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['ab'][pa,pA,ha,hC] += 1.0 * np.einsum('VW,XY,uYvV,UWIX->uUvI', eta1['b'], gamma1['b'], h['ab'][a,A,a,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['ab'][pa,pA,ha,hC] += -1.0 * np.einsum('VW,iUuV,vWiI->vUuI', eta1['b'], h['ab'][c,A,a,A], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pa,pA,ha,hC] += 1.0 * np.einsum('VW,uJvV,UWIJ->uUvI', eta1['b'], h['ab'][a,C,a,A], t['bb'][pA,pA,hC,hC], optimize=True)
	X['ab'][pa,pA,ha,hC] += 1.0 * np.einsum('VW,uUaV,aWvI->uUvI', eta1['b'], h['ab'][a,A,v,A], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pa,pA,ha,hC] += -1.0 * np.einsum('VW,JUIV,uWvJ->uUvI', eta1['b'], h['bb'][C,A,C,A], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pA,ha,hC] += 1.0 * np.einsum('VW,UV,uWvI->uUvI', eta1['b'], h['b'][A,A], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pA,ha,hC] += 1.0 * np.einsum('wx,uw,xUvI->uUvI', gamma1['a'], h['a'][a,a], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pA,ha,hC] += 1.0 * np.einsum('wx,uxva,aUwI->uUvI', gamma1['a'], h['aa'][a,a,a,v], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pa,pA,ha,hC] += -1.0 * np.einsum('wx,xu,vUwI->vUuI', gamma1['a'], h['a'][a,a], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pA,ha,hC] += 1.0 * np.einsum('wx,xJuI,vUwJ->vUuI', gamma1['a'], h['ab'][a,C,a,C], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pA,ha,hC] += -1.0 * np.einsum('wx,xUuA,vAwI->vUuI', gamma1['a'], h['ab'][a,A,a,V], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pa,pA,ha,hC] += 1.0 * np.einsum('wx,xUaI,uavw->uUvI', gamma1['a'], h['ab'][a,A,v,C], t['aa'][pa,pv,ha,ha], optimize=True)
	X['ab'][pa,pA,ha,hC] += -1.0 * np.einsum('VW,wx,uUwV,xWvI->uUvI', gamma1['b'], gamma1['a'], h['ab'][a,A,a,A], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pA,ha,hC] += 1.0 * np.einsum('VW,iWuI,vUiV->vUuI', gamma1['b'], h['ab'][c,A,a,C], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pA,ha,hC] += 1.0 * np.einsum('VW,uWvA,UAIV->uUvI', gamma1['b'], h['ab'][a,A,a,V], t['bb'][pA,pV,hC,hA], optimize=True)
	X['ab'][pa,pA,ha,hC] += -1.0 * np.einsum('VW,uWaI,aUvV->uUvI', gamma1['b'], h['ab'][a,A,v,C], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pa,pA,ha,hC] += 1.0 * np.einsum('VW,UV,uWvI->uUvI', gamma1['b'], h['b'][A,A], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pA,ha,hC] += 1.0 * np.einsum('VW,UWIA,uAvV->uUvI', gamma1['b'], h['bb'][A,A,C,V], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pA,ha,hC] += -1.0 * np.einsum('iu,vUiI->vUuI', h['a'][c,a], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pa,pA,ha,hC] += -1.0 * np.einsum('iuva,aUiI->uUvI', h['aa'][c,a,a,v], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pa,pA,ha,hC] += 1.0 * np.einsum('iJuI,vUiJ->vUuI', h['ab'][c,C,a,C], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pa,pA,ha,hC] += -1.0 * np.einsum('iUuA,vAiI->vUuI', h['ab'][c,A,a,V], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pa,pA,ha,hC] += -1.0 * np.einsum('iUaI,uaiv->uUvI', h['ab'][c,A,v,C], t['aa'][pa,pv,hc,ha], optimize=True)
	X['ab'][pa,pA,ha,hC] += 1.0 * np.einsum('ua,aUvI->uUvI', h['a'][a,v], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pa,pA,ha,hC] += 1.0 * np.einsum('uJvA,UAIJ->uUvI', h['ab'][a,C,a,V], t['bb'][pA,pV,hC,hC], optimize=True)
	X['ab'][pa,pA,ha,hC] += -1.0 * np.einsum('uJaI,aUvJ->uUvI', h['ab'][a,C,v,C], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pa,pA,ha,hC] += 1.0 * np.einsum('uUaA,aAvI->uUvI', h['ab'][a,A,v,V], t['ab'][pv,pV,ha,hC], optimize=True)
	X['ab'][pa,pA,ha,hC] += -1.0 * np.einsum('JI,uUvJ->uUvI', h['b'][C,C], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pA,ha,hC] += -1.0 * np.einsum('JUIA,uAvJ->uUvI', h['bb'][C,A,C,V], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pa,pA,ha,hC] += 1.0 * np.einsum('UA,uAvI->uUvI', h['b'][A,V], t['ab'][pa,pV,ha,hC], optimize=True)
	# aC|Av
	X['ab'][pv,pA,ha,hC] += 1.0 * np.einsum('vw,xy,waux,yUvI->aUuI', eta1['a'], gamma1['a'], h['aa'][a,v,a,a], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,ha,hC] += 1.0 * np.einsum('vw,xy,wUxI,yauv->aUuI', eta1['a'], gamma1['a'], h['ab'][a,A,a,C], t['aa'][pa,pv,ha,ha], optimize=True)
	X['ab'][pv,pA,ha,hC] += -1.0 * np.einsum('vw,xy,yauv,wUxI->aUuI', eta1['a'], gamma1['a'], h['aa'][a,v,a,a], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,ha,hC] += -1.0 * np.einsum('vw,xy,yUvI,waux->aUuI', eta1['a'], gamma1['a'], h['ab'][a,A,a,C], t['aa'][pa,pv,ha,ha], optimize=True)
	X['ab'][pv,pA,ha,hC] += 1.0 * np.einsum('vw,VW,wUuV,aWvI->aUuI', eta1['a'], gamma1['b'], h['ab'][a,A,a,A], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,ha,hC] += -1.0 * np.einsum('vw,iauv,wUiI->aUuI', eta1['a'], h['aa'][c,v,a,a], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,ha,hC] += 1.0 * np.einsum('vw,iUvI,waiu->aUuI', eta1['a'], h['ab'][c,A,a,C], t['aa'][pa,pv,hc,ha], optimize=True)
	X['ab'][pv,pA,ha,hC] += -1.0 * np.einsum('vw,wu,aUvI->aUuI', eta1['a'], h['a'][a,a], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,ha,hC] += 1.0 * np.einsum('vw,av,wUuI->aUuI', eta1['a'], h['a'][v,a], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,ha,hC] += -1.0 * np.einsum('vw,aJvI,wUuJ->aUuI', eta1['a'], h['ab'][v,C,a,C], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,ha,hC] += 1.0 * np.einsum('vw,aUvA,wAuI->aUuI', eta1['a'], h['ab'][v,A,a,V], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pv,pA,ha,hC] += -1.0 * np.einsum('VW,vw,wWuI,aUvV->aUuI', eta1['b'], eta1['a'], h['ab'][a,A,a,C], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,ha,hC] += 1.0 * np.einsum('VW,vw,aUvV,wWuI->aUuI', eta1['b'], eta1['a'], h['ab'][v,A,a,A], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,ha,hC] += -1.0 * np.einsum('VW,vw,wUuV,aWvI->aUuI', eta1['b'], gamma1['a'], h['ab'][a,A,a,A], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,ha,hC] += -1.0 * np.einsum('VW,XY,aWuX,UYIV->aUuI', eta1['b'], gamma1['b'], h['ab'][v,A,a,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['ab'][pv,pA,ha,hC] += 1.0 * np.einsum('VW,XY,aYuV,UWIX->aUuI', eta1['b'], gamma1['b'], h['ab'][v,A,a,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['ab'][pv,pA,ha,hC] += -1.0 * np.einsum('VW,XY,UWIX,aYuV->aUuI', eta1['b'], gamma1['b'], h['bb'][A,A,C,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,ha,hC] += 1.0 * np.einsum('VW,XY,UYIV,aWuX->aUuI', eta1['b'], gamma1['b'], h['bb'][A,A,C,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,ha,hC] += -1.0 * np.einsum('VW,iUuV,aWiI->aUuI', eta1['b'], h['ab'][c,A,a,A], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,ha,hC] += 1.0 * np.einsum('VW,aJuV,UWIJ->aUuI', eta1['b'], h['ab'][v,C,a,A], t['bb'][pA,pA,hC,hC], optimize=True)
	X['ab'][pv,pA,ha,hC] += 1.0 * np.einsum('VW,aUbV,bWuI->aUuI', eta1['b'], h['ab'][v,A,v,A], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,ha,hC] += -1.0 * np.einsum('VW,JUIV,aWuJ->aUuI', eta1['b'], h['bb'][C,A,C,A], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,ha,hC] += 1.0 * np.einsum('VW,UV,aWuI->aUuI', eta1['b'], h['b'][A,A], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,ha,hC] += -1.0 * np.einsum('VW,WI,aUuV->aUuI', eta1['b'], h['b'][A,C], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,ha,hC] += -1.0 * np.einsum('vw,wu,aUvI->aUuI', gamma1['a'], h['a'][a,a], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,ha,hC] += -1.0 * np.einsum('vw,waub,bUvI->aUuI', gamma1['a'], h['aa'][a,v,a,v], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,ha,hC] += 1.0 * np.einsum('vw,wJuI,aUvJ->aUuI', gamma1['a'], h['ab'][a,C,a,C], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,ha,hC] += -1.0 * np.einsum('vw,wUuA,aAvI->aUuI', gamma1['a'], h['ab'][a,A,a,V], t['ab'][pv,pV,ha,hC], optimize=True)
	X['ab'][pv,pA,ha,hC] += 1.0 * np.einsum('vw,wUbI,abuv->aUuI', gamma1['a'], h['ab'][a,A,v,C], t['aa'][pv,pv,ha,ha], optimize=True)
	X['ab'][pv,pA,ha,hC] += 1.0 * np.einsum('vw,av,wUuI->aUuI', gamma1['a'], h['a'][v,a], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,ha,hC] += 1.0 * np.einsum('VW,vw,wWuI,aUvV->aUuI', gamma1['b'], gamma1['a'], h['ab'][a,A,a,C], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,ha,hC] += -1.0 * np.einsum('VW,vw,aUvV,wWuI->aUuI', gamma1['b'], gamma1['a'], h['ab'][v,A,a,A], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,ha,hC] += 1.0 * np.einsum('VW,iWuI,aUiV->aUuI', gamma1['b'], h['ab'][c,A,a,C], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,ha,hC] += 1.0 * np.einsum('VW,aWuA,UAIV->aUuI', gamma1['b'], h['ab'][v,A,a,V], t['bb'][pA,pV,hC,hA], optimize=True)
	X['ab'][pv,pA,ha,hC] += -1.0 * np.einsum('VW,aWbI,bUuV->aUuI', gamma1['b'], h['ab'][v,A,v,C], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,ha,hC] += 1.0 * np.einsum('VW,UV,aWuI->aUuI', gamma1['b'], h['b'][A,A], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,ha,hC] += 1.0 * np.einsum('VW,UWIA,aAuV->aUuI', gamma1['b'], h['bb'][A,A,C,V], t['ab'][pv,pV,ha,hA], optimize=True)
	X['ab'][pv,pA,ha,hC] += -1.0 * np.einsum('VW,WI,aUuV->aUuI', gamma1['b'], h['b'][A,C], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,ha,hC] += -1.0 * np.einsum('iu,aUiI->aUuI', h['a'][c,a], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,ha,hC] += -1.0 * np.einsum('iaub,bUiI->aUuI', h['aa'][c,v,a,v], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,ha,hC] += 1.0 * np.einsum('iJuI,aUiJ->aUuI', h['ab'][c,C,a,C], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,ha,hC] += -1.0 * np.einsum('iUuA,aAiI->aUuI', h['ab'][c,A,a,V], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pA,ha,hC] += -1.0 * np.einsum('iUbI,abiu->aUuI', h['ab'][c,A,v,C], t['aa'][pv,pv,hc,ha], optimize=True)
	X['ab'][pv,pA,ha,hC] += 1.0 * np.einsum('ab,bUuI->aUuI', h['a'][v,v], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,ha,hC] += 1.0 * np.einsum('aJuA,UAIJ->aUuI', h['ab'][v,C,a,V], t['bb'][pA,pV,hC,hC], optimize=True)
	X['ab'][pv,pA,ha,hC] += -1.0 * np.einsum('aJbI,bUuJ->aUuI', h['ab'][v,C,v,C], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,ha,hC] += 1.0 * np.einsum('aUbA,bAuI->aUuI', h['ab'][v,A,v,V], t['ab'][pv,pV,ha,hC], optimize=True)
	X['ab'][pv,pA,ha,hC] += -1.0 * np.einsum('JI,aUuJ->aUuI', h['b'][C,C], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,ha,hC] += -1.0 * np.einsum('JUIA,aAuJ->aUuI', h['bb'][C,A,C,V], t['ab'][pv,pV,ha,hC], optimize=True)
	X['ab'][pv,pA,ha,hC] += 1.0 * np.einsum('UA,aAuI->aUuI', h['b'][A,V], t['ab'][pv,pV,ha,hC], optimize=True)
	# aC|Va
	X['ab'][pa,pV,ha,hC] += -1.0 * np.einsum('wx,yz,uxvy,zAwI->uAvI', eta1['a'], gamma1['a'], h['aa'][a,a,a,a], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += 1.0 * np.einsum('wx,yz,uzvw,xAyI->uAvI', eta1['a'], gamma1['a'], h['aa'][a,a,a,a], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += -1.0 * np.einsum('wx,UV,uVwI,xAvU->uAvI', eta1['a'], gamma1['b'], h['ab'][a,A,a,C], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,ha,hC] += 1.0 * np.einsum('wx,UV,xAuU,vVwI->vAuI', eta1['a'], gamma1['b'], h['ab'][a,V,a,A], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += -1.0 * np.einsum('wx,iuvw,xAiI->uAvI', eta1['a'], h['aa'][c,a,a,a], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += -1.0 * np.einsum('wx,iAwI,uxiv->uAvI', eta1['a'], h['ab'][c,V,a,C], t['aa'][pa,pa,hc,ha], optimize=True)
	X['ab'][pa,pV,ha,hC] += 1.0 * np.einsum('wx,uw,xAvI->uAvI', eta1['a'], h['a'][a,a], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += -1.0 * np.einsum('wx,uJwI,xAvJ->uAvI', eta1['a'], h['ab'][a,C,a,C], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += 1.0 * np.einsum('wx,uAwB,xBvI->uAvI', eta1['a'], h['ab'][a,V,a,V], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += -1.0 * np.einsum('wx,xu,vAwI->vAuI', eta1['a'], h['a'][a,a], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += 1.0 * np.einsum('UV,wx,uAwU,xVvI->uAvI', eta1['b'], eta1['a'], h['ab'][a,V,a,A], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += -1.0 * np.einsum('UV,wx,xVuI,vAwU->vAuI', eta1['b'], eta1['a'], h['ab'][a,A,a,C], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,ha,hC] += 1.0 * np.einsum('UV,wx,uVwI,xAvU->uAvI', eta1['b'], gamma1['a'], h['ab'][a,A,a,C], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,ha,hC] += -1.0 * np.einsum('UV,wx,xAuU,vVwI->vAuI', eta1['b'], gamma1['a'], h['ab'][a,V,a,A], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += 1.0 * np.einsum('UV,WX,uVvW,XAIU->uAvI', eta1['b'], gamma1['b'], h['ab'][a,A,a,A], t['bb'][pA,pV,hC,hA], optimize=True)
	X['ab'][pa,pV,ha,hC] += -1.0 * np.einsum('UV,WX,uXvU,VAIW->uAvI', eta1['b'], gamma1['b'], h['ab'][a,A,a,A], t['bb'][pA,pV,hC,hA], optimize=True)
	X['ab'][pa,pV,ha,hC] += -1.0 * np.einsum('UV,iAuU,vViI->vAuI', eta1['b'], h['ab'][c,V,a,A], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += -1.0 * np.einsum('UV,uJvU,VAIJ->uAvI', eta1['b'], h['ab'][a,C,a,A], t['bb'][pA,pV,hC,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += 1.0 * np.einsum('UV,uAaU,aVvI->uAvI', eta1['b'], h['ab'][a,V,v,A], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += -1.0 * np.einsum('UV,JAIU,uVvJ->uAvI', eta1['b'], h['bb'][C,V,C,A], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += -1.0 * np.einsum('UV,VI,uAvU->uAvI', eta1['b'], h['b'][A,C], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,ha,hC] += 1.0 * np.einsum('UV,AU,uVvI->uAvI', eta1['b'], h['b'][V,A], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += 1.0 * np.einsum('wx,uw,xAvI->uAvI', gamma1['a'], h['a'][a,a], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += 1.0 * np.einsum('wx,uxva,aAwI->uAvI', gamma1['a'], h['aa'][a,a,a,v], t['ab'][pv,pV,ha,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += -1.0 * np.einsum('wx,xu,vAwI->vAuI', gamma1['a'], h['a'][a,a], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += 1.0 * np.einsum('wx,xJuI,vAwJ->vAuI', gamma1['a'], h['ab'][a,C,a,C], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += -1.0 * np.einsum('wx,xAuB,vBwI->vAuI', gamma1['a'], h['ab'][a,V,a,V], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += 1.0 * np.einsum('wx,xAaI,uavw->uAvI', gamma1['a'], h['ab'][a,V,v,C], t['aa'][pa,pv,ha,ha], optimize=True)
	X['ab'][pa,pV,ha,hC] += -1.0 * np.einsum('UV,wx,uAwU,xVvI->uAvI', gamma1['b'], gamma1['a'], h['ab'][a,V,a,A], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += 1.0 * np.einsum('UV,wx,xVuI,vAwU->vAuI', gamma1['b'], gamma1['a'], h['ab'][a,A,a,C], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,ha,hC] += 1.0 * np.einsum('UV,iVuI,vAiU->vAuI', gamma1['b'], h['ab'][c,A,a,C], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pa,pV,ha,hC] += 1.0 * np.einsum('UV,uVvB,ABIU->uAvI', gamma1['b'], h['ab'][a,A,a,V], t['bb'][pV,pV,hC,hA], optimize=True)
	X['ab'][pa,pV,ha,hC] += -1.0 * np.einsum('UV,uVaI,aAvU->uAvI', gamma1['b'], h['ab'][a,A,v,C], t['ab'][pv,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,ha,hC] += -1.0 * np.einsum('UV,VI,uAvU->uAvI', gamma1['b'], h['b'][A,C], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,ha,hC] += -1.0 * np.einsum('UV,VAIB,uBvU->uAvI', gamma1['b'], h['bb'][A,V,C,V], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,ha,hC] += 1.0 * np.einsum('UV,AU,uVvI->uAvI', gamma1['b'], h['b'][V,A], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += -1.0 * np.einsum('iu,vAiI->vAuI', h['a'][c,a], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += -1.0 * np.einsum('iuva,aAiI->uAvI', h['aa'][c,a,a,v], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += 1.0 * np.einsum('iJuI,vAiJ->vAuI', h['ab'][c,C,a,C], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += -1.0 * np.einsum('iAuB,vBiI->vAuI', h['ab'][c,V,a,V], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += -1.0 * np.einsum('iAaI,uaiv->uAvI', h['ab'][c,V,v,C], t['aa'][pa,pv,hc,ha], optimize=True)
	X['ab'][pa,pV,ha,hC] += 1.0 * np.einsum('ua,aAvI->uAvI', h['a'][a,v], t['ab'][pv,pV,ha,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += 1.0 * np.einsum('uJvB,ABIJ->uAvI', h['ab'][a,C,a,V], t['bb'][pV,pV,hC,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += -1.0 * np.einsum('uJaI,aAvJ->uAvI', h['ab'][a,C,v,C], t['ab'][pv,pV,ha,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += 1.0 * np.einsum('uAaB,aBvI->uAvI', h['ab'][a,V,v,V], t['ab'][pv,pV,ha,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += -1.0 * np.einsum('JI,uAvJ->uAvI', h['b'][C,C], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += -1.0 * np.einsum('JAIB,uBvJ->uAvI', h['bb'][C,V,C,V], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += 1.0 * np.einsum('AB,uBvI->uAvI', h['b'][V,V], t['ab'][pa,pV,ha,hC], optimize=True)
	# aC|Vv
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('vw,xy,waux,yAvI->aAuI', eta1['a'], gamma1['a'], h['aa'][a,v,a,a], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('vw,xy,wAxI,yauv->aAuI', eta1['a'], gamma1['a'], h['ab'][a,V,a,C], t['aa'][pa,pv,ha,ha], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('vw,xy,yauv,wAxI->aAuI', eta1['a'], gamma1['a'], h['aa'][a,v,a,a], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('vw,xy,yAvI,waux->aAuI', eta1['a'], gamma1['a'], h['ab'][a,V,a,C], t['aa'][pa,pv,ha,ha], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('vw,UV,wAuU,aVvI->aAuI', eta1['a'], gamma1['b'], h['ab'][a,V,a,A], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('vw,UV,aVvI,wAuU->aAuI', eta1['a'], gamma1['b'], h['ab'][v,A,a,C], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('vw,iauv,wAiI->aAuI', eta1['a'], h['aa'][c,v,a,a], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('vw,iAvI,waiu->aAuI', eta1['a'], h['ab'][c,V,a,C], t['aa'][pa,pv,hc,ha], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('vw,wu,aAvI->aAuI', eta1['a'], h['a'][a,a], t['ab'][pv,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('vw,av,wAuI->aAuI', eta1['a'], h['a'][v,a], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('vw,aJvI,wAuJ->aAuI', eta1['a'], h['ab'][v,C,a,C], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('vw,aAvB,wBuI->aAuI', eta1['a'], h['ab'][v,V,a,V], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('UV,vw,wVuI,aAvU->aAuI', eta1['b'], eta1['a'], h['ab'][a,A,a,C], t['ab'][pv,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('UV,vw,aAvU,wVuI->aAuI', eta1['b'], eta1['a'], h['ab'][v,V,a,A], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('UV,vw,wAuU,aVvI->aAuI', eta1['b'], gamma1['a'], h['ab'][a,V,a,A], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('UV,vw,aVvI,wAuU->aAuI', eta1['b'], gamma1['a'], h['ab'][v,A,a,C], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('UV,WX,aVuW,XAIU->aAuI', eta1['b'], gamma1['b'], h['ab'][v,A,a,A], t['bb'][pA,pV,hC,hA], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('UV,WX,aXuU,VAIW->aAuI', eta1['b'], gamma1['b'], h['ab'][v,A,a,A], t['bb'][pA,pV,hC,hA], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('UV,WX,VAIW,aXuU->aAuI', eta1['b'], gamma1['b'], h['bb'][A,V,C,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('UV,WX,XAIU,aVuW->aAuI', eta1['b'], gamma1['b'], h['bb'][A,V,C,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('UV,iAuU,aViI->aAuI', eta1['b'], h['ab'][c,V,a,A], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('UV,aJuU,VAIJ->aAuI', eta1['b'], h['ab'][v,C,a,A], t['bb'][pA,pV,hC,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('UV,aAbU,bVuI->aAuI', eta1['b'], h['ab'][v,V,v,A], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('UV,JAIU,aVuJ->aAuI', eta1['b'], h['bb'][C,V,C,A], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('UV,VI,aAuU->aAuI', eta1['b'], h['b'][A,C], t['ab'][pv,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('UV,AU,aVuI->aAuI', eta1['b'], h['b'][V,A], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('vw,wu,aAvI->aAuI', gamma1['a'], h['a'][a,a], t['ab'][pv,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('vw,waub,bAvI->aAuI', gamma1['a'], h['aa'][a,v,a,v], t['ab'][pv,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('vw,wJuI,aAvJ->aAuI', gamma1['a'], h['ab'][a,C,a,C], t['ab'][pv,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('vw,wAuB,aBvI->aAuI', gamma1['a'], h['ab'][a,V,a,V], t['ab'][pv,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('vw,wAbI,abuv->aAuI', gamma1['a'], h['ab'][a,V,v,C], t['aa'][pv,pv,ha,ha], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('vw,av,wAuI->aAuI', gamma1['a'], h['a'][v,a], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('UV,vw,wVuI,aAvU->aAuI', gamma1['b'], gamma1['a'], h['ab'][a,A,a,C], t['ab'][pv,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('UV,vw,aAvU,wVuI->aAuI', gamma1['b'], gamma1['a'], h['ab'][v,V,a,A], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('UV,iVuI,aAiU->aAuI', gamma1['b'], h['ab'][c,A,a,C], t['ab'][pv,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('UV,aVuB,ABIU->aAuI', gamma1['b'], h['ab'][v,A,a,V], t['bb'][pV,pV,hC,hA], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('UV,aVbI,bAuU->aAuI', gamma1['b'], h['ab'][v,A,v,C], t['ab'][pv,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('UV,VI,aAuU->aAuI', gamma1['b'], h['b'][A,C], t['ab'][pv,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('UV,VAIB,aBuU->aAuI', gamma1['b'], h['bb'][A,V,C,V], t['ab'][pv,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('UV,AU,aVuI->aAuI', gamma1['b'], h['b'][V,A], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('iu,aAiI->aAuI', h['a'][c,a], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('iaub,bAiI->aAuI', h['aa'][c,v,a,v], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('iJuI,aAiJ->aAuI', h['ab'][c,C,a,C], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('iAuB,aBiI->aAuI', h['ab'][c,V,a,V], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('iAbI,abiu->aAuI', h['ab'][c,V,v,C], t['aa'][pv,pv,hc,ha], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('ab,bAuI->aAuI', h['a'][v,v], t['ab'][pv,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('aJuB,ABIJ->aAuI', h['ab'][v,C,a,V], t['bb'][pV,pV,hC,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('aJbI,bAuJ->aAuI', h['ab'][v,C,v,C], t['ab'][pv,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('aAbB,bBuI->aAuI', h['ab'][v,V,v,V], t['ab'][pv,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('JI,aAuJ->aAuI', h['b'][C,C], t['ab'][pv,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('JAIB,aBuJ->aAuI', h['bb'][C,V,C,V], t['ab'][pv,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('AB,aBuI->aAuI', h['b'][V,V], t['ab'][pv,pV,ha,hC], optimize=True)
	# aa|va
	X['aa'][pa,pv,ha,ha] += -0.25 * np.einsum('xy,zp,ypuv,waxz->wauv', eta1['a'], eta1['a'], h['aa'][a,a,a,a], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pa,pv,ha,ha] += 1.0 * np.einsum('xy,zp,uyvz,pawx->uavw', eta1['a'], gamma1['a'], h['aa'][a,a,a,a], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pa,pv,ha,ha] += -1.0 * np.einsum('xy,zp,upvx,yawz->uavw', eta1['a'], gamma1['a'], h['aa'][a,a,a,a], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pa,pv,ha,ha] += -1.0 * np.einsum('xy,iuvx,yaiw->uavw', eta1['a'], h['aa'][c,a,a,a], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,ha,ha] += -1.0 * np.einsum('xy,iaux,vyiw->vauw', eta1['a'], h['aa'][c,v,a,a], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pv,ha,ha] += 0.5 * np.einsum('xy,ux,yavw->uavw', eta1['a'], h['a'][a,a], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pa,pv,ha,ha] += 0.5 * np.einsum('xy,uaxb,ybvw->uavw', eta1['a'], h['aa'][a,v,a,v], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pa,pv,ha,ha] += 1.0 * np.einsum('xy,yu,vawx->vauw', eta1['a'], h['a'][a,a], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pa,pv,ha,ha] += -1.0 * np.einsum('UV,WX,uVvW,aXwU->uavw', eta1['b'], gamma1['b'], h['ab'][a,A,a,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['aa'][pa,pv,ha,ha] += 1.0 * np.einsum('UV,WX,uXvU,aVwW->uavw', eta1['b'], gamma1['b'], h['ab'][a,A,a,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['aa'][pa,pv,ha,ha] += 1.0 * np.einsum('UV,uIvU,aVwI->uavw', eta1['b'], h['ab'][a,C,a,A], t['ab'][pv,pA,ha,hC], optimize=True)
	X['aa'][pa,pv,ha,ha] += -1.0 * np.einsum('UV,aIuU,vVwI->vauw', eta1['b'], h['ab'][v,C,a,A], t['ab'][pa,pA,ha,hC], optimize=True)
	X['aa'][pa,pv,ha,ha] += 0.25 * np.einsum('xy,zp,ypuv,waxz->wauv', gamma1['a'], gamma1['a'], h['aa'][a,a,a,a], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pa,pv,ha,ha] += 0.5 * np.einsum('xy,iyuv,waix->wauv', gamma1['a'], h['aa'][c,a,a,a], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,ha,ha] += 0.5 * np.einsum('xy,ux,yavw->uavw', gamma1['a'], h['a'][a,a], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pa,pv,ha,ha] += 1.0 * np.einsum('xy,uyvb,abwx->uavw', gamma1['a'], h['aa'][a,a,a,v], t['aa'][pv,pv,ha,ha], optimize=True)
	X['aa'][pa,pv,ha,ha] += 1.0 * np.einsum('xy,yu,vawx->vauw', gamma1['a'], h['a'][a,a], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pa,pv,ha,ha] += 1.0 * np.einsum('xy,yaub,vbwx->vauw', gamma1['a'], h['aa'][a,v,a,v], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pa,pv,ha,ha] += 1.0 * np.einsum('UV,uVvA,aAwU->uavw', gamma1['b'], h['ab'][a,A,a,V], t['ab'][pv,pV,ha,hA], optimize=True)
	X['aa'][pa,pv,ha,ha] += -1.0 * np.einsum('UV,aVuA,vAwU->vauw', gamma1['b'], h['ab'][v,A,a,V], t['ab'][pa,pV,ha,hA], optimize=True)
	X['aa'][pa,pv,ha,ha] += -1.0 * np.einsum('iu,vaiw->vauw', h['a'][c,a], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,ha,ha] += 0.25 * np.einsum('ijuv,waij->wauv', h['aa'][c,c,a,a], t['aa'][pa,pv,hc,hc], optimize=True)
	X['aa'][pa,pv,ha,ha] += 1.0 * np.einsum('iuvb,abiw->uavw', h['aa'][c,a,a,v], t['aa'][pv,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,ha,ha] += -1.0 * np.einsum('iaub,vbiw->vauw', h['aa'][c,v,a,v], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,ha,ha] += -0.5 * np.einsum('ub,abvw->uavw', h['a'][a,v], t['aa'][pv,pv,ha,ha], optimize=True)
	X['aa'][pa,pv,ha,ha] += 0.25 * np.einsum('uabc,bcvw->uavw', h['aa'][a,v,v,v], t['aa'][pv,pv,ha,ha], optimize=True)
	X['aa'][pa,pv,ha,ha] += 1.0 * np.einsum('uIvA,aAwI->uavw', h['ab'][a,C,a,V], t['ab'][pv,pV,ha,hC], optimize=True)
	X['aa'][pa,pv,ha,ha] += 0.5 * np.einsum('ab,ubvw->uavw', h['a'][v,v], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pa,pv,ha,ha] += -1.0 * np.einsum('aIuA,vAwI->vauw', h['ab'][v,C,a,V], t['ab'][pa,pV,ha,hC], optimize=True)
	# aa|vv
	X['aa'][pv,pv,ha,ha] += -0.125 * np.einsum('wx,yz,xzuv,abwy->abuv', eta1['a'], eta1['a'], h['aa'][a,a,a,a], t['aa'][pv,pv,ha,ha], optimize=True)
	X['aa'][pv,pv,ha,ha] += -1.0 * np.einsum('wx,yz,xauy,zbvw->abuv', eta1['a'], gamma1['a'], h['aa'][a,v,a,a], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pv,pv,ha,ha] += 1.0 * np.einsum('wx,yz,zauw,xbvy->abuv', eta1['a'], gamma1['a'], h['aa'][a,v,a,a], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pv,pv,ha,ha] += -1.0 * np.einsum('wx,iauw,xbiv->abuv', eta1['a'], h['aa'][c,v,a,a], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,ha,ha] += 0.5 * np.einsum('wx,xu,abvw->abuv', eta1['a'], h['a'][a,a], t['aa'][pv,pv,ha,ha], optimize=True)
	X['aa'][pv,pv,ha,ha] += 0.5 * np.einsum('wx,aw,xbuv->abuv', eta1['a'], h['a'][v,a], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pv,pv,ha,ha] += 0.25 * np.einsum('wx,abwc,xcuv->abuv', eta1['a'], h['aa'][v,v,a,v], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pv,pv,ha,ha] += -1.0 * np.einsum('UV,WX,aVuW,bXvU->abuv', eta1['b'], gamma1['b'], h['ab'][v,A,a,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['aa'][pv,pv,ha,ha] += 1.0 * np.einsum('UV,WX,aXuU,bVvW->abuv', eta1['b'], gamma1['b'], h['ab'][v,A,a,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['aa'][pv,pv,ha,ha] += 1.0 * np.einsum('UV,aIuU,bVvI->abuv', eta1['b'], h['ab'][v,C,a,A], t['ab'][pv,pA,ha,hC], optimize=True)
	X['aa'][pv,pv,ha,ha] += 0.125 * np.einsum('wx,yz,xzuv,abwy->abuv', gamma1['a'], gamma1['a'], h['aa'][a,a,a,a], t['aa'][pv,pv,ha,ha], optimize=True)
	X['aa'][pv,pv,ha,ha] += 0.25 * np.einsum('wx,ixuv,abiw->abuv', gamma1['a'], h['aa'][c,a,a,a], t['aa'][pv,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,ha,ha] += 0.5 * np.einsum('wx,xu,abvw->abuv', gamma1['a'], h['a'][a,a], t['aa'][pv,pv,ha,ha], optimize=True)
	X['aa'][pv,pv,ha,ha] += -1.0 * np.einsum('wx,xauc,bcvw->abuv', gamma1['a'], h['aa'][a,v,a,v], t['aa'][pv,pv,ha,ha], optimize=True)
	X['aa'][pv,pv,ha,ha] += 0.5 * np.einsum('wx,aw,xbuv->abuv', gamma1['a'], h['a'][v,a], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pv,pv,ha,ha] += 1.0 * np.einsum('UV,aVuA,bAvU->abuv', gamma1['b'], h['ab'][v,A,a,V], t['ab'][pv,pV,ha,hA], optimize=True)
	X['aa'][pv,pv,ha,ha] += -0.5 * np.einsum('iu,abiv->abuv', h['a'][c,a], t['aa'][pv,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,ha,ha] += 0.125 * np.einsum('ijuv,abij->abuv', h['aa'][c,c,a,a], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,ha,ha] += 1.0 * np.einsum('iauc,bciv->abuv', h['aa'][c,v,a,v], t['aa'][pv,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,ha,ha] += -0.5 * np.einsum('ac,bcuv->abuv', h['a'][v,v], t['aa'][pv,pv,ha,ha], optimize=True)
	X['aa'][pv,pv,ha,ha] += 0.125 * np.einsum('abcd,cduv->abuv', h['aa'][v,v,v,v], t['aa'][pv,pv,ha,ha], optimize=True)
	X['aa'][pv,pv,ha,ha] += 1.0 * np.einsum('aIuA,bAvI->abuv', h['ab'][v,C,a,V], t['ab'][pv,pV,ha,hC], optimize=True)
	# cA|Aa
	X['ab'][pa,pA,hc,hA] += -1.0 * np.einsum('vw,xy,wUxV,uyiv->uUiV', eta1['a'], gamma1['a'], h['ab'][a,A,a,A], t['aa'][pa,pa,hc,ha], optimize=True)
	X['ab'][pa,pA,hc,hA] += 1.0 * np.einsum('vw,xy,yUvV,uwix->uUiV', eta1['a'], gamma1['a'], h['ab'][a,A,a,A], t['aa'][pa,pa,hc,ha], optimize=True)
	X['ab'][pa,pA,hc,hA] += -1.0 * np.einsum('vw,WX,uXvU,wViW->uViU', eta1['a'], gamma1['b'], h['ab'][a,A,a,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pA,hc,hA] += -1.0 * np.einsum('vw,juiv,wUjV->uUiV', eta1['a'], h['aa'][c,a,c,a], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pA,hc,hA] += 1.0 * np.einsum('vw,jUvV,uwij->uUiV', eta1['a'], h['ab'][c,A,a,A], t['aa'][pa,pa,hc,hc], optimize=True)
	X['ab'][pa,pA,hc,hA] += 1.0 * np.einsum('vw,uv,wUiV->uUiV', eta1['a'], h['a'][a,a], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pA,hc,hA] += -1.0 * np.einsum('vw,uIvU,wViI->uViU', eta1['a'], h['ab'][a,C,a,A], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pa,pA,hc,hA] += 1.0 * np.einsum('vw,uUvA,wAiV->uUiV', eta1['a'], h['ab'][a,A,a,V], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pa,pA,hc,hA] += 1.0 * np.einsum('WX,vw,uUvW,wXiV->uUiV', eta1['b'], eta1['a'], h['ab'][a,A,a,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pA,hc,hA] += 1.0 * np.einsum('WX,vw,uXvU,wViW->uViU', eta1['b'], gamma1['a'], h['ab'][a,A,a,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pA,hc,hA] += -1.0 * np.einsum('WX,YZ,UXVY,uZiW->uUiV', eta1['b'], gamma1['b'], h['bb'][A,A,A,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pA,hc,hA] += 1.0 * np.einsum('WX,YZ,UZVW,uXiY->uUiV', eta1['b'], gamma1['b'], h['bb'][A,A,A,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pA,hc,hA] += -1.0 * np.einsum('WX,jUiW,uXjV->uUiV', eta1['b'], h['ab'][c,A,c,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pA,hc,hA] += -1.0 * np.einsum('WX,uIiW,UXIV->uUiV', eta1['b'], h['ab'][a,C,c,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['ab'][pa,pA,hc,hA] += 1.0 * np.einsum('WX,uUaW,aXiV->uUiV', eta1['b'], h['ab'][a,A,v,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pa,pA,hc,hA] += -1.0 * np.einsum('WX,IUVW,uXiI->uUiV', eta1['b'], h['bb'][C,A,A,A], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pa,pA,hc,hA] += 1.0 * np.einsum('WX,UW,uXiV->uUiV', eta1['b'], h['b'][A,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pA,hc,hA] += -1.0 * np.einsum('WX,XU,uViW->uViU', eta1['b'], h['b'][A,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pA,hc,hA] += 1.0 * np.einsum('vw,uv,wUiV->uUiV', gamma1['a'], h['a'][a,a], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pA,hc,hA] += 1.0 * np.einsum('vw,uwia,aUvV->uUiV', gamma1['a'], h['aa'][a,a,c,v], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pa,pA,hc,hA] += 1.0 * np.einsum('vw,wIiU,uVvI->uViU', gamma1['a'], h['ab'][a,C,c,A], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pA,hc,hA] += -1.0 * np.einsum('vw,wUiA,uAvV->uUiV', gamma1['a'], h['ab'][a,A,c,V], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pA,hc,hA] += 1.0 * np.einsum('vw,wUaV,uaiv->uUiV', gamma1['a'], h['ab'][a,A,v,A], t['aa'][pa,pv,hc,ha], optimize=True)
	X['ab'][pa,pA,hc,hA] += -1.0 * np.einsum('WX,vw,uUvW,wXiV->uUiV', gamma1['b'], gamma1['a'], h['ab'][a,A,a,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pA,hc,hA] += 1.0 * np.einsum('WX,jXiU,uVjW->uViU', gamma1['b'], h['ab'][c,A,c,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pA,hc,hA] += 1.0 * np.einsum('WX,uXiA,UAVW->uUiV', gamma1['b'], h['ab'][a,A,c,V], t['bb'][pA,pV,hA,hA], optimize=True)
	X['ab'][pa,pA,hc,hA] += -1.0 * np.einsum('WX,uXaU,aViW->uViU', gamma1['b'], h['ab'][a,A,v,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pa,pA,hc,hA] += 1.0 * np.einsum('WX,UW,uXiV->uUiV', gamma1['b'], h['b'][A,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pA,hc,hA] += 1.0 * np.einsum('WX,UXVA,uAiW->uUiV', gamma1['b'], h['bb'][A,A,A,V], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pa,pA,hc,hA] += -1.0 * np.einsum('WX,XU,uViW->uViU', gamma1['b'], h['b'][A,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pA,hc,hA] += -1.0 * np.einsum('ji,uUjV->uUiV', h['a'][c,c], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pA,hc,hA] += -1.0 * np.einsum('juia,aUjV->uUiV', h['aa'][c,a,c,v], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pa,pA,hc,hA] += 1.0 * np.einsum('jIiU,uVjI->uViU', h['ab'][c,C,c,A], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pa,pA,hc,hA] += -1.0 * np.einsum('jUiA,uAjV->uUiV', h['ab'][c,A,c,V], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pa,pA,hc,hA] += 1.0 * np.einsum('jUaV,uaij->uUiV', h['ab'][c,A,v,A], t['aa'][pa,pv,hc,hc], optimize=True)
	X['ab'][pa,pA,hc,hA] += 1.0 * np.einsum('ua,aUiV->uUiV', h['a'][a,v], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pa,pA,hc,hA] += -1.0 * np.einsum('uIiA,UAIV->uUiV', h['ab'][a,C,c,V], t['bb'][pA,pV,hC,hA], optimize=True)
	X['ab'][pa,pA,hc,hA] += -1.0 * np.einsum('uIaU,aViI->uViU', h['ab'][a,C,v,A], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pa,pA,hc,hA] += 1.0 * np.einsum('uUaA,aAiV->uUiV', h['ab'][a,A,v,V], t['ab'][pv,pV,hc,hA], optimize=True)
	X['ab'][pa,pA,hc,hA] += -1.0 * np.einsum('IU,uViI->uViU', h['b'][C,A], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pa,pA,hc,hA] += -1.0 * np.einsum('IUVA,uAiI->uUiV', h['bb'][C,A,A,V], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pa,pA,hc,hA] += 1.0 * np.einsum('UA,uAiV->uUiV', h['b'][A,V], t['ab'][pa,pV,hc,hA], optimize=True)
	# cA|Av
	X['ab'][pv,pA,hc,hA] += 1.0 * np.einsum('uv,wx,vUwV,xaiu->aUiV', eta1['a'], gamma1['a'], h['ab'][a,A,a,A], t['aa'][pa,pv,hc,ha], optimize=True)
	X['ab'][pv,pA,hc,hA] += -1.0 * np.einsum('uv,wx,xUuV,vaiw->aUiV', eta1['a'], gamma1['a'], h['ab'][a,A,a,A], t['aa'][pa,pv,hc,ha], optimize=True)
	X['ab'][pv,pA,hc,hA] += 1.0 * np.einsum('uv,WX,vUiW,aXuV->aUiV', eta1['a'], gamma1['b'], h['ab'][a,A,c,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += -1.0 * np.einsum('uv,WX,aXuU,vViW->aViU', eta1['a'], gamma1['b'], h['ab'][v,A,a,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += -1.0 * np.einsum('uv,jaiu,vUjV->aUiV', eta1['a'], h['aa'][c,v,c,a], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += -1.0 * np.einsum('uv,jUuV,vaij->aUiV', eta1['a'], h['ab'][c,A,a,A], t['aa'][pa,pv,hc,hc], optimize=True)
	X['ab'][pv,pA,hc,hA] += -1.0 * np.einsum('uv,vi,aUuV->aUiV', eta1['a'], h['a'][a,c], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += 1.0 * np.einsum('uv,au,vUiV->aUiV', eta1['a'], h['a'][v,a], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += -1.0 * np.einsum('uv,aIuU,vViI->aViU', eta1['a'], h['ab'][v,C,a,A], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hA] += 1.0 * np.einsum('uv,aUuA,vAiV->aUiV', eta1['a'], h['ab'][v,A,a,V], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += -1.0 * np.einsum('WX,uv,vXiU,aVuW->aViU', eta1['b'], eta1['a'], h['ab'][a,A,c,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += 1.0 * np.einsum('WX,uv,aUuW,vXiV->aUiV', eta1['b'], eta1['a'], h['ab'][v,A,a,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += -1.0 * np.einsum('WX,uv,vUiW,aXuV->aUiV', eta1['b'], gamma1['a'], h['ab'][a,A,c,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += 1.0 * np.einsum('WX,uv,aXuU,vViW->aViU', eta1['b'], gamma1['a'], h['ab'][v,A,a,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += -1.0 * np.einsum('WX,YZ,UXVY,aZiW->aUiV', eta1['b'], gamma1['b'], h['bb'][A,A,A,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += 1.0 * np.einsum('WX,YZ,UZVW,aXiY->aUiV', eta1['b'], gamma1['b'], h['bb'][A,A,A,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += -1.0 * np.einsum('WX,jUiW,aXjV->aUiV', eta1['b'], h['ab'][c,A,c,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += -1.0 * np.einsum('WX,aIiW,UXIV->aUiV', eta1['b'], h['ab'][v,C,c,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += 1.0 * np.einsum('WX,aUbW,bXiV->aUiV', eta1['b'], h['ab'][v,A,v,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += -1.0 * np.einsum('WX,IUVW,aXiI->aUiV', eta1['b'], h['bb'][C,A,A,A], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hA] += 1.0 * np.einsum('WX,UW,aXiV->aUiV', eta1['b'], h['b'][A,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += -1.0 * np.einsum('WX,XU,aViW->aViU', eta1['b'], h['b'][A,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += -1.0 * np.einsum('uv,vi,aUuV->aUiV', gamma1['a'], h['a'][a,c], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += -1.0 * np.einsum('uv,vaib,bUuV->aUiV', gamma1['a'], h['aa'][a,v,c,v], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += 1.0 * np.einsum('uv,vIiU,aVuI->aViU', gamma1['a'], h['ab'][a,C,c,A], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,hc,hA] += -1.0 * np.einsum('uv,vUiA,aAuV->aUiV', gamma1['a'], h['ab'][a,A,c,V], t['ab'][pv,pV,ha,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += 1.0 * np.einsum('uv,vUbV,abiu->aUiV', gamma1['a'], h['ab'][a,A,v,A], t['aa'][pv,pv,hc,ha], optimize=True)
	X['ab'][pv,pA,hc,hA] += 1.0 * np.einsum('uv,au,vUiV->aUiV', gamma1['a'], h['a'][v,a], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += 1.0 * np.einsum('WX,uv,vXiU,aVuW->aViU', gamma1['b'], gamma1['a'], h['ab'][a,A,c,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += -1.0 * np.einsum('WX,uv,aUuW,vXiV->aUiV', gamma1['b'], gamma1['a'], h['ab'][v,A,a,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += 1.0 * np.einsum('WX,jXiU,aVjW->aViU', gamma1['b'], h['ab'][c,A,c,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += 1.0 * np.einsum('WX,aXiA,UAVW->aUiV', gamma1['b'], h['ab'][v,A,c,V], t['bb'][pA,pV,hA,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += -1.0 * np.einsum('WX,aXbU,bViW->aViU', gamma1['b'], h['ab'][v,A,v,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += 1.0 * np.einsum('WX,UW,aXiV->aUiV', gamma1['b'], h['b'][A,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += 1.0 * np.einsum('WX,UXVA,aAiW->aUiV', gamma1['b'], h['bb'][A,A,A,V], t['ab'][pv,pV,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += -1.0 * np.einsum('WX,XU,aViW->aViU', gamma1['b'], h['b'][A,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += -1.0 * np.einsum('ji,aUjV->aUiV', h['a'][c,c], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += -1.0 * np.einsum('jaib,bUjV->aUiV', h['aa'][c,v,c,v], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += 1.0 * np.einsum('jIiU,aVjI->aViU', h['ab'][c,C,c,A], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hA] += -1.0 * np.einsum('jUiA,aAjV->aUiV', h['ab'][c,A,c,V], t['ab'][pv,pV,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += 1.0 * np.einsum('jUbV,abij->aUiV', h['ab'][c,A,v,A], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pA,hc,hA] += 1.0 * np.einsum('ab,bUiV->aUiV', h['a'][v,v], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += -1.0 * np.einsum('aIiA,UAIV->aUiV', h['ab'][v,C,c,V], t['bb'][pA,pV,hC,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += -1.0 * np.einsum('aIbU,bViI->aViU', h['ab'][v,C,v,A], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hA] += 1.0 * np.einsum('aUbA,bAiV->aUiV', h['ab'][v,A,v,V], t['ab'][pv,pV,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += -1.0 * np.einsum('IU,aViI->aViU', h['b'][C,A], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hA] += -1.0 * np.einsum('IUVA,aAiI->aUiV', h['bb'][C,A,A,V], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hA] += 1.0 * np.einsum('UA,aAiV->aUiV', h['b'][A,V], t['ab'][pv,pV,hc,hA], optimize=True)
	# cA|Va
	X['ab'][pa,pV,hc,hA] += -1.0 * np.einsum('vw,xy,uwix,yAvU->uAiU', eta1['a'], gamma1['a'], h['aa'][a,a,c,a], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += 1.0 * np.einsum('vw,xy,uyiv,wAxU->uAiU', eta1['a'], gamma1['a'], h['aa'][a,a,c,a], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += -1.0 * np.einsum('vw,xy,wAxU,uyiv->uAiU', eta1['a'], gamma1['a'], h['ab'][a,V,a,A], t['aa'][pa,pa,hc,ha], optimize=True)
	X['ab'][pa,pV,hc,hA] += 1.0 * np.einsum('vw,xy,yAvU,uwix->uAiU', eta1['a'], gamma1['a'], h['ab'][a,V,a,A], t['aa'][pa,pa,hc,ha], optimize=True)
	X['ab'][pa,pV,hc,hA] += -1.0 * np.einsum('vw,VW,uWvU,wAiV->uAiU', eta1['a'], gamma1['b'], h['ab'][a,A,a,A], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += -1.0 * np.einsum('vw,juiv,wAjU->uAiU', eta1['a'], h['aa'][c,a,c,a], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += 1.0 * np.einsum('vw,jAvU,uwij->uAiU', eta1['a'], h['ab'][c,V,a,A], t['aa'][pa,pa,hc,hc], optimize=True)
	X['ab'][pa,pV,hc,hA] += 1.0 * np.einsum('vw,uv,wAiU->uAiU', eta1['a'], h['a'][a,a], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += -1.0 * np.einsum('vw,uIvU,wAiI->uAiU', eta1['a'], h['ab'][a,C,a,A], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hA] += 1.0 * np.einsum('vw,uAvB,wBiU->uAiU', eta1['a'], h['ab'][a,V,a,V], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += -1.0 * np.einsum('vw,wi,uAvU->uAiU', eta1['a'], h['a'][a,c], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += 1.0 * np.einsum('VW,vw,uAvV,wWiU->uAiU', eta1['b'], eta1['a'], h['ab'][a,V,a,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += -1.0 * np.einsum('VW,vw,wWiU,uAvV->uAiU', eta1['b'], eta1['a'], h['ab'][a,A,c,A], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += 1.0 * np.einsum('VW,vw,uWvU,wAiV->uAiU', eta1['b'], gamma1['a'], h['ab'][a,A,a,A], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += 1.0 * np.einsum('VW,XY,uWiX,YAUV->uAiU', eta1['b'], gamma1['b'], h['ab'][a,A,c,A], t['bb'][pA,pV,hA,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += -1.0 * np.einsum('VW,XY,uYiV,WAUX->uAiU', eta1['b'], gamma1['b'], h['ab'][a,A,c,A], t['bb'][pA,pV,hA,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += 1.0 * np.einsum('VW,XY,WAUX,uYiV->uAiU', eta1['b'], gamma1['b'], h['bb'][A,V,A,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += -1.0 * np.einsum('VW,XY,YAUV,uWiX->uAiU', eta1['b'], gamma1['b'], h['bb'][A,V,A,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += -1.0 * np.einsum('VW,jAiV,uWjU->uAiU', eta1['b'], h['ab'][c,V,c,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += 1.0 * np.einsum('VW,uIiV,WAIU->uAiU', eta1['b'], h['ab'][a,C,c,A], t['bb'][pA,pV,hC,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += 1.0 * np.einsum('VW,uAaV,aWiU->uAiU', eta1['b'], h['ab'][a,V,v,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += -1.0 * np.einsum('VW,IAUV,uWiI->uAiU', eta1['b'], h['bb'][C,V,A,A], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hA] += -1.0 * np.einsum('VW,WU,uAiV->uAiU', eta1['b'], h['b'][A,A], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += 1.0 * np.einsum('VW,AV,uWiU->uAiU', eta1['b'], h['b'][V,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += 1.0 * np.einsum('vw,uv,wAiU->uAiU', gamma1['a'], h['a'][a,a], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += 1.0 * np.einsum('vw,uwia,aAvU->uAiU', gamma1['a'], h['aa'][a,a,c,v], t['ab'][pv,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += -1.0 * np.einsum('vw,wi,uAvU->uAiU', gamma1['a'], h['a'][a,c], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += 1.0 * np.einsum('vw,wIiU,uAvI->uAiU', gamma1['a'], h['ab'][a,C,c,A], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pa,pV,hc,hA] += -1.0 * np.einsum('vw,wAiB,uBvU->uAiU', gamma1['a'], h['ab'][a,V,c,V], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += 1.0 * np.einsum('vw,wAaU,uaiv->uAiU', gamma1['a'], h['ab'][a,V,v,A], t['aa'][pa,pv,hc,ha], optimize=True)
	X['ab'][pa,pV,hc,hA] += -1.0 * np.einsum('VW,vw,uAvV,wWiU->uAiU', gamma1['b'], gamma1['a'], h['ab'][a,V,a,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += 1.0 * np.einsum('VW,vw,wWiU,uAvV->uAiU', gamma1['b'], gamma1['a'], h['ab'][a,A,c,A], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += 1.0 * np.einsum('VW,jWiU,uAjV->uAiU', gamma1['b'], h['ab'][c,A,c,A], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += 1.0 * np.einsum('VW,uWiB,ABUV->uAiU', gamma1['b'], h['ab'][a,A,c,V], t['bb'][pV,pV,hA,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += -1.0 * np.einsum('VW,uWaU,aAiV->uAiU', gamma1['b'], h['ab'][a,A,v,A], t['ab'][pv,pV,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += -1.0 * np.einsum('VW,WU,uAiV->uAiU', gamma1['b'], h['b'][A,A], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += -1.0 * np.einsum('VW,WAUB,uBiV->uAiU', gamma1['b'], h['bb'][A,V,A,V], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += 1.0 * np.einsum('VW,AV,uWiU->uAiU', gamma1['b'], h['b'][V,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += -1.0 * np.einsum('ji,uAjU->uAiU', h['a'][c,c], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += -1.0 * np.einsum('juia,aAjU->uAiU', h['aa'][c,a,c,v], t['ab'][pv,pV,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += 1.0 * np.einsum('jIiU,uAjI->uAiU', h['ab'][c,C,c,A], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hA] += -1.0 * np.einsum('jAiB,uBjU->uAiU', h['ab'][c,V,c,V], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += 1.0 * np.einsum('jAaU,uaij->uAiU', h['ab'][c,V,v,A], t['aa'][pa,pv,hc,hc], optimize=True)
	X['ab'][pa,pV,hc,hA] += 1.0 * np.einsum('ua,aAiU->uAiU', h['a'][a,v], t['ab'][pv,pV,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += -1.0 * np.einsum('uIiB,ABIU->uAiU', h['ab'][a,C,c,V], t['bb'][pV,pV,hC,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += -1.0 * np.einsum('uIaU,aAiI->uAiU', h['ab'][a,C,v,A], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hA] += 1.0 * np.einsum('uAaB,aBiU->uAiU', h['ab'][a,V,v,V], t['ab'][pv,pV,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += -1.0 * np.einsum('IU,uAiI->uAiU', h['b'][C,A], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hA] += -1.0 * np.einsum('IAUB,uBiI->uAiU', h['bb'][C,V,A,V], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hA] += 1.0 * np.einsum('AB,uBiU->uAiU', h['b'][V,V], t['ab'][pa,pV,hc,hA], optimize=True)
	# cA|Vv
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('uv,wx,vaiw,xAuU->aAiU', eta1['a'], gamma1['a'], h['aa'][a,v,c,a], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('uv,wx,vAwU,xaiu->aAiU', eta1['a'], gamma1['a'], h['ab'][a,V,a,A], t['aa'][pa,pv,hc,ha], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('uv,wx,xaiu,vAwU->aAiU', eta1['a'], gamma1['a'], h['aa'][a,v,c,a], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('uv,wx,xAuU,vaiw->aAiU', eta1['a'], gamma1['a'], h['ab'][a,V,a,A], t['aa'][pa,pv,hc,ha], optimize=True)
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('uv,VW,vAiV,aWuU->aAiU', eta1['a'], gamma1['b'], h['ab'][a,V,c,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('uv,VW,aWuU,vAiV->aAiU', eta1['a'], gamma1['b'], h['ab'][v,A,a,A], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('uv,jaiu,vAjU->aAiU', eta1['a'], h['aa'][c,v,c,a], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('uv,jAuU,vaij->aAiU', eta1['a'], h['ab'][c,V,a,A], t['aa'][pa,pv,hc,hc], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('uv,vi,aAuU->aAiU', eta1['a'], h['a'][a,c], t['ab'][pv,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('uv,au,vAiU->aAiU', eta1['a'], h['a'][v,a], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('uv,aIuU,vAiI->aAiU', eta1['a'], h['ab'][v,C,a,A], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('uv,aAuB,vBiU->aAiU', eta1['a'], h['ab'][v,V,a,V], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('VW,uv,vWiU,aAuV->aAiU', eta1['b'], eta1['a'], h['ab'][a,A,c,A], t['ab'][pv,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('VW,uv,aAuV,vWiU->aAiU', eta1['b'], eta1['a'], h['ab'][v,V,a,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('VW,uv,vAiV,aWuU->aAiU', eta1['b'], gamma1['a'], h['ab'][a,V,c,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('VW,uv,aWuU,vAiV->aAiU', eta1['b'], gamma1['a'], h['ab'][v,A,a,A], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('VW,XY,aWiX,YAUV->aAiU', eta1['b'], gamma1['b'], h['ab'][v,A,c,A], t['bb'][pA,pV,hA,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('VW,XY,aYiV,WAUX->aAiU', eta1['b'], gamma1['b'], h['ab'][v,A,c,A], t['bb'][pA,pV,hA,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('VW,XY,WAUX,aYiV->aAiU', eta1['b'], gamma1['b'], h['bb'][A,V,A,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('VW,XY,YAUV,aWiX->aAiU', eta1['b'], gamma1['b'], h['bb'][A,V,A,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('VW,jAiV,aWjU->aAiU', eta1['b'], h['ab'][c,V,c,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('VW,aIiV,WAIU->aAiU', eta1['b'], h['ab'][v,C,c,A], t['bb'][pA,pV,hC,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('VW,aAbV,bWiU->aAiU', eta1['b'], h['ab'][v,V,v,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('VW,IAUV,aWiI->aAiU', eta1['b'], h['bb'][C,V,A,A], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('VW,WU,aAiV->aAiU', eta1['b'], h['b'][A,A], t['ab'][pv,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('VW,AV,aWiU->aAiU', eta1['b'], h['b'][V,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('uv,vi,aAuU->aAiU', gamma1['a'], h['a'][a,c], t['ab'][pv,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('uv,vaib,bAuU->aAiU', gamma1['a'], h['aa'][a,v,c,v], t['ab'][pv,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('uv,vIiU,aAuI->aAiU', gamma1['a'], h['ab'][a,C,c,A], t['ab'][pv,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('uv,vAiB,aBuU->aAiU', gamma1['a'], h['ab'][a,V,c,V], t['ab'][pv,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('uv,vAbU,abiu->aAiU', gamma1['a'], h['ab'][a,V,v,A], t['aa'][pv,pv,hc,ha], optimize=True)
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('uv,au,vAiU->aAiU', gamma1['a'], h['a'][v,a], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('VW,uv,vWiU,aAuV->aAiU', gamma1['b'], gamma1['a'], h['ab'][a,A,c,A], t['ab'][pv,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('VW,uv,aAuV,vWiU->aAiU', gamma1['b'], gamma1['a'], h['ab'][v,V,a,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('VW,jWiU,aAjV->aAiU', gamma1['b'], h['ab'][c,A,c,A], t['ab'][pv,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('VW,aWiB,ABUV->aAiU', gamma1['b'], h['ab'][v,A,c,V], t['bb'][pV,pV,hA,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('VW,aWbU,bAiV->aAiU', gamma1['b'], h['ab'][v,A,v,A], t['ab'][pv,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('VW,WU,aAiV->aAiU', gamma1['b'], h['b'][A,A], t['ab'][pv,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('VW,WAUB,aBiV->aAiU', gamma1['b'], h['bb'][A,V,A,V], t['ab'][pv,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('VW,AV,aWiU->aAiU', gamma1['b'], h['b'][V,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('ji,aAjU->aAiU', h['a'][c,c], t['ab'][pv,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('jaib,bAjU->aAiU', h['aa'][c,v,c,v], t['ab'][pv,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('jIiU,aAjI->aAiU', h['ab'][c,C,c,A], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('jAiB,aBjU->aAiU', h['ab'][c,V,c,V], t['ab'][pv,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('jAbU,abij->aAiU', h['ab'][c,V,v,A], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('ab,bAiU->aAiU', h['a'][v,v], t['ab'][pv,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('aIiB,ABIU->aAiU', h['ab'][v,C,c,V], t['bb'][pV,pV,hC,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('aIbU,bAiI->aAiU', h['ab'][v,C,v,A], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('aAbB,bBiU->aAiU', h['ab'][v,V,v,V], t['ab'][pv,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('IU,aAiI->aAiU', h['b'][C,A], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('IAUB,aBiI->aAiU', h['bb'][C,V,A,V], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('AB,aBiU->aAiU', h['b'][V,V], t['ab'][pv,pV,hc,hA], optimize=True)
	# cC|Aa
	X['ab'][pa,pA,hc,hC] += -1.0 * np.einsum('vw,xy,uwix,yUvI->uUiI', eta1['a'], gamma1['a'], h['aa'][a,a,c,a], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pA,hc,hC] += 1.0 * np.einsum('vw,xy,uyiv,wUxI->uUiI', eta1['a'], gamma1['a'], h['aa'][a,a,c,a], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pA,hc,hC] += -1.0 * np.einsum('vw,xy,wUxI,uyiv->uUiI', eta1['a'], gamma1['a'], h['ab'][a,A,a,C], t['aa'][pa,pa,hc,ha], optimize=True)
	X['ab'][pa,pA,hc,hC] += 1.0 * np.einsum('vw,xy,yUvI,uwix->uUiI', eta1['a'], gamma1['a'], h['ab'][a,A,a,C], t['aa'][pa,pa,hc,ha], optimize=True)
	X['ab'][pa,pA,hc,hC] += -1.0 * np.einsum('vw,VW,uWvI,wUiV->uUiI', eta1['a'], gamma1['b'], h['ab'][a,A,a,C], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pA,hc,hC] += 1.0 * np.einsum('vw,VW,wUiV,uWvI->uUiI', eta1['a'], gamma1['b'], h['ab'][a,A,c,A], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pA,hc,hC] += -1.0 * np.einsum('vw,juiv,wUjI->uUiI', eta1['a'], h['aa'][c,a,c,a], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pa,pA,hc,hC] += 1.0 * np.einsum('vw,jUvI,uwij->uUiI', eta1['a'], h['ab'][c,A,a,C], t['aa'][pa,pa,hc,hc], optimize=True)
	X['ab'][pa,pA,hc,hC] += 1.0 * np.einsum('vw,uv,wUiI->uUiI', eta1['a'], h['a'][a,a], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pa,pA,hc,hC] += -1.0 * np.einsum('vw,uJvI,wUiJ->uUiI', eta1['a'], h['ab'][a,C,a,C], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pa,pA,hc,hC] += 1.0 * np.einsum('vw,uUvA,wAiI->uUiI', eta1['a'], h['ab'][a,A,a,V], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pa,pA,hc,hC] += -1.0 * np.einsum('vw,wi,uUvI->uUiI', eta1['a'], h['a'][a,c], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pA,hc,hC] += 1.0 * np.einsum('VW,vw,uUvV,wWiI->uUiI', eta1['b'], eta1['a'], h['ab'][a,A,a,A], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pa,pA,hc,hC] += 1.0 * np.einsum('VW,vw,uWvI,wUiV->uUiI', eta1['b'], gamma1['a'], h['ab'][a,A,a,C], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pA,hc,hC] += -1.0 * np.einsum('VW,vw,wUiV,uWvI->uUiI', eta1['b'], gamma1['a'], h['ab'][a,A,c,A], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pA,hc,hC] += -1.0 * np.einsum('VW,XY,uWiX,UYIV->uUiI', eta1['b'], gamma1['b'], h['ab'][a,A,c,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['ab'][pa,pA,hc,hC] += 1.0 * np.einsum('VW,XY,uYiV,UWIX->uUiI', eta1['b'], gamma1['b'], h['ab'][a,A,c,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['ab'][pa,pA,hc,hC] += -1.0 * np.einsum('VW,XY,UWIX,uYiV->uUiI', eta1['b'], gamma1['b'], h['bb'][A,A,C,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pA,hc,hC] += 1.0 * np.einsum('VW,XY,UYIV,uWiX->uUiI', eta1['b'], gamma1['b'], h['bb'][A,A,C,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pA,hc,hC] += -1.0 * np.einsum('VW,jUiV,uWjI->uUiI', eta1['b'], h['ab'][c,A,c,A], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pa,pA,hc,hC] += 1.0 * np.einsum('VW,uJiV,UWIJ->uUiI', eta1['b'], h['ab'][a,C,c,A], t['bb'][pA,pA,hC,hC], optimize=True)
	X['ab'][pa,pA,hc,hC] += 1.0 * np.einsum('VW,uUaV,aWiI->uUiI', eta1['b'], h['ab'][a,A,v,A], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pa,pA,hc,hC] += -1.0 * np.einsum('VW,JUIV,uWiJ->uUiI', eta1['b'], h['bb'][C,A,C,A], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pa,pA,hc,hC] += 1.0 * np.einsum('VW,UV,uWiI->uUiI', eta1['b'], h['b'][A,A], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pa,pA,hc,hC] += -1.0 * np.einsum('VW,WI,uUiV->uUiI', eta1['b'], h['b'][A,C], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pA,hc,hC] += 1.0 * np.einsum('vw,uv,wUiI->uUiI', gamma1['a'], h['a'][a,a], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pa,pA,hc,hC] += 1.0 * np.einsum('vw,uwia,aUvI->uUiI', gamma1['a'], h['aa'][a,a,c,v], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pa,pA,hc,hC] += -1.0 * np.einsum('vw,wi,uUvI->uUiI', gamma1['a'], h['a'][a,c], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pA,hc,hC] += 1.0 * np.einsum('vw,wJiI,uUvJ->uUiI', gamma1['a'], h['ab'][a,C,c,C], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pA,hc,hC] += -1.0 * np.einsum('vw,wUiA,uAvI->uUiI', gamma1['a'], h['ab'][a,A,c,V], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pa,pA,hc,hC] += 1.0 * np.einsum('vw,wUaI,uaiv->uUiI', gamma1['a'], h['ab'][a,A,v,C], t['aa'][pa,pv,hc,ha], optimize=True)
	X['ab'][pa,pA,hc,hC] += -1.0 * np.einsum('VW,vw,uUvV,wWiI->uUiI', gamma1['b'], gamma1['a'], h['ab'][a,A,a,A], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pa,pA,hc,hC] += 1.0 * np.einsum('VW,jWiI,uUjV->uUiI', gamma1['b'], h['ab'][c,A,c,C], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pA,hc,hC] += 1.0 * np.einsum('VW,uWiA,UAIV->uUiI', gamma1['b'], h['ab'][a,A,c,V], t['bb'][pA,pV,hC,hA], optimize=True)
	X['ab'][pa,pA,hc,hC] += -1.0 * np.einsum('VW,uWaI,aUiV->uUiI', gamma1['b'], h['ab'][a,A,v,C], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pa,pA,hc,hC] += 1.0 * np.einsum('VW,UV,uWiI->uUiI', gamma1['b'], h['b'][A,A], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pa,pA,hc,hC] += 1.0 * np.einsum('VW,UWIA,uAiV->uUiI', gamma1['b'], h['bb'][A,A,C,V], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pa,pA,hc,hC] += -1.0 * np.einsum('VW,WI,uUiV->uUiI', gamma1['b'], h['b'][A,C], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pA,hc,hC] += -1.0 * np.einsum('ji,uUjI->uUiI', h['a'][c,c], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pa,pA,hc,hC] += -1.0 * np.einsum('juia,aUjI->uUiI', h['aa'][c,a,c,v], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pa,pA,hc,hC] += 1.0 * np.einsum('jJiI,uUjJ->uUiI', h['ab'][c,C,c,C], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pa,pA,hc,hC] += -1.0 * np.einsum('jUiA,uAjI->uUiI', h['ab'][c,A,c,V], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pa,pA,hc,hC] += 1.0 * np.einsum('jUaI,uaij->uUiI', h['ab'][c,A,v,C], t['aa'][pa,pv,hc,hc], optimize=True)
	X['ab'][pa,pA,hc,hC] += 1.0 * np.einsum('ua,aUiI->uUiI', h['a'][a,v], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pa,pA,hc,hC] += 1.0 * np.einsum('uJiA,UAIJ->uUiI', h['ab'][a,C,c,V], t['bb'][pA,pV,hC,hC], optimize=True)
	X['ab'][pa,pA,hc,hC] += -1.0 * np.einsum('uJaI,aUiJ->uUiI', h['ab'][a,C,v,C], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pa,pA,hc,hC] += 1.0 * np.einsum('uUaA,aAiI->uUiI', h['ab'][a,A,v,V], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pa,pA,hc,hC] += -1.0 * np.einsum('JI,uUiJ->uUiI', h['b'][C,C], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pa,pA,hc,hC] += -1.0 * np.einsum('JUIA,uAiJ->uUiI', h['bb'][C,A,C,V], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pa,pA,hc,hC] += 1.0 * np.einsum('UA,uAiI->uUiI', h['b'][A,V], t['ab'][pa,pV,hc,hC], optimize=True)
	# cC|Av
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('uv,wx,vaiw,xUuI->aUiI', eta1['a'], gamma1['a'], h['aa'][a,v,c,a], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('uv,wx,vUwI,xaiu->aUiI', eta1['a'], gamma1['a'], h['ab'][a,A,a,C], t['aa'][pa,pv,hc,ha], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('uv,wx,xaiu,vUwI->aUiI', eta1['a'], gamma1['a'], h['aa'][a,v,c,a], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('uv,wx,xUuI,vaiw->aUiI', eta1['a'], gamma1['a'], h['ab'][a,A,a,C], t['aa'][pa,pv,hc,ha], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('uv,VW,vUiV,aWuI->aUiI', eta1['a'], gamma1['b'], h['ab'][a,A,c,A], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('uv,VW,aWuI,vUiV->aUiI', eta1['a'], gamma1['b'], h['ab'][v,A,a,C], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('uv,jaiu,vUjI->aUiI', eta1['a'], h['aa'][c,v,c,a], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('uv,jUuI,vaij->aUiI', eta1['a'], h['ab'][c,A,a,C], t['aa'][pa,pv,hc,hc], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('uv,vi,aUuI->aUiI', eta1['a'], h['a'][a,c], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('uv,au,vUiI->aUiI', eta1['a'], h['a'][v,a], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('uv,aJuI,vUiJ->aUiI', eta1['a'], h['ab'][v,C,a,C], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('uv,aUuA,vAiI->aUiI', eta1['a'], h['ab'][v,A,a,V], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('VW,uv,vWiI,aUuV->aUiI', eta1['b'], eta1['a'], h['ab'][a,A,c,C], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('VW,uv,aUuV,vWiI->aUiI', eta1['b'], eta1['a'], h['ab'][v,A,a,A], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('VW,uv,vUiV,aWuI->aUiI', eta1['b'], gamma1['a'], h['ab'][a,A,c,A], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('VW,uv,aWuI,vUiV->aUiI', eta1['b'], gamma1['a'], h['ab'][v,A,a,C], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('VW,XY,aWiX,UYIV->aUiI', eta1['b'], gamma1['b'], h['ab'][v,A,c,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('VW,XY,aYiV,UWIX->aUiI', eta1['b'], gamma1['b'], h['ab'][v,A,c,A], t['bb'][pA,pA,hC,hA], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('VW,XY,UWIX,aYiV->aUiI', eta1['b'], gamma1['b'], h['bb'][A,A,C,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('VW,XY,UYIV,aWiX->aUiI', eta1['b'], gamma1['b'], h['bb'][A,A,C,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('VW,jUiV,aWjI->aUiI', eta1['b'], h['ab'][c,A,c,A], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('VW,aJiV,UWIJ->aUiI', eta1['b'], h['ab'][v,C,c,A], t['bb'][pA,pA,hC,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('VW,aUbV,bWiI->aUiI', eta1['b'], h['ab'][v,A,v,A], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('VW,JUIV,aWiJ->aUiI', eta1['b'], h['bb'][C,A,C,A], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('VW,UV,aWiI->aUiI', eta1['b'], h['b'][A,A], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('VW,WI,aUiV->aUiI', eta1['b'], h['b'][A,C], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('uv,vi,aUuI->aUiI', gamma1['a'], h['a'][a,c], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('uv,vaib,bUuI->aUiI', gamma1['a'], h['aa'][a,v,c,v], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('uv,vJiI,aUuJ->aUiI', gamma1['a'], h['ab'][a,C,c,C], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('uv,vUiA,aAuI->aUiI', gamma1['a'], h['ab'][a,A,c,V], t['ab'][pv,pV,ha,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('uv,vUbI,abiu->aUiI', gamma1['a'], h['ab'][a,A,v,C], t['aa'][pv,pv,hc,ha], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('uv,au,vUiI->aUiI', gamma1['a'], h['a'][v,a], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('VW,uv,vWiI,aUuV->aUiI', gamma1['b'], gamma1['a'], h['ab'][a,A,c,C], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('VW,uv,aUuV,vWiI->aUiI', gamma1['b'], gamma1['a'], h['ab'][v,A,a,A], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('VW,jWiI,aUjV->aUiI', gamma1['b'], h['ab'][c,A,c,C], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('VW,aWiA,UAIV->aUiI', gamma1['b'], h['ab'][v,A,c,V], t['bb'][pA,pV,hC,hA], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('VW,aWbI,bUiV->aUiI', gamma1['b'], h['ab'][v,A,v,C], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('VW,UV,aWiI->aUiI', gamma1['b'], h['b'][A,A], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('VW,UWIA,aAiV->aUiI', gamma1['b'], h['bb'][A,A,C,V], t['ab'][pv,pV,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('VW,WI,aUiV->aUiI', gamma1['b'], h['b'][A,C], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('ji,aUjI->aUiI', h['a'][c,c], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('jaib,bUjI->aUiI', h['aa'][c,v,c,v], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('jJiI,aUjJ->aUiI', h['ab'][c,C,c,C], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('jUiA,aAjI->aUiI', h['ab'][c,A,c,V], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('jUbI,abij->aUiI', h['ab'][c,A,v,C], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('ab,bUiI->aUiI', h['a'][v,v], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('aJiA,UAIJ->aUiI', h['ab'][v,C,c,V], t['bb'][pA,pV,hC,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('aJbI,bUiJ->aUiI', h['ab'][v,C,v,C], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('aUbA,bAiI->aUiI', h['ab'][v,A,v,V], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('JI,aUiJ->aUiI', h['b'][C,C], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('JUIA,aAiJ->aUiI', h['bb'][C,A,C,V], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('UA,aAiI->aUiI', h['b'][A,V], t['ab'][pv,pV,hc,hC], optimize=True)
	# cC|Va
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('vw,xy,uwix,yAvI->uAiI', eta1['a'], gamma1['a'], h['aa'][a,a,c,a], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('vw,xy,uyiv,wAxI->uAiI', eta1['a'], gamma1['a'], h['aa'][a,a,c,a], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('vw,xy,wAxI,uyiv->uAiI', eta1['a'], gamma1['a'], h['ab'][a,V,a,C], t['aa'][pa,pa,hc,ha], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('vw,xy,yAvI,uwix->uAiI', eta1['a'], gamma1['a'], h['ab'][a,V,a,C], t['aa'][pa,pa,hc,ha], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('vw,UV,uVvI,wAiU->uAiI', eta1['a'], gamma1['b'], h['ab'][a,A,a,C], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('vw,UV,wAiU,uVvI->uAiI', eta1['a'], gamma1['b'], h['ab'][a,V,c,A], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('vw,juiv,wAjI->uAiI', eta1['a'], h['aa'][c,a,c,a], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('vw,jAvI,uwij->uAiI', eta1['a'], h['ab'][c,V,a,C], t['aa'][pa,pa,hc,hc], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('vw,uv,wAiI->uAiI', eta1['a'], h['a'][a,a], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('vw,uJvI,wAiJ->uAiI', eta1['a'], h['ab'][a,C,a,C], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('vw,uAvB,wBiI->uAiI', eta1['a'], h['ab'][a,V,a,V], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('vw,wi,uAvI->uAiI', eta1['a'], h['a'][a,c], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('UV,vw,uAvU,wViI->uAiI', eta1['b'], eta1['a'], h['ab'][a,V,a,A], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('UV,vw,wViI,uAvU->uAiI', eta1['b'], eta1['a'], h['ab'][a,A,c,C], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('UV,vw,uVvI,wAiU->uAiI', eta1['b'], gamma1['a'], h['ab'][a,A,a,C], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('UV,vw,wAiU,uVvI->uAiI', eta1['b'], gamma1['a'], h['ab'][a,V,c,A], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('UV,WX,uViW,XAIU->uAiI', eta1['b'], gamma1['b'], h['ab'][a,A,c,A], t['bb'][pA,pV,hC,hA], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('UV,WX,uXiU,VAIW->uAiI', eta1['b'], gamma1['b'], h['ab'][a,A,c,A], t['bb'][pA,pV,hC,hA], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('UV,WX,VAIW,uXiU->uAiI', eta1['b'], gamma1['b'], h['bb'][A,V,C,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('UV,WX,XAIU,uViW->uAiI', eta1['b'], gamma1['b'], h['bb'][A,V,C,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('UV,jAiU,uVjI->uAiI', eta1['b'], h['ab'][c,V,c,A], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('UV,uJiU,VAIJ->uAiI', eta1['b'], h['ab'][a,C,c,A], t['bb'][pA,pV,hC,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('UV,uAaU,aViI->uAiI', eta1['b'], h['ab'][a,V,v,A], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('UV,JAIU,uViJ->uAiI', eta1['b'], h['bb'][C,V,C,A], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('UV,VI,uAiU->uAiI', eta1['b'], h['b'][A,C], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('UV,AU,uViI->uAiI', eta1['b'], h['b'][V,A], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('vw,uv,wAiI->uAiI', gamma1['a'], h['a'][a,a], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('vw,uwia,aAvI->uAiI', gamma1['a'], h['aa'][a,a,c,v], t['ab'][pv,pV,ha,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('vw,wi,uAvI->uAiI', gamma1['a'], h['a'][a,c], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('vw,wJiI,uAvJ->uAiI', gamma1['a'], h['ab'][a,C,c,C], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('vw,wAiB,uBvI->uAiI', gamma1['a'], h['ab'][a,V,c,V], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('vw,wAaI,uaiv->uAiI', gamma1['a'], h['ab'][a,V,v,C], t['aa'][pa,pv,hc,ha], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('UV,vw,uAvU,wViI->uAiI', gamma1['b'], gamma1['a'], h['ab'][a,V,a,A], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('UV,vw,wViI,uAvU->uAiI', gamma1['b'], gamma1['a'], h['ab'][a,A,c,C], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('UV,jViI,uAjU->uAiI', gamma1['b'], h['ab'][c,A,c,C], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('UV,uViB,ABIU->uAiI', gamma1['b'], h['ab'][a,A,c,V], t['bb'][pV,pV,hC,hA], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('UV,uVaI,aAiU->uAiI', gamma1['b'], h['ab'][a,A,v,C], t['ab'][pv,pV,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('UV,VI,uAiU->uAiI', gamma1['b'], h['b'][A,C], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('UV,VAIB,uBiU->uAiI', gamma1['b'], h['bb'][A,V,C,V], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('UV,AU,uViI->uAiI', gamma1['b'], h['b'][V,A], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('ji,uAjI->uAiI', h['a'][c,c], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('juia,aAjI->uAiI', h['aa'][c,a,c,v], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('jJiI,uAjJ->uAiI', h['ab'][c,C,c,C], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('jAiB,uBjI->uAiI', h['ab'][c,V,c,V], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('jAaI,uaij->uAiI', h['ab'][c,V,v,C], t['aa'][pa,pv,hc,hc], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('ua,aAiI->uAiI', h['a'][a,v], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('uJiB,ABIJ->uAiI', h['ab'][a,C,c,V], t['bb'][pV,pV,hC,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('uJaI,aAiJ->uAiI', h['ab'][a,C,v,C], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('uAaB,aBiI->uAiI', h['ab'][a,V,v,V], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('JI,uAiJ->uAiI', h['b'][C,C], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('JAIB,uBiJ->uAiI', h['bb'][C,V,C,V], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('AB,uBiI->uAiI', h['b'][V,V], t['ab'][pa,pV,hc,hC], optimize=True)
	# cC|Vv
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('uv,wx,vaiw,xAuI->aAiI', eta1['a'], gamma1['a'], h['aa'][a,v,c,a], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('uv,wx,vAwI,xaiu->aAiI', eta1['a'], gamma1['a'], h['ab'][a,V,a,C], t['aa'][pa,pv,hc,ha], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('uv,wx,xaiu,vAwI->aAiI', eta1['a'], gamma1['a'], h['aa'][a,v,c,a], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('uv,wx,xAuI,vaiw->aAiI', eta1['a'], gamma1['a'], h['ab'][a,V,a,C], t['aa'][pa,pv,hc,ha], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('uv,UV,vAiU,aVuI->aAiI', eta1['a'], gamma1['b'], h['ab'][a,V,c,A], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('uv,UV,aVuI,vAiU->aAiI', eta1['a'], gamma1['b'], h['ab'][v,A,a,C], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('uv,jaiu,vAjI->aAiI', eta1['a'], h['aa'][c,v,c,a], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('uv,jAuI,vaij->aAiI', eta1['a'], h['ab'][c,V,a,C], t['aa'][pa,pv,hc,hc], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('uv,vi,aAuI->aAiI', eta1['a'], h['a'][a,c], t['ab'][pv,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('uv,au,vAiI->aAiI', eta1['a'], h['a'][v,a], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('uv,aJuI,vAiJ->aAiI', eta1['a'], h['ab'][v,C,a,C], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('uv,aAuB,vBiI->aAiI', eta1['a'], h['ab'][v,V,a,V], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,uv,vViI,aAuU->aAiI', eta1['b'], eta1['a'], h['ab'][a,A,c,C], t['ab'][pv,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('UV,uv,aAuU,vViI->aAiI', eta1['b'], eta1['a'], h['ab'][v,V,a,A], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,uv,vAiU,aVuI->aAiI', eta1['b'], gamma1['a'], h['ab'][a,V,c,A], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('UV,uv,aVuI,vAiU->aAiI', eta1['b'], gamma1['a'], h['ab'][v,A,a,C], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('UV,WX,aViW,XAIU->aAiI', eta1['b'], gamma1['b'], h['ab'][v,A,c,A], t['bb'][pA,pV,hC,hA], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,WX,aXiU,VAIW->aAiI', eta1['b'], gamma1['b'], h['ab'][v,A,c,A], t['bb'][pA,pV,hC,hA], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('UV,WX,VAIW,aXiU->aAiI', eta1['b'], gamma1['b'], h['bb'][A,V,C,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,WX,XAIU,aViW->aAiI', eta1['b'], gamma1['b'], h['bb'][A,V,C,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,jAiU,aVjI->aAiI', eta1['b'], h['ab'][c,V,c,A], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,aJiU,VAIJ->aAiI', eta1['b'], h['ab'][v,C,c,A], t['bb'][pA,pV,hC,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('UV,aAbU,bViI->aAiI', eta1['b'], h['ab'][v,V,v,A], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,JAIU,aViJ->aAiI', eta1['b'], h['bb'][C,V,C,A], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,VI,aAiU->aAiI', eta1['b'], h['b'][A,C], t['ab'][pv,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('UV,AU,aViI->aAiI', eta1['b'], h['b'][V,A], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('uv,vi,aAuI->aAiI', gamma1['a'], h['a'][a,c], t['ab'][pv,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('uv,vaib,bAuI->aAiI', gamma1['a'], h['aa'][a,v,c,v], t['ab'][pv,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('uv,vJiI,aAuJ->aAiI', gamma1['a'], h['ab'][a,C,c,C], t['ab'][pv,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('uv,vAiB,aBuI->aAiI', gamma1['a'], h['ab'][a,V,c,V], t['ab'][pv,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('uv,vAbI,abiu->aAiI', gamma1['a'], h['ab'][a,V,v,C], t['aa'][pv,pv,hc,ha], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('uv,au,vAiI->aAiI', gamma1['a'], h['a'][v,a], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('UV,uv,vViI,aAuU->aAiI', gamma1['b'], gamma1['a'], h['ab'][a,A,c,C], t['ab'][pv,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,uv,aAuU,vViI->aAiI', gamma1['b'], gamma1['a'], h['ab'][v,V,a,A], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('UV,jViI,aAjU->aAiI', gamma1['b'], h['ab'][c,A,c,C], t['ab'][pv,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('UV,aViB,ABIU->aAiI', gamma1['b'], h['ab'][v,A,c,V], t['bb'][pV,pV,hC,hA], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,aVbI,bAiU->aAiI', gamma1['b'], h['ab'][v,A,v,C], t['ab'][pv,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,VI,aAiU->aAiI', gamma1['b'], h['b'][A,C], t['ab'][pv,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,VAIB,aBiU->aAiI', gamma1['b'], h['bb'][A,V,C,V], t['ab'][pv,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('UV,AU,aViI->aAiI', gamma1['b'], h['b'][V,A], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('ji,aAjI->aAiI', h['a'][c,c], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('jaib,bAjI->aAiI', h['aa'][c,v,c,v], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('jJiI,aAjJ->aAiI', h['ab'][c,C,c,C], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('jAiB,aBjI->aAiI', h['ab'][c,V,c,V], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('jAbI,abij->aAiI', h['ab'][c,V,v,C], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('ab,bAiI->aAiI', h['a'][v,v], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('aJiB,ABIJ->aAiI', h['ab'][v,C,c,V], t['bb'][pV,pV,hC,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('aJbI,bAiJ->aAiI', h['ab'][v,C,v,C], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('aAbB,bBiI->aAiI', h['ab'][v,V,v,V], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('JI,aAiJ->aAiI', h['b'][C,C], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('JAIB,aBiJ->aAiI', h['bb'][C,V,C,V], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('AB,aBiI->aAiI', h['b'][V,V], t['ab'][pv,pV,hc,hC], optimize=True)
	# ca|aa
	X['aa'][pa,pa,hc,ha] += 0.25 * np.einsum('xy,zp,uvxz,ypiw->uviw', eta1['a'], eta1['a'], h['aa'][a,a,a,a], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pa,hc,ha] += 1.0 * np.einsum('xy,zp,uyvz,wpix->uwiv', eta1['a'], gamma1['a'], h['aa'][a,a,a,a], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pa,hc,ha] += -1.0 * np.einsum('xy,zp,upvx,wyiz->uwiv', eta1['a'], gamma1['a'], h['aa'][a,a,a,a], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pa,hc,ha] += 1.0 * np.einsum('xy,juix,vyjw->uviw', eta1['a'], h['aa'][c,a,c,a], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pa,hc,ha] += 1.0 * np.einsum('xy,juvx,wyij->uwiv', eta1['a'], h['aa'][c,a,a,a], t['aa'][pa,pa,hc,hc], optimize=True)
	X['aa'][pa,pa,hc,ha] += -1.0 * np.einsum('xy,ux,vyiw->uviw', eta1['a'], h['a'][a,a], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pa,hc,ha] += 0.5 * np.einsum('xy,uvxa,yaiw->uviw', eta1['a'], h['aa'][a,a,a,v], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pa,pa,hc,ha] += -0.5 * np.einsum('xy,yu,vwix->vwiu', eta1['a'], h['a'][a,a], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pa,hc,ha] += 1.0 * np.einsum('UV,WX,uVvW,wXiU->uwiv', eta1['b'], gamma1['b'], h['ab'][a,A,a,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['aa'][pa,pa,hc,ha] += -1.0 * np.einsum('UV,WX,uXvU,wViW->uwiv', eta1['b'], gamma1['b'], h['ab'][a,A,a,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['aa'][pa,pa,hc,ha] += 1.0 * np.einsum('UV,uIiU,vVwI->uviw', eta1['b'], h['ab'][a,C,c,A], t['ab'][pa,pA,ha,hC], optimize=True)
	X['aa'][pa,pa,hc,ha] += -1.0 * np.einsum('UV,uIvU,wViI->uwiv', eta1['b'], h['ab'][a,C,a,A], t['ab'][pa,pA,hc,hC], optimize=True)
	X['aa'][pa,pa,hc,ha] += -0.25 * np.einsum('xy,zp,uvxz,ypiw->uviw', gamma1['a'], gamma1['a'], h['aa'][a,a,a,a], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pa,hc,ha] += 0.5 * np.einsum('xy,jyiu,vwjx->vwiu', gamma1['a'], h['aa'][c,a,c,a], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pa,hc,ha] += -1.0 * np.einsum('xy,ux,vyiw->uviw', gamma1['a'], h['a'][a,a], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pa,hc,ha] += 1.0 * np.einsum('xy,uyia,vawx->uviw', gamma1['a'], h['aa'][a,a,c,v], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pa,pa,hc,ha] += -1.0 * np.einsum('xy,uyva,waix->uwiv', gamma1['a'], h['aa'][a,a,a,v], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pa,pa,hc,ha] += -0.5 * np.einsum('xy,yu,vwix->vwiu', gamma1['a'], h['a'][a,a], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pa,hc,ha] += 1.0 * np.einsum('UV,uViA,vAwU->uviw', gamma1['b'], h['ab'][a,A,c,V], t['ab'][pa,pV,ha,hA], optimize=True)
	X['aa'][pa,pa,hc,ha] += -1.0 * np.einsum('UV,uVvA,wAiU->uwiv', gamma1['b'], h['ab'][a,A,a,V], t['ab'][pa,pV,hc,hA], optimize=True)
	X['aa'][pa,pa,hc,ha] += -0.5 * np.einsum('ji,uvjw->uviw', h['a'][c,c], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pa,hc,ha] += -0.5 * np.einsum('ju,vwij->vwiu', h['a'][c,a], t['aa'][pa,pa,hc,hc], optimize=True)
	X['aa'][pa,pa,hc,ha] += 0.25 * np.einsum('jkiu,vwjk->vwiu', h['aa'][c,c,c,a], t['aa'][pa,pa,hc,hc], optimize=True)
	X['aa'][pa,pa,hc,ha] += 1.0 * np.einsum('juia,vajw->uviw', h['aa'][c,a,c,v], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pa,pa,hc,ha] += 1.0 * np.einsum('juva,waij->uwiv', h['aa'][c,a,a,v], t['aa'][pa,pv,hc,hc], optimize=True)
	X['aa'][pa,pa,hc,ha] += -1.0 * np.einsum('ua,vaiw->uviw', h['a'][a,v], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pa,pa,hc,ha] += 0.25 * np.einsum('uvab,abiw->uviw', h['aa'][a,a,v,v], t['aa'][pv,pv,hc,ha], optimize=True)
	X['aa'][pa,pa,hc,ha] += 1.0 * np.einsum('uIiA,vAwI->uviw', h['ab'][a,C,c,V], t['ab'][pa,pV,ha,hC], optimize=True)
	X['aa'][pa,pa,hc,ha] += -1.0 * np.einsum('uIvA,wAiI->uwiv', h['ab'][a,C,a,V], t['ab'][pa,pV,hc,hC], optimize=True)
	# ca|va
	X['aa'][pa,pv,hc,ha] += 0.5 * np.einsum('wx,yz,uawy,xziv->uaiv', eta1['a'], eta1['a'], h['aa'][a,v,a,a], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += -0.5 * np.einsum('wx,yz,xziu,vawy->vaiu', eta1['a'], eta1['a'], h['aa'][a,a,c,a], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += 1.0 * np.einsum('wx,yz,uxiy,zavw->uaiv', eta1['a'], gamma1['a'], h['aa'][a,a,c,a], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += -1.0 * np.einsum('wx,yz,uxvy,zaiw->uaiv', eta1['a'], gamma1['a'], h['aa'][a,a,a,a], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += -1.0 * np.einsum('wx,yz,uziw,xavy->uaiv', eta1['a'], gamma1['a'], h['aa'][a,a,c,a], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += 1.0 * np.einsum('wx,yz,uzvw,xaiy->uaiv', eta1['a'], gamma1['a'], h['aa'][a,a,a,a], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += 1.0 * np.einsum('wx,yz,xauy,vziw->vaiu', eta1['a'], gamma1['a'], h['aa'][a,v,a,a], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += -1.0 * np.einsum('wx,yz,zauw,vxiy->vaiu', eta1['a'], gamma1['a'], h['aa'][a,v,a,a], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += -1.0 * np.einsum('wx,juiw,xajv->uaiv', eta1['a'], h['aa'][c,a,c,a], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += -1.0 * np.einsum('wx,juvw,xaij->uaiv', eta1['a'], h['aa'][c,a,a,a], t['aa'][pa,pv,hc,hc], optimize=True)
	X['aa'][pa,pv,hc,ha] += -1.0 * np.einsum('wx,jaiw,uxjv->uaiv', eta1['a'], h['aa'][c,v,c,a], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += -1.0 * np.einsum('wx,jauw,vxij->vaiu', eta1['a'], h['aa'][c,v,a,a], t['aa'][pa,pa,hc,hc], optimize=True)
	X['aa'][pa,pv,hc,ha] += 1.0 * np.einsum('wx,uw,xaiv->uaiv', eta1['a'], h['a'][a,a], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += 1.0 * np.einsum('wx,uawb,xbiv->uaiv', eta1['a'], h['aa'][a,v,a,v], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += 1.0 * np.einsum('wx,xi,uavw->uaiv', eta1['a'], h['a'][a,c], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += -1.0 * np.einsum('wx,xu,vaiw->vaiu', eta1['a'], h['a'][a,a], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += 1.0 * np.einsum('wx,aw,uxiv->uaiv', eta1['a'], h['a'][v,a], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += -1.0 * np.einsum('UV,WX,uViW,aXvU->uaiv', eta1['b'], gamma1['b'], h['ab'][a,A,c,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['aa'][pa,pv,hc,ha] += 1.0 * np.einsum('UV,WX,uVvW,aXiU->uaiv', eta1['b'], gamma1['b'], h['ab'][a,A,a,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['aa'][pa,pv,hc,ha] += 1.0 * np.einsum('UV,WX,uXiU,aVvW->uaiv', eta1['b'], gamma1['b'], h['ab'][a,A,c,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['aa'][pa,pv,hc,ha] += -1.0 * np.einsum('UV,WX,uXvU,aViW->uaiv', eta1['b'], gamma1['b'], h['ab'][a,A,a,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['aa'][pa,pv,hc,ha] += -1.0 * np.einsum('UV,WX,aVuW,vXiU->vaiu', eta1['b'], gamma1['b'], h['ab'][v,A,a,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['aa'][pa,pv,hc,ha] += 1.0 * np.einsum('UV,WX,aXuU,vViW->vaiu', eta1['b'], gamma1['b'], h['ab'][v,A,a,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['aa'][pa,pv,hc,ha] += 1.0 * np.einsum('UV,uIiU,aVvI->uaiv', eta1['b'], h['ab'][a,C,c,A], t['ab'][pv,pA,ha,hC], optimize=True)
	X['aa'][pa,pv,hc,ha] += -1.0 * np.einsum('UV,uIvU,aViI->uaiv', eta1['b'], h['ab'][a,C,a,A], t['ab'][pv,pA,hc,hC], optimize=True)
	X['aa'][pa,pv,hc,ha] += -1.0 * np.einsum('UV,aIiU,uVvI->uaiv', eta1['b'], h['ab'][v,C,c,A], t['ab'][pa,pA,ha,hC], optimize=True)
	X['aa'][pa,pv,hc,ha] += 1.0 * np.einsum('UV,aIuU,vViI->vaiu', eta1['b'], h['ab'][v,C,a,A], t['ab'][pa,pA,hc,hC], optimize=True)
	X['aa'][pa,pv,hc,ha] += -0.5 * np.einsum('wx,yz,uawy,xziv->uaiv', gamma1['a'], gamma1['a'], h['aa'][a,v,a,a], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += 0.5 * np.einsum('wx,yz,xziu,vawy->vaiu', gamma1['a'], gamma1['a'], h['aa'][a,a,c,a], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += 1.0 * np.einsum('wx,jxiu,vajw->vaiu', gamma1['a'], h['aa'][c,a,c,a], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += 1.0 * np.einsum('wx,uw,xaiv->uaiv', gamma1['a'], h['a'][a,a], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += 1.0 * np.einsum('wx,uxib,abvw->uaiv', gamma1['a'], h['aa'][a,a,c,v], t['aa'][pv,pv,ha,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += -1.0 * np.einsum('wx,uxvb,abiw->uaiv', gamma1['a'], h['aa'][a,a,a,v], t['aa'][pv,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += 1.0 * np.einsum('wx,xi,uavw->uaiv', gamma1['a'], h['a'][a,c], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += -1.0 * np.einsum('wx,xu,vaiw->vaiu', gamma1['a'], h['a'][a,a], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += 1.0 * np.einsum('wx,xaib,ubvw->uaiv', gamma1['a'], h['aa'][a,v,c,v], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += -1.0 * np.einsum('wx,xaub,vbiw->vaiu', gamma1['a'], h['aa'][a,v,a,v], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += 1.0 * np.einsum('wx,aw,uxiv->uaiv', gamma1['a'], h['a'][v,a], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += 1.0 * np.einsum('UV,uViA,aAvU->uaiv', gamma1['b'], h['ab'][a,A,c,V], t['ab'][pv,pV,ha,hA], optimize=True)
	X['aa'][pa,pv,hc,ha] += -1.0 * np.einsum('UV,uVvA,aAiU->uaiv', gamma1['b'], h['ab'][a,A,a,V], t['ab'][pv,pV,hc,hA], optimize=True)
	X['aa'][pa,pv,hc,ha] += -1.0 * np.einsum('UV,aViA,uAvU->uaiv', gamma1['b'], h['ab'][v,A,c,V], t['ab'][pa,pV,ha,hA], optimize=True)
	X['aa'][pa,pv,hc,ha] += 1.0 * np.einsum('UV,aVuA,vAiU->vaiu', gamma1['b'], h['ab'][v,A,a,V], t['ab'][pa,pV,hc,hA], optimize=True)
	X['aa'][pa,pv,hc,ha] += -1.0 * np.einsum('ji,uajv->uaiv', h['a'][c,c], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += -1.0 * np.einsum('ju,vaij->vaiu', h['a'][c,a], t['aa'][pa,pv,hc,hc], optimize=True)
	X['aa'][pa,pv,hc,ha] += 0.5 * np.einsum('jkiu,vajk->vaiu', h['aa'][c,c,c,a], t['aa'][pa,pv,hc,hc], optimize=True)
	X['aa'][pa,pv,hc,ha] += 1.0 * np.einsum('juib,abjv->uaiv', h['aa'][c,a,c,v], t['aa'][pv,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += 1.0 * np.einsum('juvb,abij->uaiv', h['aa'][c,a,a,v], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pa,pv,hc,ha] += -1.0 * np.einsum('jaib,ubjv->uaiv', h['aa'][c,v,c,v], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += -1.0 * np.einsum('jaub,vbij->vaiu', h['aa'][c,v,a,v], t['aa'][pa,pv,hc,hc], optimize=True)
	X['aa'][pa,pv,hc,ha] += -1.0 * np.einsum('ub,abiv->uaiv', h['a'][a,v], t['aa'][pv,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += 0.5 * np.einsum('uabc,bciv->uaiv', h['aa'][a,v,v,v], t['aa'][pv,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += 1.0 * np.einsum('uIiA,aAvI->uaiv', h['ab'][a,C,c,V], t['ab'][pv,pV,ha,hC], optimize=True)
	X['aa'][pa,pv,hc,ha] += -1.0 * np.einsum('uIvA,aAiI->uaiv', h['ab'][a,C,a,V], t['ab'][pv,pV,hc,hC], optimize=True)
	X['aa'][pa,pv,hc,ha] += 1.0 * np.einsum('ab,ubiv->uaiv', h['a'][v,v], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += -1.0 * np.einsum('aIiA,uAvI->uaiv', h['ab'][v,C,c,V], t['ab'][pa,pV,ha,hC], optimize=True)
	X['aa'][pa,pv,hc,ha] += 1.0 * np.einsum('aIuA,vAiI->vaiu', h['ab'][v,C,a,V], t['ab'][pa,pV,hc,hC], optimize=True)
	# ca|vv
	X['aa'][pv,pv,hc,ha] += -0.25 * np.einsum('vw,xy,wyiu,abvx->abiu', eta1['a'], eta1['a'], h['aa'][a,a,c,a], t['aa'][pv,pv,ha,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += 0.25 * np.einsum('vw,xy,abvx,wyiu->abiu', eta1['a'], eta1['a'], h['aa'][v,v,a,a], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += -1.0 * np.einsum('vw,xy,waix,ybuv->abiu', eta1['a'], gamma1['a'], h['aa'][a,v,c,a], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += 1.0 * np.einsum('vw,xy,waux,ybiv->abiu', eta1['a'], gamma1['a'], h['aa'][a,v,a,a], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += 1.0 * np.einsum('vw,xy,yaiv,wbux->abiu', eta1['a'], gamma1['a'], h['aa'][a,v,c,a], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += -1.0 * np.einsum('vw,xy,yauv,wbix->abiu', eta1['a'], gamma1['a'], h['aa'][a,v,a,a], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += -1.0 * np.einsum('vw,jaiv,wbju->abiu', eta1['a'], h['aa'][c,v,c,a], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += -1.0 * np.einsum('vw,jauv,wbij->abiu', eta1['a'], h['aa'][c,v,a,a], t['aa'][pa,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,ha] += 0.5 * np.einsum('vw,wi,abuv->abiu', eta1['a'], h['a'][a,c], t['aa'][pv,pv,ha,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += -0.5 * np.einsum('vw,wu,abiv->abiu', eta1['a'], h['a'][a,a], t['aa'][pv,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += 1.0 * np.einsum('vw,av,wbiu->abiu', eta1['a'], h['a'][v,a], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += 0.5 * np.einsum('vw,abvc,wciu->abiu', eta1['a'], h['aa'][v,v,a,v], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += -1.0 * np.einsum('UV,WX,aViW,bXuU->abiu', eta1['b'], gamma1['b'], h['ab'][v,A,c,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['aa'][pv,pv,hc,ha] += 1.0 * np.einsum('UV,WX,aVuW,bXiU->abiu', eta1['b'], gamma1['b'], h['ab'][v,A,a,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['aa'][pv,pv,hc,ha] += 1.0 * np.einsum('UV,WX,aXiU,bVuW->abiu', eta1['b'], gamma1['b'], h['ab'][v,A,c,A], t['ab'][pv,pA,ha,hA], optimize=True)
	X['aa'][pv,pv,hc,ha] += -1.0 * np.einsum('UV,WX,aXuU,bViW->abiu', eta1['b'], gamma1['b'], h['ab'][v,A,a,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['aa'][pv,pv,hc,ha] += 1.0 * np.einsum('UV,aIiU,bVuI->abiu', eta1['b'], h['ab'][v,C,c,A], t['ab'][pv,pA,ha,hC], optimize=True)
	X['aa'][pv,pv,hc,ha] += -1.0 * np.einsum('UV,aIuU,bViI->abiu', eta1['b'], h['ab'][v,C,a,A], t['ab'][pv,pA,hc,hC], optimize=True)
	X['aa'][pv,pv,hc,ha] += 0.25 * np.einsum('vw,xy,wyiu,abvx->abiu', gamma1['a'], gamma1['a'], h['aa'][a,a,c,a], t['aa'][pv,pv,ha,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += -0.25 * np.einsum('vw,xy,abvx,wyiu->abiu', gamma1['a'], gamma1['a'], h['aa'][v,v,a,a], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += 0.5 * np.einsum('vw,jwiu,abjv->abiu', gamma1['a'], h['aa'][c,a,c,a], t['aa'][pv,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += 0.5 * np.einsum('vw,wi,abuv->abiu', gamma1['a'], h['a'][a,c], t['aa'][pv,pv,ha,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += -0.5 * np.einsum('vw,wu,abiv->abiu', gamma1['a'], h['a'][a,a], t['aa'][pv,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += -1.0 * np.einsum('vw,waic,bcuv->abiu', gamma1['a'], h['aa'][a,v,c,v], t['aa'][pv,pv,ha,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += 1.0 * np.einsum('vw,wauc,bciv->abiu', gamma1['a'], h['aa'][a,v,a,v], t['aa'][pv,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += 1.0 * np.einsum('vw,av,wbiu->abiu', gamma1['a'], h['a'][v,a], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += 1.0 * np.einsum('UV,aViA,bAuU->abiu', gamma1['b'], h['ab'][v,A,c,V], t['ab'][pv,pV,ha,hA], optimize=True)
	X['aa'][pv,pv,hc,ha] += -1.0 * np.einsum('UV,aVuA,bAiU->abiu', gamma1['b'], h['ab'][v,A,a,V], t['ab'][pv,pV,hc,hA], optimize=True)
	X['aa'][pv,pv,hc,ha] += -0.5 * np.einsum('ji,abju->abiu', h['a'][c,c], t['aa'][pv,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += -0.5 * np.einsum('ju,abij->abiu', h['a'][c,a], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,ha] += 0.25 * np.einsum('jkiu,abjk->abiu', h['aa'][c,c,c,a], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,ha] += 1.0 * np.einsum('jaic,bcju->abiu', h['aa'][c,v,c,v], t['aa'][pv,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += 1.0 * np.einsum('jauc,bcij->abiu', h['aa'][c,v,a,v], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,ha] += -1.0 * np.einsum('ac,bciu->abiu', h['a'][v,v], t['aa'][pv,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += 0.25 * np.einsum('abcd,cdiu->abiu', h['aa'][v,v,v,v], t['aa'][pv,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += 1.0 * np.einsum('aIiA,bAuI->abiu', h['ab'][v,C,c,V], t['ab'][pv,pV,ha,hC], optimize=True)
	X['aa'][pv,pv,hc,ha] += -1.0 * np.einsum('aIuA,bAiI->abiu', h['ab'][v,C,a,V], t['ab'][pv,pV,hc,hC], optimize=True)
	# cc|aa
	X['aa'][pa,pa,hc,hc] += 0.125 * np.einsum('wx,yz,uvwy,xzij->uvij', eta1['a'], eta1['a'], h['aa'][a,a,a,a], t['aa'][pa,pa,hc,hc], optimize=True)
	X['aa'][pa,pa,hc,hc] += -1.0 * np.einsum('wx,yz,uxiy,vzjw->uvij', eta1['a'], gamma1['a'], h['aa'][a,a,c,a], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pa,hc,hc] += 1.0 * np.einsum('wx,yz,uziw,vxjy->uvij', eta1['a'], gamma1['a'], h['aa'][a,a,c,a], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pa,hc,hc] += -1.0 * np.einsum('wx,kuiw,vxjk->uvij', eta1['a'], h['aa'][c,a,c,a], t['aa'][pa,pa,hc,hc], optimize=True)
	X['aa'][pa,pa,hc,hc] += -0.5 * np.einsum('wx,uw,vxij->uvij', eta1['a'], h['a'][a,a], t['aa'][pa,pa,hc,hc], optimize=True)
	X['aa'][pa,pa,hc,hc] += 0.25 * np.einsum('wx,uvwa,xaij->uvij', eta1['a'], h['aa'][a,a,a,v], t['aa'][pa,pv,hc,hc], optimize=True)
	X['aa'][pa,pa,hc,hc] += 0.5 * np.einsum('wx,xi,uvjw->uvij', eta1['a'], h['a'][a,c], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pa,hc,hc] += -1.0 * np.einsum('UV,WX,uViW,vXjU->uvij', eta1['b'], gamma1['b'], h['ab'][a,A,c,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['aa'][pa,pa,hc,hc] += 1.0 * np.einsum('UV,WX,uXiU,vVjW->uvij', eta1['b'], gamma1['b'], h['ab'][a,A,c,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['aa'][pa,pa,hc,hc] += 1.0 * np.einsum('UV,uIiU,vVjI->uvij', eta1['b'], h['ab'][a,C,c,A], t['ab'][pa,pA,hc,hC], optimize=True)
	X['aa'][pa,pa,hc,hc] += -0.125 * np.einsum('wx,yz,uvwy,xzij->uvij', gamma1['a'], gamma1['a'], h['aa'][a,a,a,a], t['aa'][pa,pa,hc,hc], optimize=True)
	X['aa'][pa,pa,hc,hc] += 0.25 * np.einsum('wx,kxij,uvkw->uvij', gamma1['a'], h['aa'][c,a,c,c], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pa,hc,hc] += -0.5 * np.einsum('wx,uw,vxij->uvij', gamma1['a'], h['a'][a,a], t['aa'][pa,pa,hc,hc], optimize=True)
	X['aa'][pa,pa,hc,hc] += 1.0 * np.einsum('wx,uxia,vajw->uvij', gamma1['a'], h['aa'][a,a,c,v], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pa,pa,hc,hc] += 0.5 * np.einsum('wx,xi,uvjw->uvij', gamma1['a'], h['a'][a,c], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pa,hc,hc] += 1.0 * np.einsum('UV,uViA,vAjU->uvij', gamma1['b'], h['ab'][a,A,c,V], t['ab'][pa,pV,hc,hA], optimize=True)
	X['aa'][pa,pa,hc,hc] += 0.5 * np.einsum('ki,uvjk->uvij', h['a'][c,c], t['aa'][pa,pa,hc,hc], optimize=True)
	X['aa'][pa,pa,hc,hc] += 0.125 * np.einsum('klij,uvkl->uvij', h['aa'][c,c,c,c], t['aa'][pa,pa,hc,hc], optimize=True)
	X['aa'][pa,pa,hc,hc] += -1.0 * np.einsum('kuia,vajk->uvij', h['aa'][c,a,c,v], t['aa'][pa,pv,hc,hc], optimize=True)
	X['aa'][pa,pa,hc,hc] += -0.5 * np.einsum('ua,vaij->uvij', h['a'][a,v], t['aa'][pa,pv,hc,hc], optimize=True)
	X['aa'][pa,pa,hc,hc] += 0.125 * np.einsum('uvab,abij->uvij', h['aa'][a,a,v,v], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pa,pa,hc,hc] += 1.0 * np.einsum('uIiA,vAjI->uvij', h['ab'][a,C,c,V], t['ab'][pa,pV,hc,hC], optimize=True)
	# cc|va
	X['aa'][pa,pv,hc,hc] += 0.25 * np.einsum('vw,xy,uavx,wyij->uaij', eta1['a'], eta1['a'], h['aa'][a,v,a,a], t['aa'][pa,pa,hc,hc], optimize=True)
	X['aa'][pa,pv,hc,hc] += -0.25 * np.einsum('vw,xy,wyij,uavx->uaij', eta1['a'], eta1['a'], h['aa'][a,a,c,c], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pa,pv,hc,hc] += 1.0 * np.einsum('vw,xy,uwix,yajv->uaij', eta1['a'], gamma1['a'], h['aa'][a,a,c,a], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,hc] += -1.0 * np.einsum('vw,xy,uyiv,wajx->uaij', eta1['a'], gamma1['a'], h['aa'][a,a,c,a], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,hc] += -1.0 * np.einsum('vw,xy,waix,uyjv->uaij', eta1['a'], gamma1['a'], h['aa'][a,v,c,a], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,hc] += 1.0 * np.einsum('vw,xy,yaiv,uwjx->uaij', eta1['a'], gamma1['a'], h['aa'][a,v,c,a], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,hc] += 1.0 * np.einsum('vw,kuiv,wajk->uaij', eta1['a'], h['aa'][c,a,c,a], t['aa'][pa,pv,hc,hc], optimize=True)
	X['aa'][pa,pv,hc,hc] += 1.0 * np.einsum('vw,kaiv,uwjk->uaij', eta1['a'], h['aa'][c,v,c,a], t['aa'][pa,pa,hc,hc], optimize=True)
	X['aa'][pa,pv,hc,hc] += 0.5 * np.einsum('vw,uv,waij->uaij', eta1['a'], h['a'][a,a], t['aa'][pa,pv,hc,hc], optimize=True)
	X['aa'][pa,pv,hc,hc] += 0.5 * np.einsum('vw,uavb,wbij->uaij', eta1['a'], h['aa'][a,v,a,v], t['aa'][pa,pv,hc,hc], optimize=True)
	X['aa'][pa,pv,hc,hc] += 1.0 * np.einsum('vw,wi,uajv->uaij', eta1['a'], h['a'][a,c], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,hc] += 0.5 * np.einsum('vw,av,uwij->uaij', eta1['a'], h['a'][v,a], t['aa'][pa,pa,hc,hc], optimize=True)
	X['aa'][pa,pv,hc,hc] += -1.0 * np.einsum('UV,WX,uViW,aXjU->uaij', eta1['b'], gamma1['b'], h['ab'][a,A,c,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['aa'][pa,pv,hc,hc] += 1.0 * np.einsum('UV,WX,uXiU,aVjW->uaij', eta1['b'], gamma1['b'], h['ab'][a,A,c,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['aa'][pa,pv,hc,hc] += 1.0 * np.einsum('UV,WX,aViW,uXjU->uaij', eta1['b'], gamma1['b'], h['ab'][v,A,c,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['aa'][pa,pv,hc,hc] += -1.0 * np.einsum('UV,WX,aXiU,uVjW->uaij', eta1['b'], gamma1['b'], h['ab'][v,A,c,A], t['ab'][pa,pA,hc,hA], optimize=True)
	X['aa'][pa,pv,hc,hc] += 1.0 * np.einsum('UV,uIiU,aVjI->uaij', eta1['b'], h['ab'][a,C,c,A], t['ab'][pv,pA,hc,hC], optimize=True)
	X['aa'][pa,pv,hc,hc] += -1.0 * np.einsum('UV,aIiU,uVjI->uaij', eta1['b'], h['ab'][v,C,c,A], t['ab'][pa,pA,hc,hC], optimize=True)
	X['aa'][pa,pv,hc,hc] += -0.25 * np.einsum('vw,xy,uavx,wyij->uaij', gamma1['a'], gamma1['a'], h['aa'][a,v,a,a], t['aa'][pa,pa,hc,hc], optimize=True)
	X['aa'][pa,pv,hc,hc] += 0.25 * np.einsum('vw,xy,wyij,uavx->uaij', gamma1['a'], gamma1['a'], h['aa'][a,a,c,c], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pa,pv,hc,hc] += 0.5 * np.einsum('vw,kwij,uakv->uaij', gamma1['a'], h['aa'][c,a,c,c], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,hc] += 0.5 * np.einsum('vw,uv,waij->uaij', gamma1['a'], h['a'][a,a], t['aa'][pa,pv,hc,hc], optimize=True)
	X['aa'][pa,pv,hc,hc] += 1.0 * np.einsum('vw,uwib,abjv->uaij', gamma1['a'], h['aa'][a,a,c,v], t['aa'][pv,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,hc] += 1.0 * np.einsum('vw,wi,uajv->uaij', gamma1['a'], h['a'][a,c], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,hc] += 1.0 * np.einsum('vw,waib,ubjv->uaij', gamma1['a'], h['aa'][a,v,c,v], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,hc] += 0.5 * np.einsum('vw,av,uwij->uaij', gamma1['a'], h['a'][v,a], t['aa'][pa,pa,hc,hc], optimize=True)
	X['aa'][pa,pv,hc,hc] += 1.0 * np.einsum('UV,uViA,aAjU->uaij', gamma1['b'], h['ab'][a,A,c,V], t['ab'][pv,pV,hc,hA], optimize=True)
	X['aa'][pa,pv,hc,hc] += -1.0 * np.einsum('UV,aViA,uAjU->uaij', gamma1['b'], h['ab'][v,A,c,V], t['ab'][pa,pV,hc,hA], optimize=True)
	X['aa'][pa,pv,hc,hc] += 1.0 * np.einsum('ki,uajk->uaij', h['a'][c,c], t['aa'][pa,pv,hc,hc], optimize=True)
	X['aa'][pa,pv,hc,hc] += 0.25 * np.einsum('klij,uakl->uaij', h['aa'][c,c,c,c], t['aa'][pa,pv,hc,hc], optimize=True)
	X['aa'][pa,pv,hc,hc] += -1.0 * np.einsum('kuib,abjk->uaij', h['aa'][c,a,c,v], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pa,pv,hc,hc] += 1.0 * np.einsum('kaib,ubjk->uaij', h['aa'][c,v,c,v], t['aa'][pa,pv,hc,hc], optimize=True)
	X['aa'][pa,pv,hc,hc] += -0.5 * np.einsum('ub,abij->uaij', h['a'][a,v], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pa,pv,hc,hc] += 0.25 * np.einsum('uabc,bcij->uaij', h['aa'][a,v,v,v], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pa,pv,hc,hc] += 1.0 * np.einsum('uIiA,aAjI->uaij', h['ab'][a,C,c,V], t['ab'][pv,pV,hc,hC], optimize=True)
	X['aa'][pa,pv,hc,hc] += 0.5 * np.einsum('ab,ubij->uaij', h['a'][v,v], t['aa'][pa,pv,hc,hc], optimize=True)
	X['aa'][pa,pv,hc,hc] += -1.0 * np.einsum('aIiA,uAjI->uaij', h['ab'][v,C,c,V], t['ab'][pa,pV,hc,hC], optimize=True)
	# cc|vv
	X['aa'][pv,pv,hc,hc] += -0.125 * np.einsum('uv,wx,vxij,abuw->abij', eta1['a'], eta1['a'], h['aa'][a,a,c,c], t['aa'][pv,pv,ha,ha], optimize=True)
	X['aa'][pv,pv,hc,hc] += 0.125 * np.einsum('uv,wx,abuw,vxij->abij', eta1['a'], eta1['a'], h['aa'][v,v,a,a], t['aa'][pa,pa,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += -1.0 * np.einsum('uv,wx,vaiw,xbju->abij', eta1['a'], gamma1['a'], h['aa'][a,v,c,a], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,hc] += 1.0 * np.einsum('uv,wx,xaiu,vbjw->abij', eta1['a'], gamma1['a'], h['aa'][a,v,c,a], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,hc] += 1.0 * np.einsum('uv,kaiu,vbjk->abij', eta1['a'], h['aa'][c,v,c,a], t['aa'][pa,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += 0.5 * np.einsum('uv,vi,abju->abij', eta1['a'], h['a'][a,c], t['aa'][pv,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,hc] += 0.5 * np.einsum('uv,au,vbij->abij', eta1['a'], h['a'][v,a], t['aa'][pa,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += 0.25 * np.einsum('uv,abuc,vcij->abij', eta1['a'], h['aa'][v,v,a,v], t['aa'][pa,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += -1.0 * np.einsum('UV,WX,aViW,bXjU->abij', eta1['b'], gamma1['b'], h['ab'][v,A,c,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['aa'][pv,pv,hc,hc] += 1.0 * np.einsum('UV,WX,aXiU,bVjW->abij', eta1['b'], gamma1['b'], h['ab'][v,A,c,A], t['ab'][pv,pA,hc,hA], optimize=True)
	X['aa'][pv,pv,hc,hc] += 1.0 * np.einsum('UV,aIiU,bVjI->abij', eta1['b'], h['ab'][v,C,c,A], t['ab'][pv,pA,hc,hC], optimize=True)
	X['aa'][pv,pv,hc,hc] += 0.125 * np.einsum('uv,wx,vxij,abuw->abij', gamma1['a'], gamma1['a'], h['aa'][a,a,c,c], t['aa'][pv,pv,ha,ha], optimize=True)
	X['aa'][pv,pv,hc,hc] += -0.125 * np.einsum('uv,wx,abuw,vxij->abij', gamma1['a'], gamma1['a'], h['aa'][v,v,a,a], t['aa'][pa,pa,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += 0.25 * np.einsum('uv,kvij,abku->abij', gamma1['a'], h['aa'][c,a,c,c], t['aa'][pv,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,hc] += 0.5 * np.einsum('uv,vi,abju->abij', gamma1['a'], h['a'][a,c], t['aa'][pv,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,hc] += -1.0 * np.einsum('uv,vaic,bcju->abij', gamma1['a'], h['aa'][a,v,c,v], t['aa'][pv,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,hc] += 0.5 * np.einsum('uv,au,vbij->abij', gamma1['a'], h['a'][v,a], t['aa'][pa,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += 1.0 * np.einsum('UV,aViA,bAjU->abij', gamma1['b'], h['ab'][v,A,c,V], t['ab'][pv,pV,hc,hA], optimize=True)
	X['aa'][pv,pv,hc,hc] += 0.5 * np.einsum('ki,abjk->abij', h['a'][c,c], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += 0.125 * np.einsum('klij,abkl->abij', h['aa'][c,c,c,c], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += -1.0 * np.einsum('kaic,bcjk->abij', h['aa'][c,v,c,v], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += -0.5 * np.einsum('ac,bcij->abij', h['a'][v,v], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += 0.125 * np.einsum('abcd,cdij->abij', h['aa'][v,v,v,v], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += 1.0 * np.einsum('aIiA,bAjI->abij', h['ab'][v,C,c,V], t['ab'][pv,pV,hc,hC], optimize=True)
	toc = time.time()
	elapsed_time = toc - tic
	if verbose:
		print(f'Took {elapsed_time} seconds.')
	return X


def H_T_ncomm2_nbody0(X, h, t, gamma1, eta1, lambdas, orbspace, verbose=False):
	tic = time.time()
	c = orbspace['core_alpha']
	C = orbspace['core_beta']
	a = orbspace['active_alpha']
	A = orbspace['active_beta']
	v = orbspace['virt_alpha']
	V = orbspace['virt_beta']
	hc = orbspace['hole_core_alpha']
	hC = orbspace['hole_core_beta']
	ha = orbspace['hole_active_alpha']
	hA = orbspace['hole_active_beta']
	pa = orbspace['particle_active_alpha']
	pA = orbspace['particle_active_beta']
	pv = orbspace['particle_virt_alpha']
	pV = orbspace['particle_virt_beta']

	# |
	X['0'] += 0.125 * np.einsum('uv,wx,yz,ijya,zauw,vxij->', eta1['a'], eta1['a'], eta1['a'], h['aa'][c,c,a,v], t['aa'][pa,pv,ha,ha], t['aa'][pa,pa,hc,hc], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,wx,yz,ijwa,vajy,xziu->', eta1['a'], eta1['a'], gamma1['a'], h['aa'][c,c,a,v], t['aa'][pa,pv,hc,ha], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,wx,yz,ijwa,zaiu,vxjy->', eta1['a'], eta1['a'], gamma1['a'], h['aa'][c,c,a,v], t['aa'][pa,pv,hc,ha], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += 0.125 * np.einsum('uv,wx,yz,izab,abuw,vxiy->', eta1['a'], eta1['a'], gamma1['a'], h['aa'][c,a,v,v], t['aa'][pv,pv,ha,ha], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += 0.5 * np.einsum('uv,wx,yz,iIwA,vAyI,xziu->', eta1['a'], eta1['a'], gamma1['a'], h['ab'][c,C,a,V], t['ab'][pa,pV,ha,hC], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,wx,yz,iIwA,zAuI,vxiy->', eta1['a'], eta1['a'], gamma1['a'], h['ab'][c,C,a,V], t['ab'][pa,pV,ha,hC], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,wx,UV,iIwA,vAiU,xVuI->', eta1['a'], eta1['a'], gamma1['b'], h['ab'][c,C,a,V], t['ab'][pa,pV,hc,hA], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += 0.0625 * np.einsum('uv,wx,ijab,abuw,vxij->', eta1['a'], eta1['a'], h['aa'][c,c,v,v], t['aa'][pv,pv,ha,ha], t['aa'][pa,pa,hc,hc], optimize=True)
	X['0'] += 0.125 * np.einsum('uv,wx,yz,ijua,vawy,xzij->', eta1['a'], gamma1['a'], gamma1['a'], h['aa'][c,c,a,v], t['aa'][pa,pv,ha,ha], t['aa'][pa,pa,hc,hc], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,wx,yz,izab,vbwy,xaiu->', eta1['a'], gamma1['a'], gamma1['a'], h['aa'][c,a,v,v], t['aa'][pa,pv,ha,ha], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += 0.5 * np.einsum('uv,wx,yz,izab,xauy,vbiw->', eta1['a'], gamma1['a'], gamma1['a'], h['aa'][c,a,v,v], t['aa'][pa,pv,ha,ha], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += 0.5 * np.einsum('uv,wx,yz,zIaA,vAwI,xauy->', eta1['a'], gamma1['a'], gamma1['a'], h['ab'][a,C,v,V], t['ab'][pa,pV,ha,hC], t['aa'][pa,pv,ha,ha], optimize=True)
	X['0'] += 0.5 * np.einsum('uv,wx,yz,zIaA,xAuI,vawy->', eta1['a'], gamma1['a'], gamma1['a'], h['ab'][a,C,v,V], t['ab'][pa,pV,ha,hC], t['aa'][pa,pv,ha,ha], optimize=True)
	X['0'] += 0.5 * np.einsum('uv,wx,ijab,xaiu,vbjw->', eta1['a'], gamma1['a'], h['aa'][c,c,v,v], t['aa'][pa,pv,hc,ha], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,wx,iIaA,vAwI,xaiu->', eta1['a'], gamma1['a'], h['ab'][c,C,v,V], t['ab'][pa,pV,ha,hC], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,wx,iIaA,xAuI,vaiw->', eta1['a'], gamma1['a'], h['ab'][c,C,v,V], t['ab'][pa,pV,ha,hC], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += 0.5 * np.einsum('uv,wx,IJAB,xAuI,vBwJ->', eta1['a'], gamma1['a'], h['bb'][C,C,V,V], t['ab'][pa,pV,ha,hC], t['ab'][pa,pV,ha,hC], optimize=True)
	X['0'] += 0.5 * np.einsum('uv,UV,wx,iIuA,vAwU,xViI->', eta1['a'], gamma1['b'], gamma1['a'], h['ab'][c,C,a,V], t['ab'][pa,pV,ha,hA], t['ab'][pa,pA,hc,hC], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,UV,wx,iVaA,vAwU,xaiu->', eta1['a'], gamma1['b'], gamma1['a'], h['ab'][c,A,v,V], t['ab'][pa,pV,ha,hA], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,UV,wx,iVaA,xAuU,vaiw->', eta1['a'], gamma1['b'], gamma1['a'], h['ab'][c,A,v,V], t['ab'][pa,pV,ha,hA], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,UV,wx,xIaA,aVuI,vAwU->', eta1['a'], gamma1['b'], gamma1['a'], h['ab'][a,C,v,V], t['ab'][pv,pA,ha,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('uv,UV,wx,IVAB,vBwU,xAuI->', eta1['a'], gamma1['b'], gamma1['a'], h['bb'][C,A,V,V], t['ab'][pa,pV,ha,hA], t['ab'][pa,pV,ha,hC], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,UV,wx,IVAB,xAuU,vBwI->', eta1['a'], gamma1['b'], gamma1['a'], h['bb'][C,A,V,V], t['ab'][pa,pV,ha,hA], t['ab'][pa,pV,ha,hC], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,UV,WX,iXaA,aVuW,vAiU->', eta1['a'], gamma1['b'], gamma1['b'], h['ab'][c,A,v,V], t['ab'][pv,pA,ha,hA], t['ab'][pa,pV,hc,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,UV,iIaA,aVuI,vAiU->', eta1['a'], gamma1['b'], h['ab'][c,C,v,V], t['ab'][pv,pA,ha,hC], t['ab'][pa,pV,hc,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('uv,ijua,wxyz,vaix,yzjw->', eta1['a'], h['aa'][c,c,a,v], lambdas['aa'], t['aa'][pa,pv,hc,ha], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += 0.125 * np.einsum('uv,ijua,wxyz,vawx,yzij->', eta1['a'], h['aa'][c,c,a,v], lambdas['aa'], t['aa'][pa,pv,ha,ha], t['aa'][pa,pa,hc,hc], optimize=True)
	X['0'] += -1.0 * np.einsum('uv,ijua,wxyz,yaix,vzjw->', eta1['a'], h['aa'][c,c,a,v], lambdas['aa'], t['aa'][pa,pv,hc,ha], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += -0.25 * np.einsum('uv,ijua,wxyz,yawx,vzij->', eta1['a'], h['aa'][c,c,a,v], lambdas['aa'], t['aa'][pa,pv,ha,ha], t['aa'][pa,pa,hc,hc], optimize=True)
	X['0'] += -1.0 * np.einsum('uv,ijua,wUxV,vViU,xajw->', eta1['a'], h['aa'][c,c,a,v], lambdas['ab'], t['ab'][pa,pA,hc,hA], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += 1.0 * np.einsum('uv,ijua,wUxV,xViU,vajw->', eta1['a'], h['aa'][c,c,a,v], lambdas['ab'], t['ab'][pa,pA,hc,hA], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += -1.0 * np.einsum('uv,ijua,wUxV,aViU,vxjw->', eta1['a'], h['aa'][c,c,a,v], lambdas['ab'], t['ab'][pv,pA,hc,hA], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,ijua,wUxV,aVwU,vxij->', eta1['a'], h['aa'][c,c,a,v], lambdas['ab'], t['ab'][pv,pA,ha,hA], t['aa'][pa,pa,hc,hc], optimize=True)
	X['0'] += 1.0 * np.einsum('uv,ijua,UVWX,aWiV,vXjU->', eta1['a'], h['aa'][c,c,a,v], lambdas['bb'], t['ab'][pv,pA,hc,hA], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += 0.25 * np.einsum('uv,ijwa,wxyz,vajx,yziu->', eta1['a'], h['aa'][c,c,a,v], lambdas['aa'], t['aa'][pa,pv,hc,ha], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,ijwa,wxyz,yaiu,vzjx->', eta1['a'], h['aa'][c,c,a,v], lambdas['aa'], t['aa'][pa,pv,hc,ha], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += 0.25 * np.einsum('uv,ijwa,wxyz,yaux,vzij->', eta1['a'], h['aa'][c,c,a,v], lambdas['aa'], t['aa'][pa,pv,ha,ha], t['aa'][pa,pa,hc,hc], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,ijwa,wUxV,vVjU,xaiu->', eta1['a'], h['aa'][c,c,a,v], lambdas['ab'], t['ab'][pa,pA,hc,hA], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += 0.25 * np.einsum('uv,ijwa,wUxV,aVuU,vxij->', eta1['a'], h['aa'][c,c,a,v], lambdas['ab'], t['ab'][pv,pA,ha,hA], t['aa'][pa,pa,hc,hc], optimize=True)
	X['0'] += 0.25 * np.einsum('uv,iwab,xywz,vbxy,zaiu->', eta1['a'], h['aa'][c,a,v,v], lambdas['aa'], t['aa'][pa,pv,ha,ha], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,iwab,xywz,zauy,vbix->', eta1['a'], h['aa'][c,a,v,v], lambdas['aa'], t['aa'][pa,pv,ha,ha], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += -0.25 * np.einsum('uv,iwab,xywz,abuy,vzix->', eta1['a'], h['aa'][c,a,v,v], lambdas['aa'], t['aa'][pv,pv,ha,ha], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += 0.25 * np.einsum('uv,iwab,xUwV,abux,vViU->', eta1['a'], h['aa'][c,a,v,v], lambdas['ab'], t['aa'][pv,pv,ha,ha], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('uv,iwab,xUwV,aVuU,vbix->', eta1['a'], h['aa'][c,a,v,v], lambdas['ab'], t['ab'][pv,pA,ha,hA], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += 0.5 * np.einsum('uv,iIuA,wxyz,vAxI,yziw->', eta1['a'], h['ab'][c,C,a,V], lambdas['aa'], t['ab'][pa,pV,ha,hC], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += -1.0 * np.einsum('uv,iIuA,wxyz,yAxI,vziw->', eta1['a'], h['ab'][c,C,a,V], lambdas['aa'], t['ab'][pa,pV,ha,hC], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += -1.0 * np.einsum('uv,iIuA,wUxV,vAiU,xVwI->', eta1['a'], h['ab'][c,C,a,V], lambdas['ab'], t['ab'][pa,pV,hc,hA], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += -1.0 * np.einsum('uv,iIuA,wUxV,vAwI,xViU->', eta1['a'], h['ab'][c,C,a,V], lambdas['ab'], t['ab'][pa,pV,ha,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += 1.0 * np.einsum('uv,iIuA,wUxV,vAwU,xViI->', eta1['a'], h['ab'][c,C,a,V], lambdas['ab'], t['ab'][pa,pV,ha,hA], t['ab'][pa,pA,hc,hC], optimize=True)
	X['0'] += 1.0 * np.einsum('uv,iIuA,wUxV,xAiU,vVwI->', eta1['a'], h['ab'][c,C,a,V], lambdas['ab'], t['ab'][pa,pV,hc,hA], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += 1.0 * np.einsum('uv,iIuA,wUxV,xAwI,vViU->', eta1['a'], h['ab'][c,C,a,V], lambdas['ab'], t['ab'][pa,pV,ha,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += -1.0 * np.einsum('uv,iIuA,wUxV,xAwU,vViI->', eta1['a'], h['ab'][c,C,a,V], lambdas['ab'], t['ab'][pa,pV,ha,hA], t['ab'][pa,pA,hc,hC], optimize=True)
	X['0'] += -1.0 * np.einsum('uv,iIuA,wUxV,VAIU,vxiw->', eta1['a'], h['ab'][c,C,a,V], lambdas['ab'], t['bb'][pA,pV,hC,hA], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,iIuA,UVWX,WXIV,vAiU->', eta1['a'], h['ab'][c,C,a,V], lambdas['bb'], t['bb'][pA,pA,hC,hA], t['ab'][pa,pV,hc,hA], optimize=True)
	X['0'] += 1.0 * np.einsum('uv,iIuA,UVWX,WAIV,vXiU->', eta1['a'], h['ab'][c,C,a,V], lambdas['bb'], t['bb'][pA,pV,hC,hA], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,iIuA,UVWX,WAUV,vXiI->', eta1['a'], h['ab'][c,C,a,V], lambdas['bb'], t['bb'][pA,pV,hA,hA], t['ab'][pa,pA,hc,hC], optimize=True)
	X['0'] += -0.25 * np.einsum('uv,iIwA,wxyz,vAxI,yziu->', eta1['a'], h['ab'][c,C,a,V], lambdas['aa'], t['ab'][pa,pV,ha,hC], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,iIwA,wxyz,yAuI,vzix->', eta1['a'], h['ab'][c,C,a,V], lambdas['aa'], t['ab'][pa,pV,ha,hC], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += 0.5 * np.einsum('uv,iIwA,wUxV,vAiU,xVuI->', eta1['a'], h['ab'][c,C,a,V], lambdas['ab'], t['ab'][pa,pV,hc,hA], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,iIwA,wUxV,xAuI,vViU->', eta1['a'], h['ab'][c,C,a,V], lambdas['ab'], t['ab'][pa,pV,ha,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('uv,iIwA,wUxV,xAuU,vViI->', eta1['a'], h['ab'][c,C,a,V], lambdas['ab'], t['ab'][pa,pV,ha,hA], t['ab'][pa,pA,hc,hC], optimize=True)
	X['0'] += 0.5 * np.einsum('uv,iIaU,wUxV,vViI,xauw->', eta1['a'], h['ab'][c,C,v,A], lambdas['ab'], t['ab'][pa,pA,hc,hC], t['aa'][pa,pv,ha,ha], optimize=True)
	X['0'] += 0.5 * np.einsum('uv,iIaU,wUxV,vVwI,xaiu->', eta1['a'], h['ab'][c,C,v,A], lambdas['ab'], t['ab'][pa,pA,ha,hC], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += 0.5 * np.einsum('uv,iIaU,wUxV,xVuI,vaiw->', eta1['a'], h['ab'][c,C,v,A], lambdas['ab'], t['ab'][pa,pA,ha,hC], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,iIaU,wUxV,aVuI,vxiw->', eta1['a'], h['ab'][c,C,v,A], lambdas['ab'], t['ab'][pv,pA,ha,hC], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,iIaU,UVWX,aWuI,vXiV->', eta1['a'], h['ab'][c,C,v,A], lambdas['bb'], t['ab'][pv,pA,ha,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('uv,iIaU,UVWX,aWuV,vXiI->', eta1['a'], h['ab'][c,C,v,A], lambdas['bb'], t['ab'][pv,pA,ha,hA], t['ab'][pa,pA,hc,hC], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,iUaA,wVxU,vAiV,xauw->', eta1['a'], h['ab'][c,A,v,V], lambdas['ab'], t['ab'][pa,pV,hc,hA], t['aa'][pa,pv,ha,ha], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,iUaA,wVxU,vAwV,xaiu->', eta1['a'], h['ab'][c,A,v,V], lambdas['ab'], t['ab'][pa,pV,ha,hA], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,iUaA,wVxU,xAuV,vaiw->', eta1['a'], h['ab'][c,A,v,V], lambdas['ab'], t['ab'][pa,pV,ha,hA], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += 0.5 * np.einsum('uv,iUaA,wVxU,aAuV,vxiw->', eta1['a'], h['ab'][c,A,v,V], lambdas['ab'], t['ab'][pv,pV,ha,hA], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += 0.5 * np.einsum('uv,iUaA,VWUX,aXuW,vAiV->', eta1['a'], h['ab'][c,A,v,V], lambdas['bb'], t['ab'][pv,pA,ha,hA], t['ab'][pa,pV,hc,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,iUaA,VWUX,aAuW,vXiV->', eta1['a'], h['ab'][c,A,v,V], lambdas['bb'], t['ab'][pv,pV,ha,hA], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,wIaA,xywz,vAxI,zauy->', eta1['a'], h['ab'][a,C,v,V], lambdas['aa'], t['ab'][pa,pV,ha,hC], t['aa'][pa,pv,ha,ha], optimize=True)
	X['0'] += -0.25 * np.einsum('uv,wIaA,xywz,zAuI,vaxy->', eta1['a'], h['ab'][a,C,v,V], lambdas['aa'], t['ab'][pa,pV,ha,hC], t['aa'][pa,pv,ha,ha], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,wIaA,xUwV,aVuI,vAxU->', eta1['a'], h['ab'][a,C,v,V], lambdas['ab'], t['ab'][pv,pA,ha,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('uv,wIaA,xUwV,aVuU,vAxI->', eta1['a'], h['ab'][a,C,v,V], lambdas['ab'], t['ab'][pv,pA,ha,hA], t['ab'][pa,pV,ha,hC], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,wIaA,xUwV,aAuU,vVxI->', eta1['a'], h['ab'][a,C,v,V], lambdas['ab'], t['ab'][pv,pV,ha,hA], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,IJUA,wUxV,vAwJ,xVuI->', eta1['a'], h['bb'][C,C,A,V], lambdas['ab'], t['ab'][pa,pV,ha,hC], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += 0.5 * np.einsum('uv,IJUA,wUxV,xAuI,vVwJ->', eta1['a'], h['bb'][C,C,A,V], lambdas['ab'], t['ab'][pa,pV,ha,hC], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += 0.5 * np.einsum('uv,IUAB,wVxU,vBwV,xAuI->', eta1['a'], h['bb'][C,A,V,V], lambdas['ab'], t['ab'][pa,pV,ha,hA], t['ab'][pa,pV,ha,hC], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,IUAB,wVxU,xAuV,vBwI->', eta1['a'], h['bb'][C,A,V,V], lambdas['ab'], t['ab'][pa,pV,ha,hA], t['ab'][pa,pV,ha,hC], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,uv,wx,iIwA,xAuU,vViI->', eta1['b'], eta1['a'], eta1['a'], h['ab'][c,C,a,V], t['ab'][pa,pV,ha,hA], t['ab'][pa,pA,hc,hC], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,uv,wx,iIuA,xAiU,vVwI->', eta1['b'], eta1['a'], gamma1['a'], h['ab'][c,C,a,V], t['ab'][pa,pV,hc,hA], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,uv,wx,iIaU,vVwI,xaiu->', eta1['b'], eta1['a'], gamma1['a'], h['ab'][c,C,v,A], t['ab'][pa,pA,ha,hC], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,uv,wx,iIaU,xVuI,vaiw->', eta1['b'], eta1['a'], gamma1['a'], h['ab'][c,C,v,A], t['ab'][pa,pA,ha,hC], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,uv,wx,xIaA,aAuU,vVwI->', eta1['b'], eta1['a'], gamma1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,ha,hA], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,uv,wx,IJUA,vAwJ,xVuI->', eta1['b'], eta1['a'], gamma1['a'], h['bb'][C,C,A,V], t['ab'][pa,pV,ha,hC], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,uv,wx,IJUA,xAuI,vVwJ->', eta1['b'], eta1['a'], gamma1['a'], h['bb'][C,C,A,V], t['ab'][pa,pV,ha,hC], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,uv,WX,ijua,aVjW,vXiU->', eta1['b'], eta1['a'], gamma1['b'], h['aa'][c,c,a,v], t['ab'][pv,pA,hc,hA], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,uv,WX,ijua,aXiU,vVjW->', eta1['b'], eta1['a'], gamma1['b'], h['aa'][c,c,a,v], t['ab'][pv,pA,hc,hA], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,uv,WX,iIuA,VAIW,vXiU->', eta1['b'], eta1['a'], gamma1['b'], h['ab'][c,C,a,V], t['bb'][pA,pV,hC,hA], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,uv,WX,iIuA,XAIU,vViW->', eta1['b'], eta1['a'], gamma1['b'], h['ab'][c,C,a,V], t['bb'][pA,pV,hC,hA], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,uv,WX,iIaU,aXuI,vViW->', eta1['b'], eta1['a'], gamma1['b'], h['ab'][c,C,v,A], t['ab'][pv,pA,ha,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,uv,WX,iXaA,aAuU,vViW->', eta1['b'], eta1['a'], gamma1['b'], h['ab'][c,A,v,V], t['ab'][pv,pV,ha,hA], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,uv,iIaA,aAuU,vViI->', eta1['b'], eta1['a'], h['ab'][c,C,v,V], t['ab'][pv,pV,ha,hA], t['ab'][pa,pA,hc,hC], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,WX,uv,iIaW,aXuU,vViI->', eta1['b'], eta1['b'], eta1['a'], h['ab'][c,C,v,A], t['ab'][pv,pA,ha,hA], t['ab'][pa,pA,hc,hC], optimize=True)
	X['0'] += 0.125 * np.einsum('UV,WX,YZ,IJYA,ZAUW,VXIJ->', eta1['b'], eta1['b'], eta1['b'], h['bb'][C,C,A,V], t['bb'][pA,pV,hA,hA], t['bb'][pA,pA,hC,hC], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,WX,uv,iIaW,aVuI,vXiU->', eta1['b'], eta1['b'], gamma1['a'], h['ab'][c,C,v,A], t['ab'][pv,pA,ha,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,WX,YZ,iIaW,VXIY,aZiU->', eta1['b'], eta1['b'], gamma1['b'], h['ab'][c,C,v,A], t['bb'][pA,pA,hC,hA], t['ab'][pv,pA,hc,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,WX,YZ,iIaW,XZIU,aViY->', eta1['b'], eta1['b'], gamma1['b'], h['ab'][c,C,v,A], t['bb'][pA,pA,hC,hA], t['ab'][pv,pA,hc,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,WX,YZ,IJWA,VAJY,XZIU->', eta1['b'], eta1['b'], gamma1['b'], h['bb'][C,C,A,V], t['bb'][pA,pV,hC,hA], t['bb'][pA,pA,hC,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,WX,YZ,IJWA,ZAIU,VXJY->', eta1['b'], eta1['b'], gamma1['b'], h['bb'][C,C,A,V], t['bb'][pA,pV,hC,hA], t['bb'][pA,pA,hC,hA], optimize=True)
	X['0'] += 0.125 * np.einsum('UV,WX,YZ,IZAB,ABUW,VXIY->', eta1['b'], eta1['b'], gamma1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hA,hA], t['bb'][pA,pA,hC,hA], optimize=True)
	X['0'] += 0.0625 * np.einsum('UV,WX,IJAB,ABUW,VXIJ->', eta1['b'], eta1['b'], h['bb'][C,C,V,V], t['bb'][pV,pV,hA,hA], t['bb'][pA,pA,hC,hC], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,uv,wx,xIaA,aVuI,vAwU->', eta1['b'], gamma1['a'], gamma1['a'], h['ab'][a,C,v,V], t['ab'][pv,pA,ha,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,uv,iIaA,aVuI,vAiU->', eta1['b'], gamma1['a'], h['ab'][c,C,v,V], t['ab'][pv,pA,ha,hC], t['ab'][pa,pV,hc,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,WX,uv,ivab,aXuU,bViW->', eta1['b'], gamma1['b'], gamma1['a'], h['aa'][c,a,v,v], t['ab'][pv,pA,ha,hA], t['ab'][pv,pA,hc,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,WX,uv,ivab,bVuW,aXiU->', eta1['b'], gamma1['b'], gamma1['a'], h['aa'][c,a,v,v], t['ab'][pv,pA,ha,hA], t['ab'][pv,pA,hc,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,WX,uv,iIaU,aVuW,vXiI->', eta1['b'], gamma1['b'], gamma1['a'], h['ab'][c,C,v,A], t['ab'][pv,pA,ha,hA], t['ab'][pa,pA,hc,hC], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,WX,uv,iXaA,aVuW,vAiU->', eta1['b'], gamma1['b'], gamma1['a'], h['ab'][c,A,v,V], t['ab'][pv,pA,ha,hA], t['ab'][pa,pV,hc,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,WX,uv,vIaA,VAIW,aXuU->', eta1['b'], gamma1['b'], gamma1['a'], h['ab'][a,C,v,V], t['bb'][pA,pV,hC,hA], t['ab'][pv,pA,ha,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,WX,uv,vIaA,XAIU,aVuW->', eta1['b'], gamma1['b'], gamma1['a'], h['ab'][a,C,v,V], t['bb'][pA,pV,hC,hA], t['ab'][pv,pA,ha,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,WX,YZ,iZaA,VAWY,aXiU->', eta1['b'], gamma1['b'], gamma1['b'], h['ab'][c,A,v,V], t['bb'][pA,pV,hA,hA], t['ab'][pv,pA,hc,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,WX,YZ,iZaA,XAUY,aViW->', eta1['b'], gamma1['b'], gamma1['b'], h['ab'][c,A,v,V], t['bb'][pA,pV,hA,hA], t['ab'][pv,pA,hc,hA], optimize=True)
	X['0'] += 0.125 * np.einsum('UV,WX,YZ,IJUA,VAWY,XZIJ->', eta1['b'], gamma1['b'], gamma1['b'], h['bb'][C,C,A,V], t['bb'][pA,pV,hA,hA], t['bb'][pA,pA,hC,hC], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,WX,YZ,IZAB,VBWY,XAIU->', eta1['b'], gamma1['b'], gamma1['b'], h['bb'][C,A,V,V], t['bb'][pA,pV,hA,hA], t['bb'][pA,pV,hC,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,WX,YZ,IZAB,XAUY,VBIW->', eta1['b'], gamma1['b'], gamma1['b'], h['bb'][C,A,V,V], t['bb'][pA,pV,hA,hA], t['bb'][pA,pV,hC,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,WX,ijab,aXiU,bVjW->', eta1['b'], gamma1['b'], h['aa'][c,c,v,v], t['ab'][pv,pA,hc,hA], t['ab'][pv,pA,hc,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,WX,iIaA,VAIW,aXiU->', eta1['b'], gamma1['b'], h['ab'][c,C,v,V], t['bb'][pA,pV,hC,hA], t['ab'][pv,pA,hc,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,WX,iIaA,XAIU,aViW->', eta1['b'], gamma1['b'], h['ab'][c,C,v,V], t['bb'][pA,pV,hC,hA], t['ab'][pv,pA,hc,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,WX,IJAB,XAIU,VBJW->', eta1['b'], gamma1['b'], h['bb'][C,C,V,V], t['bb'][pA,pV,hC,hA], t['bb'][pA,pV,hC,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,ijua,uWvX,aVjW,vXiU->', eta1['b'], h['aa'][c,c,a,v], lambdas['ab'], t['ab'][pv,pA,hc,hA], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,ijua,uWvX,aXiU,vVjW->', eta1['b'], h['aa'][c,c,a,v], lambdas['ab'], t['ab'][pv,pA,hc,hA], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,iuab,vWuX,aXvU,bViW->', eta1['b'], h['aa'][c,a,v,v], lambdas['ab'], t['ab'][pv,pA,ha,hA], t['ab'][pv,pA,hc,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,iuab,vWuX,bVvW,aXiU->', eta1['b'], h['aa'][c,a,v,v], lambdas['ab'], t['ab'][pv,pA,ha,hA], t['ab'][pv,pA,hc,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,iIuA,uvwx,wAiU,xVvI->', eta1['b'], h['ab'][c,C,a,V], lambdas['aa'], t['ab'][pa,pV,hc,hA], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,iIuA,uvwx,wAvU,xViI->', eta1['b'], h['ab'][c,C,a,V], lambdas['aa'], t['ab'][pa,pV,ha,hA], t['ab'][pa,pA,hc,hC], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,iIuA,uWvX,VXIW,vAiU->', eta1['b'], h['ab'][c,C,a,V], lambdas['ab'], t['bb'][pA,pA,hC,hA], t['ab'][pa,pV,hc,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,iIuA,uWvX,VAIW,vXiU->', eta1['b'], h['ab'][c,C,a,V], lambdas['ab'], t['bb'][pA,pV,hC,hA], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,iIuA,uWvX,XAIU,vViW->', eta1['b'], h['ab'][c,C,a,V], lambdas['ab'], t['bb'][pA,pV,hC,hA], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,iIuA,uWvX,XAUW,vViI->', eta1['b'], h['ab'][c,C,a,V], lambdas['ab'], t['bb'][pA,pV,hA,hA], t['ab'][pa,pA,hc,hC], optimize=True)
	X['0'] += 1.0 * np.einsum('UV,iIaU,uvwx,wVvI,xaiu->', eta1['b'], h['ab'][c,C,v,A], lambdas['aa'], t['ab'][pa,pA,ha,hC], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,iIaU,uvwx,xViI,wauv->', eta1['b'], h['ab'][c,C,v,A], lambdas['aa'], t['ab'][pa,pA,hc,hC], t['aa'][pa,pv,ha,ha], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,iIaU,uvwx,aVvI,wxiu->', eta1['b'], h['ab'][c,C,v,A], lambdas['aa'], t['ab'][pv,pA,ha,hC], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += -1.0 * np.einsum('UV,iIaU,uWvX,aViW,vXuI->', eta1['b'], h['ab'][c,C,v,A], lambdas['ab'], t['ab'][pv,pA,hc,hA], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += -1.0 * np.einsum('UV,iIaU,uWvX,aVuI,vXiW->', eta1['b'], h['ab'][c,C,v,A], lambdas['ab'], t['ab'][pv,pA,ha,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += 1.0 * np.einsum('UV,iIaU,uWvX,aVuW,vXiI->', eta1['b'], h['ab'][c,C,v,A], lambdas['ab'], t['ab'][pv,pA,ha,hA], t['ab'][pa,pA,hc,hC], optimize=True)
	X['0'] += 1.0 * np.einsum('UV,iIaU,uWvX,aXiW,vVuI->', eta1['b'], h['ab'][c,C,v,A], lambdas['ab'], t['ab'][pv,pA,hc,hA], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += 1.0 * np.einsum('UV,iIaU,uWvX,aXuI,vViW->', eta1['b'], h['ab'][c,C,v,A], lambdas['ab'], t['ab'][pv,pA,ha,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += -1.0 * np.einsum('UV,iIaU,uWvX,aXuW,vViI->', eta1['b'], h['ab'][c,C,v,A], lambdas['ab'], t['ab'][pv,pA,ha,hA], t['ab'][pa,pA,hc,hC], optimize=True)
	X['0'] += -1.0 * np.einsum('UV,iIaU,uWvX,VXIW,vaiu->', eta1['b'], h['ab'][c,C,v,A], lambdas['ab'], t['bb'][pA,pA,hC,hA], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += -1.0 * np.einsum('UV,iIaU,WXYZ,VYIX,aZiW->', eta1['b'], h['ab'][c,C,v,A], lambdas['bb'], t['bb'][pA,pA,hC,hA], t['ab'][pv,pA,hc,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,iIaU,WXYZ,YZIX,aViW->', eta1['b'], h['ab'][c,C,v,A], lambdas['bb'], t['bb'][pA,pA,hC,hA], t['ab'][pv,pA,hc,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,iIaW,uWvX,aVuI,vXiU->', eta1['b'], h['ab'][c,C,v,A], lambdas['ab'], t['ab'][pv,pA,ha,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,iIaW,uWvX,aXiU,vVuI->', eta1['b'], h['ab'][c,C,v,A], lambdas['ab'], t['ab'][pv,pA,hc,hA], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,iIaW,uWvX,aXuU,vViI->', eta1['b'], h['ab'][c,C,v,A], lambdas['ab'], t['ab'][pv,pA,ha,hA], t['ab'][pa,pA,hc,hC], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,iIaW,WXYZ,VZIX,aYiU->', eta1['b'], h['ab'][c,C,v,A], lambdas['bb'], t['bb'][pA,pA,hC,hA], t['ab'][pv,pA,hc,hA], optimize=True)
	X['0'] += -0.25 * np.einsum('UV,iIaW,WXYZ,YZIU,aViX->', eta1['b'], h['ab'][c,C,v,A], lambdas['bb'], t['bb'][pA,pA,hC,hA], t['ab'][pv,pA,hc,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,iWaA,uXvW,aViX,vAuU->', eta1['b'], h['ab'][c,A,v,V], lambdas['ab'], t['ab'][pv,pA,hc,hA], t['ab'][pa,pV,ha,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,iWaA,uXvW,aVuX,vAiU->', eta1['b'], h['ab'][c,A,v,V], lambdas['ab'], t['ab'][pv,pA,ha,hA], t['ab'][pa,pV,hc,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,iWaA,uXvW,aAuU,vViX->', eta1['b'], h['ab'][c,A,v,V], lambdas['ab'], t['ab'][pv,pV,ha,hA], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += -0.25 * np.einsum('UV,iWaA,XYWZ,VAXY,aZiU->', eta1['b'], h['ab'][c,A,v,V], lambdas['bb'], t['bb'][pA,pV,hA,hA], t['ab'][pv,pA,hc,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,iWaA,XYWZ,ZAUY,aViX->', eta1['b'], h['ab'][c,A,v,V], lambdas['bb'], t['bb'][pA,pV,hA,hA], t['ab'][pv,pA,hc,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,uIaA,vwux,aVvI,xAwU->', eta1['b'], h['ab'][a,C,v,V], lambdas['aa'], t['ab'][pv,pA,ha,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,uIaA,vwux,aAwU,xVvI->', eta1['b'], h['ab'][a,C,v,V], lambdas['aa'], t['ab'][pv,pV,ha,hA], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,uIaA,vWuX,VXIW,aAvU->', eta1['b'], h['ab'][a,C,v,V], lambdas['ab'], t['bb'][pA,pA,hC,hA], t['ab'][pv,pV,ha,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,uIaA,vWuX,VAIW,aXvU->', eta1['b'], h['ab'][a,C,v,V], lambdas['ab'], t['bb'][pA,pV,hC,hA], t['ab'][pv,pA,ha,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,uIaA,vWuX,XAIU,aVvW->', eta1['b'], h['ab'][a,C,v,V], lambdas['ab'], t['bb'][pA,pV,hC,hA], t['ab'][pv,pA,ha,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,uIaA,vWuX,XAUW,aVvI->', eta1['b'], h['ab'][a,C,v,V], lambdas['ab'], t['bb'][pA,pV,hA,hA], t['ab'][pv,pA,ha,hC], optimize=True)
	X['0'] += 1.0 * np.einsum('UV,IJUA,uvwx,wAvI,xVuJ->', eta1['b'], h['bb'][C,C,A,V], lambdas['aa'], t['ab'][pa,pV,ha,hC], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,IJUA,uWvX,VXIJ,vAuW->', eta1['b'], h['bb'][C,C,A,V], lambdas['ab'], t['bb'][pA,pA,hC,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['0'] += 1.0 * np.einsum('UV,IJUA,uWvX,VXIW,vAuJ->', eta1['b'], h['bb'][C,C,A,V], lambdas['ab'], t['bb'][pA,pA,hC,hA], t['ab'][pa,pV,ha,hC], optimize=True)
	X['0'] += -1.0 * np.einsum('UV,IJUA,uWvX,VAIW,vXuJ->', eta1['b'], h['bb'][C,C,A,V], lambdas['ab'], t['bb'][pA,pV,hC,hA], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += 1.0 * np.einsum('UV,IJUA,uWvX,XAIW,vVuJ->', eta1['b'], h['bb'][C,C,A,V], lambdas['ab'], t['bb'][pA,pV,hC,hA], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,IJUA,WXYZ,VAIX,YZJW->', eta1['b'], h['bb'][C,C,A,V], lambdas['bb'], t['bb'][pA,pV,hC,hA], t['bb'][pA,pA,hC,hA], optimize=True)
	X['0'] += 0.125 * np.einsum('UV,IJUA,WXYZ,VAWX,YZIJ->', eta1['b'], h['bb'][C,C,A,V], lambdas['bb'], t['bb'][pA,pV,hA,hA], t['bb'][pA,pA,hC,hC], optimize=True)
	X['0'] += -1.0 * np.einsum('UV,IJUA,WXYZ,YAIX,VZJW->', eta1['b'], h['bb'][C,C,A,V], lambdas['bb'], t['bb'][pA,pV,hC,hA], t['bb'][pA,pA,hC,hA], optimize=True)
	X['0'] += -0.25 * np.einsum('UV,IJUA,WXYZ,YAWX,VZIJ->', eta1['b'], h['bb'][C,C,A,V], lambdas['bb'], t['bb'][pA,pV,hA,hA], t['bb'][pA,pA,hC,hC], optimize=True)
	X['0'] += 0.25 * np.einsum('UV,IJWA,uWvX,VXIJ,vAuU->', eta1['b'], h['bb'][C,C,A,V], lambdas['ab'], t['bb'][pA,pA,hC,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,IJWA,uWvX,XAIU,vVuJ->', eta1['b'], h['bb'][C,C,A,V], lambdas['ab'], t['bb'][pA,pV,hC,hA], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += 0.25 * np.einsum('UV,IJWA,WXYZ,VAJX,YZIU->', eta1['b'], h['bb'][C,C,A,V], lambdas['bb'], t['bb'][pA,pV,hC,hA], t['bb'][pA,pA,hC,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,IJWA,WXYZ,YAIU,VZJX->', eta1['b'], h['bb'][C,C,A,V], lambdas['bb'], t['bb'][pA,pV,hC,hA], t['bb'][pA,pA,hC,hA], optimize=True)
	X['0'] += 0.25 * np.einsum('UV,IJWA,WXYZ,YAUX,VZIJ->', eta1['b'], h['bb'][C,C,A,V], lambdas['bb'], t['bb'][pA,pV,hA,hA], t['bb'][pA,pA,hC,hC], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,IWAB,uXvW,VBIX,vAuU->', eta1['b'], h['bb'][C,A,V,V], lambdas['ab'], t['bb'][pA,pV,hC,hA], t['ab'][pa,pV,ha,hA], optimize=True)
	X['0'] += 0.25 * np.einsum('UV,IWAB,uXvW,ABUX,vVuI->', eta1['b'], h['bb'][C,A,V,V], lambdas['ab'], t['bb'][pV,pV,hA,hA], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += 0.25 * np.einsum('UV,IWAB,XYWZ,VBXY,ZAIU->', eta1['b'], h['bb'][C,A,V,V], lambdas['bb'], t['bb'][pA,pV,hA,hA], t['bb'][pA,pV,hC,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,IWAB,XYWZ,ZAUY,VBIX->', eta1['b'], h['bb'][C,A,V,V], lambdas['bb'], t['bb'][pA,pV,hA,hA], t['bb'][pA,pV,hC,hA], optimize=True)
	X['0'] += -0.25 * np.einsum('UV,IWAB,XYWZ,ABUY,VZIX->', eta1['b'], h['bb'][C,A,V,V], lambdas['bb'], t['bb'][pV,pV,hA,hA], t['bb'][pA,pA,hC,hA], optimize=True)
	X['0'] += 0.125 * np.einsum('uv,wx,yz,izab,abuw,vxiy->', gamma1['a'], gamma1['a'], gamma1['a'], h['aa'][c,a,v,v], t['aa'][pv,pv,ha,ha], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += 0.0625 * np.einsum('uv,wx,ijab,abuw,vxij->', gamma1['a'], gamma1['a'], h['aa'][c,c,v,v], t['aa'][pv,pv,ha,ha], t['aa'][pa,pa,hc,hc], optimize=True)
	X['0'] += 0.25 * np.einsum('uv,ijwa,wxyz,vaix,yzju->', gamma1['a'], h['aa'][c,c,a,v], lambdas['aa'], t['aa'][pa,pv,hc,ha], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += 0.5 * np.einsum('uv,ijwa,wxyz,zaju,vyix->', gamma1['a'], h['aa'][c,c,a,v], lambdas['aa'], t['aa'][pa,pv,hc,ha], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += 0.25 * np.einsum('uv,ijwa,wxyz,zaux,vyij->', gamma1['a'], h['aa'][c,c,a,v], lambdas['aa'], t['aa'][pa,pv,ha,ha], t['aa'][pa,pa,hc,hc], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,ijwa,wUxV,vViU,xaju->', gamma1['a'], h['aa'][c,c,a,v], lambdas['ab'], t['ab'][pa,pA,hc,hA], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += -0.25 * np.einsum('uv,ijwa,wUxV,aVuU,vxij->', gamma1['a'], h['aa'][c,c,a,v], lambdas['ab'], t['ab'][pv,pA,ha,hA], t['aa'][pa,pa,hc,hc], optimize=True)
	X['0'] += 1.0 * np.einsum('uv,ivab,wxyz,yaux,zbiw->', gamma1['a'], h['aa'][c,a,v,v], lambdas['aa'], t['aa'][pa,pv,ha,ha], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,ivab,wxyz,yawx,zbiu->', gamma1['a'], h['aa'][c,a,v,v], lambdas['aa'], t['aa'][pa,pv,ha,ha], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += -0.25 * np.einsum('uv,ivab,wxyz,abux,yziw->', gamma1['a'], h['aa'][c,a,v,v], lambdas['aa'], t['aa'][pv,pv,ha,ha], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += 0.125 * np.einsum('uv,ivab,wxyz,abwx,yziu->', gamma1['a'], h['aa'][c,a,v,v], lambdas['aa'], t['aa'][pv,pv,ha,ha], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += 0.5 * np.einsum('uv,ivab,wUxV,abuw,xViU->', gamma1['a'], h['aa'][c,a,v,v], lambdas['ab'], t['aa'][pv,pv,ha,ha], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += 1.0 * np.einsum('uv,ivab,wUxV,aVuU,xbiw->', gamma1['a'], h['aa'][c,a,v,v], lambdas['ab'], t['ab'][pv,pA,ha,hA], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += -1.0 * np.einsum('uv,ivab,wUxV,aVwU,xbiu->', gamma1['a'], h['aa'][c,a,v,v], lambdas['ab'], t['ab'][pv,pA,ha,hA], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += 1.0 * np.einsum('uv,ivab,wUxV,bViU,xauw->', gamma1['a'], h['aa'][c,a,v,v], lambdas['ab'], t['ab'][pv,pA,hc,hA], t['aa'][pa,pv,ha,ha], optimize=True)
	X['0'] += 1.0 * np.einsum('uv,ivab,UVWX,aWuV,bXiU->', gamma1['a'], h['aa'][c,a,v,v], lambdas['bb'], t['ab'][pv,pA,ha,hA], t['ab'][pv,pA,hc,hA], optimize=True)
	X['0'] += 0.25 * np.einsum('uv,iwab,xywz,vaxy,zbiu->', gamma1['a'], h['aa'][c,a,v,v], lambdas['aa'], t['aa'][pa,pv,ha,ha], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += 0.5 * np.einsum('uv,iwab,xywz,zbux,vaiy->', gamma1['a'], h['aa'][c,a,v,v], lambdas['aa'], t['aa'][pa,pv,ha,ha], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += -0.25 * np.einsum('uv,iwab,xywz,abux,vziy->', gamma1['a'], h['aa'][c,a,v,v], lambdas['aa'], t['aa'][pv,pv,ha,ha], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += -0.25 * np.einsum('uv,iwab,xUwV,abux,vViU->', gamma1['a'], h['aa'][c,a,v,v], lambdas['ab'], t['aa'][pv,pv,ha,ha], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('uv,iwab,xUwV,bVuU,vaix->', gamma1['a'], h['aa'][c,a,v,v], lambdas['ab'], t['ab'][pv,pA,ha,hA], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += 0.25 * np.einsum('uv,iIwA,wxyz,vAxI,yziu->', gamma1['a'], h['ab'][c,C,a,V], lambdas['aa'], t['ab'][pa,pV,ha,hC], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,iIwA,wxyz,zAuI,vyix->', gamma1['a'], h['ab'][c,C,a,V], lambdas['aa'], t['ab'][pa,pV,ha,hC], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,iIwA,wUxV,vAiU,xVuI->', gamma1['a'], h['ab'][c,C,a,V], lambdas['ab'], t['ab'][pa,pV,hc,hA], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += 0.5 * np.einsum('uv,iIwA,wUxV,xAuI,vViU->', gamma1['a'], h['ab'][c,C,a,V], lambdas['ab'], t['ab'][pa,pV,ha,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,iIwA,wUxV,xAuU,vViI->', gamma1['a'], h['ab'][c,C,a,V], lambdas['ab'], t['ab'][pa,pV,ha,hA], t['ab'][pa,pA,hc,hC], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,iIaU,wUxV,vViI,xauw->', gamma1['a'], h['ab'][c,C,v,A], lambdas['ab'], t['ab'][pa,pA,hc,hC], t['aa'][pa,pv,ha,ha], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,iIaU,wUxV,vVwI,xaiu->', gamma1['a'], h['ab'][c,C,v,A], lambdas['ab'], t['ab'][pa,pA,ha,hC], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,iIaU,wUxV,xVuI,vaiw->', gamma1['a'], h['ab'][c,C,v,A], lambdas['ab'], t['ab'][pa,pA,ha,hC], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += 0.5 * np.einsum('uv,iIaU,wUxV,aVuI,vxiw->', gamma1['a'], h['ab'][c,C,v,A], lambdas['ab'], t['ab'][pv,pA,ha,hC], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,iIaU,UVWX,aXuI,vWiV->', gamma1['a'], h['ab'][c,C,v,A], lambdas['bb'], t['ab'][pv,pA,ha,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('uv,iIaU,UVWX,aXuV,vWiI->', gamma1['a'], h['ab'][c,C,v,A], lambdas['bb'], t['ab'][pv,pA,ha,hA], t['ab'][pa,pA,hc,hC], optimize=True)
	X['0'] += 0.5 * np.einsum('uv,iUaA,wVxU,vAiV,xauw->', gamma1['a'], h['ab'][c,A,v,V], lambdas['ab'], t['ab'][pa,pV,hc,hA], t['aa'][pa,pv,ha,ha], optimize=True)
	X['0'] += 0.5 * np.einsum('uv,iUaA,wVxU,vAwV,xaiu->', gamma1['a'], h['ab'][c,A,v,V], lambdas['ab'], t['ab'][pa,pV,ha,hA], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += 0.5 * np.einsum('uv,iUaA,wVxU,xAuV,vaiw->', gamma1['a'], h['ab'][c,A,v,V], lambdas['ab'], t['ab'][pa,pV,ha,hA], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,iUaA,wVxU,aAuV,vxiw->', gamma1['a'], h['ab'][c,A,v,V], lambdas['ab'], t['ab'][pv,pV,ha,hA], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += 0.5 * np.einsum('uv,iUaA,VWUX,aXuV,vAiW->', gamma1['a'], h['ab'][c,A,v,V], lambdas['bb'], t['ab'][pv,pA,ha,hA], t['ab'][pa,pV,hc,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,iUaA,VWUX,aAuV,vXiW->', gamma1['a'], h['ab'][c,A,v,V], lambdas['bb'], t['ab'][pv,pV,ha,hA], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('uv,vIaA,wxyz,yAuI,zawx->', gamma1['a'], h['ab'][a,C,v,V], lambdas['aa'], t['ab'][pa,pV,ha,hC], t['aa'][pa,pv,ha,ha], optimize=True)
	X['0'] += 1.0 * np.einsum('uv,vIaA,wxyz,yAxI,zauw->', gamma1['a'], h['ab'][a,C,v,V], lambdas['aa'], t['ab'][pa,pV,ha,hC], t['aa'][pa,pv,ha,ha], optimize=True)
	X['0'] += -1.0 * np.einsum('uv,vIaA,wUxV,aVuI,xAwU->', gamma1['a'], h['ab'][a,C,v,V], lambdas['ab'], t['ab'][pv,pA,ha,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['0'] += 1.0 * np.einsum('uv,vIaA,wUxV,aVuU,xAwI->', gamma1['a'], h['ab'][a,C,v,V], lambdas['ab'], t['ab'][pv,pA,ha,hA], t['ab'][pa,pV,ha,hC], optimize=True)
	X['0'] += 1.0 * np.einsum('uv,vIaA,wUxV,aVwI,xAuU->', gamma1['a'], h['ab'][a,C,v,V], lambdas['ab'], t['ab'][pv,pA,ha,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['0'] += -1.0 * np.einsum('uv,vIaA,wUxV,aVwU,xAuI->', gamma1['a'], h['ab'][a,C,v,V], lambdas['ab'], t['ab'][pv,pA,ha,hA], t['ab'][pa,pV,ha,hC], optimize=True)
	X['0'] += -1.0 * np.einsum('uv,vIaA,wUxV,aAuU,xVwI->', gamma1['a'], h['ab'][a,C,v,V], lambdas['ab'], t['ab'][pv,pV,ha,hA], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += 1.0 * np.einsum('uv,vIaA,wUxV,aAwU,xVuI->', gamma1['a'], h['ab'][a,C,v,V], lambdas['ab'], t['ab'][pv,pV,ha,hA], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += 1.0 * np.einsum('uv,vIaA,wUxV,VAIU,xauw->', gamma1['a'], h['ab'][a,C,v,V], lambdas['ab'], t['bb'][pA,pV,hC,hA], t['aa'][pa,pv,ha,ha], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,vIaA,UVWX,WXIV,aAuU->', gamma1['a'], h['ab'][a,C,v,V], lambdas['bb'], t['bb'][pA,pA,hC,hA], t['ab'][pv,pV,ha,hA], optimize=True)
	X['0'] += 1.0 * np.einsum('uv,vIaA,UVWX,WAIV,aXuU->', gamma1['a'], h['ab'][a,C,v,V], lambdas['bb'], t['bb'][pA,pV,hC,hA], t['ab'][pv,pA,ha,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,vIaA,UVWX,WAUV,aXuI->', gamma1['a'], h['ab'][a,C,v,V], lambdas['bb'], t['bb'][pA,pV,hA,hA], t['ab'][pv,pA,ha,hC], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,wIaA,xywz,vAyI,zaux->', gamma1['a'], h['ab'][a,C,v,V], lambdas['aa'], t['ab'][pa,pV,ha,hC], t['aa'][pa,pv,ha,ha], optimize=True)
	X['0'] += 0.25 * np.einsum('uv,wIaA,xywz,zAuI,vaxy->', gamma1['a'], h['ab'][a,C,v,V], lambdas['aa'], t['ab'][pa,pV,ha,hC], t['aa'][pa,pv,ha,ha], optimize=True)
	X['0'] += 0.5 * np.einsum('uv,wIaA,xUwV,aVuI,vAxU->', gamma1['a'], h['ab'][a,C,v,V], lambdas['ab'], t['ab'][pv,pA,ha,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,wIaA,xUwV,aVuU,vAxI->', gamma1['a'], h['ab'][a,C,v,V], lambdas['ab'], t['ab'][pv,pA,ha,hA], t['ab'][pa,pV,ha,hC], optimize=True)
	X['0'] += 0.5 * np.einsum('uv,wIaA,xUwV,aAuU,vVxI->', gamma1['a'], h['ab'][a,C,v,V], lambdas['ab'], t['ab'][pv,pV,ha,hA], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,IJUA,wUxV,vAwI,xVuJ->', gamma1['a'], h['bb'][C,C,A,V], lambdas['ab'], t['ab'][pa,pV,ha,hC], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += 0.5 * np.einsum('uv,IJUA,wUxV,xAuJ,vVwI->', gamma1['a'], h['bb'][C,C,A,V], lambdas['ab'], t['ab'][pa,pV,ha,hC], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += 0.5 * np.einsum('uv,IUAB,wVxU,vAwV,xBuI->', gamma1['a'], h['bb'][C,A,V,V], lambdas['ab'], t['ab'][pa,pV,ha,hA], t['ab'][pa,pV,ha,hC], optimize=True)
	X['0'] += -0.5 * np.einsum('uv,IUAB,wVxU,xBuV,vAwI->', gamma1['a'], h['bb'][C,A,V,V], lambdas['ab'], t['ab'][pa,pV,ha,hA], t['ab'][pa,pV,ha,hC], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,uv,wx,xIaA,aAuU,vVwI->', gamma1['b'], gamma1['a'], gamma1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,ha,hA], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,uv,iIaA,aAuU,vViI->', gamma1['b'], gamma1['a'], h['ab'][c,C,v,V], t['ab'][pv,pV,ha,hA], t['ab'][pa,pA,hc,hC], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,WX,uv,iXaA,aAuU,vViW->', gamma1['b'], gamma1['b'], gamma1['a'], h['ab'][c,A,v,V], t['ab'][pv,pV,ha,hA], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += 0.125 * np.einsum('UV,WX,YZ,IZAB,ABUW,VXIY->', gamma1['b'], gamma1['b'], gamma1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hA,hA], t['bb'][pA,pA,hC,hA], optimize=True)
	X['0'] += 0.0625 * np.einsum('UV,WX,IJAB,ABUW,VXIJ->', gamma1['b'], gamma1['b'], h['bb'][C,C,V,V], t['bb'][pV,pV,hA,hA], t['bb'][pA,pA,hC,hC], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,ijua,uWvX,aViW,vXjU->', gamma1['b'], h['aa'][c,c,a,v], lambdas['ab'], t['ab'][pv,pA,hc,hA], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,ijua,uWvX,aXjU,vViW->', gamma1['b'], h['aa'][c,c,a,v], lambdas['ab'], t['ab'][pv,pA,hc,hA], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,iuab,vWuX,aVvW,bXiU->', gamma1['b'], h['aa'][c,a,v,v], lambdas['ab'], t['ab'][pv,pA,ha,hA], t['ab'][pv,pA,hc,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,iuab,vWuX,bXvU,aViW->', gamma1['b'], h['aa'][c,a,v,v], lambdas['ab'], t['ab'][pv,pA,ha,hA], t['ab'][pv,pA,hc,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,iIuA,uvwx,xAiU,wVvI->', gamma1['b'], h['ab'][c,C,a,V], lambdas['aa'], t['ab'][pa,pV,hc,hA], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,iIuA,uvwx,xAvU,wViI->', gamma1['b'], h['ab'][c,C,a,V], lambdas['aa'], t['ab'][pa,pV,ha,hA], t['ab'][pa,pA,hc,hC], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,iIuA,uWvX,VXIW,vAiU->', gamma1['b'], h['ab'][c,C,a,V], lambdas['ab'], t['bb'][pA,pA,hC,hA], t['ab'][pa,pV,hc,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,iIuA,uWvX,VAIW,vXiU->', gamma1['b'], h['ab'][c,C,a,V], lambdas['ab'], t['bb'][pA,pV,hC,hA], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,iIuA,uWvX,XAIU,vViW->', gamma1['b'], h['ab'][c,C,a,V], lambdas['ab'], t['bb'][pA,pV,hC,hA], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,iIuA,uWvX,XAUW,vViI->', gamma1['b'], h['ab'][c,C,a,V], lambdas['ab'], t['bb'][pA,pV,hA,hA], t['ab'][pa,pA,hc,hC], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,iIaW,uWvX,aVuI,vXiU->', gamma1['b'], h['ab'][c,C,v,A], lambdas['ab'], t['ab'][pv,pA,ha,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,iIaW,uWvX,aXiU,vVuI->', gamma1['b'], h['ab'][c,C,v,A], lambdas['ab'], t['ab'][pv,pA,hc,hA], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,iIaW,uWvX,aXuU,vViI->', gamma1['b'], h['ab'][c,C,v,A], lambdas['ab'], t['ab'][pv,pA,ha,hA], t['ab'][pa,pA,hc,hC], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,iIaW,WXYZ,VYIX,aZiU->', gamma1['b'], h['ab'][c,C,v,A], lambdas['bb'], t['bb'][pA,pA,hC,hA], t['ab'][pv,pA,hc,hA], optimize=True)
	X['0'] += 0.25 * np.einsum('UV,iIaW,WXYZ,YZIU,aViX->', gamma1['b'], h['ab'][c,C,v,A], lambdas['bb'], t['bb'][pA,pA,hC,hA], t['ab'][pv,pA,hc,hA], optimize=True)
	X['0'] += 1.0 * np.einsum('UV,iVaA,uvwx,wAvU,xaiu->', gamma1['b'], h['ab'][c,A,v,V], lambdas['aa'], t['ab'][pa,pV,ha,hA], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,iVaA,uvwx,xAiU,wauv->', gamma1['b'], h['ab'][c,A,v,V], lambdas['aa'], t['ab'][pa,pV,hc,hA], t['aa'][pa,pv,ha,ha], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,iVaA,uvwx,aAvU,wxiu->', gamma1['b'], h['ab'][c,A,v,V], lambdas['aa'], t['ab'][pv,pV,ha,hA], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += -1.0 * np.einsum('UV,iVaA,uWvX,aXiU,vAuW->', gamma1['b'], h['ab'][c,A,v,V], lambdas['ab'], t['ab'][pv,pA,hc,hA], t['ab'][pa,pV,ha,hA], optimize=True)
	X['0'] += 1.0 * np.einsum('UV,iVaA,uWvX,aXiW,vAuU->', gamma1['b'], h['ab'][c,A,v,V], lambdas['ab'], t['ab'][pv,pA,hc,hA], t['ab'][pa,pV,ha,hA], optimize=True)
	X['0'] += 1.0 * np.einsum('UV,iVaA,uWvX,aXuU,vAiW->', gamma1['b'], h['ab'][c,A,v,V], lambdas['ab'], t['ab'][pv,pA,ha,hA], t['ab'][pa,pV,hc,hA], optimize=True)
	X['0'] += -1.0 * np.einsum('UV,iVaA,uWvX,aXuW,vAiU->', gamma1['b'], h['ab'][c,A,v,V], lambdas['ab'], t['ab'][pv,pA,ha,hA], t['ab'][pa,pV,hc,hA], optimize=True)
	X['0'] += -1.0 * np.einsum('UV,iVaA,uWvX,aAuU,vXiW->', gamma1['b'], h['ab'][c,A,v,V], lambdas['ab'], t['ab'][pv,pV,ha,hA], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += 1.0 * np.einsum('UV,iVaA,uWvX,aAuW,vXiU->', gamma1['b'], h['ab'][c,A,v,V], lambdas['ab'], t['ab'][pv,pV,ha,hA], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += 1.0 * np.einsum('UV,iVaA,uWvX,XAUW,vaiu->', gamma1['b'], h['ab'][c,A,v,V], lambdas['ab'], t['bb'][pA,pV,hA,hA], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += 1.0 * np.einsum('UV,iVaA,WXYZ,YAUX,aZiW->', gamma1['b'], h['ab'][c,A,v,V], lambdas['bb'], t['bb'][pA,pV,hA,hA], t['ab'][pv,pA,hc,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,iVaA,WXYZ,YAWX,aZiU->', gamma1['b'], h['ab'][c,A,v,V], lambdas['bb'], t['bb'][pA,pV,hA,hA], t['ab'][pv,pA,hc,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,iWaA,uXvW,aViX,vAuU->', gamma1['b'], h['ab'][c,A,v,V], lambdas['ab'], t['ab'][pv,pA,hc,hA], t['ab'][pa,pV,ha,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,iWaA,uXvW,aVuX,vAiU->', gamma1['b'], h['ab'][c,A,v,V], lambdas['ab'], t['ab'][pv,pA,ha,hA], t['ab'][pa,pV,hc,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,iWaA,uXvW,aAuU,vViX->', gamma1['b'], h['ab'][c,A,v,V], lambdas['ab'], t['ab'][pv,pV,ha,hA], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += 0.25 * np.einsum('UV,iWaA,XYWZ,VAXY,aZiU->', gamma1['b'], h['ab'][c,A,v,V], lambdas['bb'], t['bb'][pA,pV,hA,hA], t['ab'][pv,pA,hc,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,iWaA,XYWZ,ZAUX,aViY->', gamma1['b'], h['ab'][c,A,v,V], lambdas['bb'], t['bb'][pA,pV,hA,hA], t['ab'][pv,pA,hc,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,uIaA,vwux,aVwI,xAvU->', gamma1['b'], h['ab'][a,C,v,V], lambdas['aa'], t['ab'][pv,pA,ha,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,uIaA,vwux,aAvU,xVwI->', gamma1['b'], h['ab'][a,C,v,V], lambdas['aa'], t['ab'][pv,pV,ha,hA], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,uIaA,vWuX,VXIW,aAvU->', gamma1['b'], h['ab'][a,C,v,V], lambdas['ab'], t['bb'][pA,pA,hC,hA], t['ab'][pv,pV,ha,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,uIaA,vWuX,VAIW,aXvU->', gamma1['b'], h['ab'][a,C,v,V], lambdas['ab'], t['bb'][pA,pV,hC,hA], t['ab'][pv,pA,ha,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,uIaA,vWuX,XAIU,aVvW->', gamma1['b'], h['ab'][a,C,v,V], lambdas['ab'], t['bb'][pA,pV,hC,hA], t['ab'][pv,pA,ha,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,uIaA,vWuX,XAUW,aVvI->', gamma1['b'], h['ab'][a,C,v,V], lambdas['ab'], t['bb'][pA,pV,hA,hA], t['ab'][pv,pA,ha,hC], optimize=True)
	X['0'] += -0.25 * np.einsum('UV,IJWA,uWvX,VXIJ,vAuU->', gamma1['b'], h['bb'][C,C,A,V], lambdas['ab'], t['bb'][pA,pA,hC,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,IJWA,uWvX,XAJU,vVuI->', gamma1['b'], h['bb'][C,C,A,V], lambdas['ab'], t['bb'][pA,pV,hC,hA], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += 0.25 * np.einsum('UV,IJWA,WXYZ,VAIX,YZJU->', gamma1['b'], h['bb'][C,C,A,V], lambdas['bb'], t['bb'][pA,pV,hC,hA], t['bb'][pA,pA,hC,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,IJWA,WXYZ,ZAJU,VYIX->', gamma1['b'], h['bb'][C,C,A,V], lambdas['bb'], t['bb'][pA,pV,hC,hA], t['bb'][pA,pA,hC,hA], optimize=True)
	X['0'] += 0.25 * np.einsum('UV,IJWA,WXYZ,ZAUX,VYIJ->', gamma1['b'], h['bb'][C,C,A,V], lambdas['bb'], t['bb'][pA,pV,hA,hA], t['bb'][pA,pA,hC,hC], optimize=True)
	X['0'] += 1.0 * np.einsum('UV,IVAB,uvwx,wAvU,xBuI->', gamma1['b'], h['bb'][C,A,V,V], lambdas['aa'], t['ab'][pa,pV,ha,hA], t['ab'][pa,pV,ha,hC], optimize=True)
	X['0'] += 1.0 * np.einsum('UV,IVAB,uWvX,XAIU,vBuW->', gamma1['b'], h['bb'][C,A,V,V], lambdas['ab'], t['bb'][pA,pV,hC,hA], t['ab'][pa,pV,ha,hA], optimize=True)
	X['0'] += -1.0 * np.einsum('UV,IVAB,uWvX,XAIW,vBuU->', gamma1['b'], h['bb'][C,A,V,V], lambdas['ab'], t['bb'][pA,pV,hC,hA], t['ab'][pa,pV,ha,hA], optimize=True)
	X['0'] += 1.0 * np.einsum('UV,IVAB,uWvX,XAUW,vBuI->', gamma1['b'], h['bb'][C,A,V,V], lambdas['ab'], t['bb'][pA,pV,hA,hA], t['ab'][pa,pV,ha,hC], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,IVAB,uWvX,ABUW,vXuI->', gamma1['b'], h['bb'][C,A,V,V], lambdas['ab'], t['bb'][pV,pV,hA,hA], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += 1.0 * np.einsum('UV,IVAB,WXYZ,YAUX,ZBIW->', gamma1['b'], h['bb'][C,A,V,V], lambdas['bb'], t['bb'][pA,pV,hA,hA], t['bb'][pA,pV,hC,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('UV,IVAB,WXYZ,YAWX,ZBIU->', gamma1['b'], h['bb'][C,A,V,V], lambdas['bb'], t['bb'][pA,pV,hA,hA], t['bb'][pA,pV,hC,hA], optimize=True)
	X['0'] += -0.25 * np.einsum('UV,IVAB,WXYZ,ABUX,YZIW->', gamma1['b'], h['bb'][C,A,V,V], lambdas['bb'], t['bb'][pV,pV,hA,hA], t['bb'][pA,pA,hC,hA], optimize=True)
	X['0'] += 0.125 * np.einsum('UV,IVAB,WXYZ,ABWX,YZIU->', gamma1['b'], h['bb'][C,A,V,V], lambdas['bb'], t['bb'][pV,pV,hA,hA], t['bb'][pA,pA,hC,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,IWAB,uXvW,VAIX,vBuU->', gamma1['b'], h['bb'][C,A,V,V], lambdas['ab'], t['bb'][pA,pV,hC,hA], t['ab'][pa,pV,ha,hA], optimize=True)
	X['0'] += -0.25 * np.einsum('UV,IWAB,uXvW,ABUX,vVuI->', gamma1['b'], h['bb'][C,A,V,V], lambdas['ab'], t['bb'][pV,pV,hA,hA], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += 0.25 * np.einsum('UV,IWAB,XYWZ,VAXY,ZBIU->', gamma1['b'], h['bb'][C,A,V,V], lambdas['bb'], t['bb'][pA,pV,hA,hA], t['bb'][pA,pV,hC,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('UV,IWAB,XYWZ,ZBUX,VAIY->', gamma1['b'], h['bb'][C,A,V,V], lambdas['bb'], t['bb'][pA,pV,hA,hA], t['bb'][pA,pV,hC,hA], optimize=True)
	X['0'] += -0.25 * np.einsum('UV,IWAB,XYWZ,ABUX,VZIY->', gamma1['b'], h['bb'][C,A,V,V], lambdas['bb'], t['bb'][pV,pV,hA,hA], t['bb'][pA,pA,hC,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('ijua,uvwxyz,xaiw,yzjv->', h['aa'][c,c,a,v], lambdas['aaa'], t['aa'][pa,pv,hc,ha], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += -0.125 * np.einsum('ijua,uvwxyz,xavw,yzij->', h['aa'][c,c,a,v], lambdas['aaa'], t['aa'][pa,pv,ha,ha], t['aa'][pa,pa,hc,hc], optimize=True)
	X['0'] += 1.0 * np.einsum('ijua,uvUwxV,wViU,xajv->', h['aa'][c,c,a,v], lambdas['aab'], t['ab'][pa,pA,hc,hA], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += 0.5 * np.einsum('ijua,uvUwxV,aViU,wxjv->', h['aa'][c,c,a,v], lambdas['aab'], t['ab'][pv,pA,hc,hA], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += 0.25 * np.einsum('ijua,uvUwxV,aVvU,wxij->', h['aa'][c,c,a,v], lambdas['aab'], t['ab'][pv,pA,ha,hA], t['aa'][pa,pa,hc,hc], optimize=True)
	X['0'] += -1.0 * np.einsum('ijua,uUVvWX,aWiV,vXjU->', h['aa'][c,c,a,v], lambdas['abb'], t['ab'][pv,pA,hc,hA], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('ijab,uvwx,waiv,xbju->', h['aa'][c,c,v,v], lambdas['aa'], t['aa'][pa,pv,hc,ha], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += -0.25 * np.einsum('ijab,uvwx,wauv,xbij->', h['aa'][c,c,v,v], lambdas['aa'], t['aa'][pa,pv,ha,ha], t['aa'][pa,pv,hc,hc], optimize=True)
	X['0'] += 0.25 * np.einsum('ijab,uvwx,abiv,wxju->', h['aa'][c,c,v,v], lambdas['aa'], t['aa'][pv,pv,hc,ha], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += 0.0625 * np.einsum('ijab,uvwx,abuv,wxij->', h['aa'][c,c,v,v], lambdas['aa'], t['aa'][pv,pv,ha,ha], t['aa'][pa,pa,hc,hc], optimize=True)
	X['0'] += -0.5 * np.einsum('ijab,uUvV,abiu,vVjU->', h['aa'][c,c,v,v], lambdas['ab'], t['aa'][pv,pv,hc,ha], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += -1.0 * np.einsum('ijab,uUvV,aViU,vbju->', h['aa'][c,c,v,v], lambdas['ab'], t['ab'][pv,pA,hc,hA], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += -0.5 * np.einsum('ijab,uUvV,aVuU,vbij->', h['aa'][c,c,v,v], lambdas['ab'], t['ab'][pv,pA,ha,hA], t['aa'][pa,pv,hc,hc], optimize=True)
	X['0'] += -0.5 * np.einsum('ijab,UVWX,bXjU,aWiV->', h['aa'][c,c,v,v], lambdas['bb'], t['ab'][pv,pA,hc,hA], t['ab'][pv,pA,hc,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('iuab,vwxuyz,yawx,zbiv->', h['aa'][c,a,v,v], lambdas['aaa'], t['aa'][pa,pv,ha,ha], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += 0.125 * np.einsum('iuab,vwxuyz,abwx,yziv->', h['aa'][c,a,v,v], lambdas['aaa'], t['aa'][pv,pv,ha,ha], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += 0.25 * np.einsum('iuab,vwUuxV,abvw,xViU->', h['aa'][c,a,v,v], lambdas['aab'], t['aa'][pv,pv,ha,ha], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += -1.0 * np.einsum('iuab,vwUuxV,aVwU,xbiv->', h['aa'][c,a,v,v], lambdas['aab'], t['ab'][pv,pA,ha,hA], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += 0.5 * np.einsum('iuab,vwUuxV,bViU,xavw->', h['aa'][c,a,v,v], lambdas['aab'], t['ab'][pv,pA,hc,hA], t['aa'][pa,pv,ha,ha], optimize=True)
	X['0'] += 1.0 * np.einsum('iuab,vUVuWX,aWvV,bXiU->', h['aa'][c,a,v,v], lambdas['abb'], t['ab'][pv,pA,ha,hA], t['ab'][pv,pA,hc,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('iIuA,uvwxyz,xAwI,yziv->', h['ab'][c,C,a,V], lambdas['aaa'], t['ab'][pa,pV,ha,hC], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += 1.0 * np.einsum('iIuA,uvUwxV,wAvI,xViU->', h['ab'][c,C,a,V], lambdas['aab'], t['ab'][pa,pV,ha,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += -1.0 * np.einsum('iIuA,uvUwxV,wAvU,xViI->', h['ab'][c,C,a,V], lambdas['aab'], t['ab'][pa,pV,ha,hA], t['ab'][pa,pA,hc,hC], optimize=True)
	X['0'] += -1.0 * np.einsum('iIuA,uvUwxV,xAiU,wVvI->', h['ab'][c,C,a,V], lambdas['aab'], t['ab'][pa,pV,hc,hA], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += 0.5 * np.einsum('iIuA,uvUwxV,VAIU,wxiv->', h['ab'][c,C,a,V], lambdas['aab'], t['bb'][pA,pV,hC,hA], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += 0.5 * np.einsum('iIuA,uUVvWX,WXIV,vAiU->', h['ab'][c,C,a,V], lambdas['abb'], t['bb'][pA,pA,hC,hA], t['ab'][pa,pV,hc,hA], optimize=True)
	X['0'] += -1.0 * np.einsum('iIuA,uUVvWX,WAIV,vXiU->', h['ab'][c,C,a,V], lambdas['abb'], t['bb'][pA,pV,hC,hA], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('iIuA,uUVvWX,WAUV,vXiI->', h['ab'][c,C,a,V], lambdas['abb'], t['bb'][pA,pV,hA,hA], t['ab'][pa,pA,hc,hC], optimize=True)
	X['0'] += -1.0 * np.einsum('iIaU,uvUwxV,wVvI,xaiu->', h['ab'][c,C,v,A], lambdas['aab'], t['ab'][pa,pA,ha,hC], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += 0.5 * np.einsum('iIaU,uvUwxV,xViI,wauv->', h['ab'][c,C,v,A], lambdas['aab'], t['ab'][pa,pA,hc,hC], t['aa'][pa,pv,ha,ha], optimize=True)
	X['0'] += -0.5 * np.einsum('iIaU,uvUwxV,aVvI,wxiu->', h['ab'][c,C,v,A], lambdas['aab'], t['ab'][pv,pA,ha,hC], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += 1.0 * np.einsum('iIaU,uUVvWX,aWuI,vXiV->', h['ab'][c,C,v,A], lambdas['abb'], t['ab'][pv,pA,ha,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += -1.0 * np.einsum('iIaU,uUVvWX,aWuV,vXiI->', h['ab'][c,C,v,A], lambdas['abb'], t['ab'][pv,pA,ha,hA], t['ab'][pa,pA,hc,hC], optimize=True)
	X['0'] += -1.0 * np.einsum('iIaU,uUVvWX,aXiV,vWuI->', h['ab'][c,C,v,A], lambdas['abb'], t['ab'][pv,pA,hc,hA], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += 0.5 * np.einsum('iIaU,uUVvWX,WXIV,vaiu->', h['ab'][c,C,v,A], lambdas['abb'], t['bb'][pA,pA,hC,hA], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += 0.5 * np.einsum('iIaU,UVWXYZ,XYIW,aZiV->', h['ab'][c,C,v,A], lambdas['bbb'], t['bb'][pA,pA,hC,hA], t['ab'][pv,pA,hc,hA], optimize=True)
	X['0'] += 1.0 * np.einsum('iIaA,uvwx,wAvI,xaiu->', h['ab'][c,C,v,V], lambdas['aa'], t['ab'][pa,pV,ha,hC], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += -0.5 * np.einsum('iIaA,uvwx,xAiI,wauv->', h['ab'][c,C,v,V], lambdas['aa'], t['ab'][pa,pV,hc,hC], t['aa'][pa,pv,ha,ha], optimize=True)
	X['0'] += 0.5 * np.einsum('iIaA,uvwx,aAvI,wxiu->', h['ab'][c,C,v,V], lambdas['aa'], t['ab'][pv,pV,ha,hC], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += -1.0 * np.einsum('iIaA,uUvV,aViI,vAuU->', h['ab'][c,C,v,V], lambdas['ab'], t['ab'][pv,pA,hc,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['0'] += 1.0 * np.einsum('iIaA,uUvV,aViU,vAuI->', h['ab'][c,C,v,V], lambdas['ab'], t['ab'][pv,pA,hc,hA], t['ab'][pa,pV,ha,hC], optimize=True)
	X['0'] += 1.0 * np.einsum('iIaA,uUvV,aVuI,vAiU->', h['ab'][c,C,v,V], lambdas['ab'], t['ab'][pv,pA,ha,hC], t['ab'][pa,pV,hc,hA], optimize=True)
	X['0'] += -1.0 * np.einsum('iIaA,uUvV,aVuU,vAiI->', h['ab'][c,C,v,V], lambdas['ab'], t['ab'][pv,pA,ha,hA], t['ab'][pa,pV,hc,hC], optimize=True)
	X['0'] += -1.0 * np.einsum('iIaA,uUvV,aAiU,vVuI->', h['ab'][c,C,v,V], lambdas['ab'], t['ab'][pv,pV,hc,hA], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += -1.0 * np.einsum('iIaA,uUvV,aAuI,vViU->', h['ab'][c,C,v,V], lambdas['ab'], t['ab'][pv,pV,ha,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += 1.0 * np.einsum('iIaA,uUvV,aAuU,vViI->', h['ab'][c,C,v,V], lambdas['ab'], t['ab'][pv,pV,ha,hA], t['ab'][pa,pA,hc,hC], optimize=True)
	X['0'] += 1.0 * np.einsum('iIaA,uUvV,VAIU,vaiu->', h['ab'][c,C,v,V], lambdas['ab'], t['bb'][pA,pV,hC,hA], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += -0.5 * np.einsum('iIaA,UVWX,WXIV,aAiU->', h['ab'][c,C,v,V], lambdas['bb'], t['bb'][pA,pA,hC,hA], t['ab'][pv,pV,hc,hA], optimize=True)
	X['0'] += 1.0 * np.einsum('iIaA,UVWX,WAIV,aXiU->', h['ab'][c,C,v,V], lambdas['bb'], t['bb'][pA,pV,hC,hA], t['ab'][pv,pA,hc,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('iIaA,UVWX,WAUV,aXiI->', h['ab'][c,C,v,V], lambdas['bb'], t['bb'][pA,pV,hA,hA], t['ab'][pv,pA,hc,hC], optimize=True)
	X['0'] += 1.0 * np.einsum('iUaA,uvVwxU,wAvV,xaiu->', h['ab'][c,A,v,V], lambdas['aab'], t['ab'][pa,pV,ha,hA], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += -0.5 * np.einsum('iUaA,uvVwxU,xAiV,wauv->', h['ab'][c,A,v,V], lambdas['aab'], t['ab'][pa,pV,hc,hA], t['aa'][pa,pv,ha,ha], optimize=True)
	X['0'] += 0.5 * np.einsum('iUaA,uvVwxU,aAvV,wxiu->', h['ab'][c,A,v,V], lambdas['aab'], t['ab'][pv,pV,ha,hA], t['aa'][pa,pa,hc,ha], optimize=True)
	X['0'] += -1.0 * np.einsum('iUaA,uVWvUX,aXiV,vAuW->', h['ab'][c,A,v,V], lambdas['abb'], t['ab'][pv,pA,hc,hA], t['ab'][pa,pV,ha,hA], optimize=True)
	X['0'] += -1.0 * np.einsum('iUaA,uVWvUX,aXuW,vAiV->', h['ab'][c,A,v,V], lambdas['abb'], t['ab'][pv,pA,ha,hA], t['ab'][pa,pV,hc,hA], optimize=True)
	X['0'] += 1.0 * np.einsum('iUaA,uVWvUX,aAuW,vXiV->', h['ab'][c,A,v,V], lambdas['abb'], t['ab'][pv,pV,ha,hA], t['ab'][pa,pA,hc,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('iUaA,uVWvUX,XAVW,vaiu->', h['ab'][c,A,v,V], lambdas['abb'], t['bb'][pA,pV,hA,hA], t['aa'][pa,pv,hc,ha], optimize=True)
	X['0'] += -0.5 * np.einsum('iUaA,VWXUYZ,YAWX,aZiV->', h['ab'][c,A,v,V], lambdas['bbb'], t['bb'][pA,pV,hA,hA], t['ab'][pv,pA,hc,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('uIaA,vwxuyz,yAxI,zavw->', h['ab'][a,C,v,V], lambdas['aaa'], t['ab'][pa,pV,ha,hC], t['aa'][pa,pv,ha,ha], optimize=True)
	X['0'] += 1.0 * np.einsum('uIaA,vwUuxV,aVwI,xAvU->', h['ab'][a,C,v,V], lambdas['aab'], t['ab'][pv,pA,ha,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['0'] += -1.0 * np.einsum('uIaA,vwUuxV,aVwU,xAvI->', h['ab'][a,C,v,V], lambdas['aab'], t['ab'][pv,pA,ha,hA], t['ab'][pa,pV,ha,hC], optimize=True)
	X['0'] += 1.0 * np.einsum('uIaA,vwUuxV,aAwU,xVvI->', h['ab'][a,C,v,V], lambdas['aab'], t['ab'][pv,pV,ha,hA], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += 0.5 * np.einsum('uIaA,vwUuxV,VAIU,xavw->', h['ab'][a,C,v,V], lambdas['aab'], t['bb'][pA,pV,hC,hA], t['aa'][pa,pv,ha,ha], optimize=True)
	X['0'] += -0.5 * np.einsum('uIaA,vUVuWX,WXIV,aAvU->', h['ab'][a,C,v,V], lambdas['abb'], t['bb'][pA,pA,hC,hA], t['ab'][pv,pV,ha,hA], optimize=True)
	X['0'] += 1.0 * np.einsum('uIaA,vUVuWX,WAIV,aXvU->', h['ab'][a,C,v,V], lambdas['abb'], t['bb'][pA,pV,hC,hA], t['ab'][pv,pA,ha,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('uIaA,vUVuWX,WAUV,aXvI->', h['ab'][a,C,v,V], lambdas['abb'], t['bb'][pA,pV,hA,hA], t['ab'][pv,pA,ha,hC], optimize=True)
	X['0'] += -1.0 * np.einsum('IJUA,uvUwxV,wAvI,xVuJ->', h['bb'][C,C,A,V], lambdas['aab'], t['ab'][pa,pV,ha,hC], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += 0.25 * np.einsum('IJUA,uUVvWX,WXIJ,vAuV->', h['bb'][C,C,A,V], lambdas['abb'], t['bb'][pA,pA,hC,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['0'] += -0.5 * np.einsum('IJUA,uUVvWX,WXIV,vAuJ->', h['bb'][C,C,A,V], lambdas['abb'], t['bb'][pA,pA,hC,hA], t['ab'][pa,pV,ha,hC], optimize=True)
	X['0'] += 1.0 * np.einsum('IJUA,uUVvWX,WAIV,vXuJ->', h['bb'][C,C,A,V], lambdas['abb'], t['bb'][pA,pV,hC,hA], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += -0.5 * np.einsum('IJUA,UVWXYZ,XAIW,YZJV->', h['bb'][C,C,A,V], lambdas['bbb'], t['bb'][pA,pV,hC,hA], t['bb'][pA,pA,hC,hA], optimize=True)
	X['0'] += -0.125 * np.einsum('IJUA,UVWXYZ,XAVW,YZIJ->', h['bb'][C,C,A,V], lambdas['bbb'], t['bb'][pA,pV,hA,hA], t['bb'][pA,pA,hC,hC], optimize=True)
	X['0'] += -0.5 * np.einsum('IJAB,uvwx,wAvI,xBuJ->', h['bb'][C,C,V,V], lambdas['aa'], t['ab'][pa,pV,ha,hC], t['ab'][pa,pV,ha,hC], optimize=True)
	X['0'] += 0.5 * np.einsum('IJAB,uUvV,VAIJ,vBuU->', h['bb'][C,C,V,V], lambdas['ab'], t['bb'][pA,pV,hC,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['0'] += -1.0 * np.einsum('IJAB,uUvV,VAIU,vBuJ->', h['bb'][C,C,V,V], lambdas['ab'], t['bb'][pA,pV,hC,hA], t['ab'][pa,pV,ha,hC], optimize=True)
	X['0'] += -0.5 * np.einsum('IJAB,uUvV,ABIU,vVuJ->', h['bb'][C,C,V,V], lambdas['ab'], t['bb'][pV,pV,hC,hA], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += -0.5 * np.einsum('IJAB,UVWX,WAIV,XBJU->', h['bb'][C,C,V,V], lambdas['bb'], t['bb'][pA,pV,hC,hA], t['bb'][pA,pV,hC,hA], optimize=True)
	X['0'] += -0.25 * np.einsum('IJAB,UVWX,WAUV,XBIJ->', h['bb'][C,C,V,V], lambdas['bb'], t['bb'][pA,pV,hA,hA], t['bb'][pA,pV,hC,hC], optimize=True)
	X['0'] += 0.25 * np.einsum('IJAB,UVWX,ABIV,WXJU->', h['bb'][C,C,V,V], lambdas['bb'], t['bb'][pV,pV,hC,hA], t['bb'][pA,pA,hC,hA], optimize=True)
	X['0'] += 0.0625 * np.einsum('IJAB,UVWX,ABUV,WXIJ->', h['bb'][C,C,V,V], lambdas['bb'], t['bb'][pV,pV,hA,hA], t['bb'][pA,pA,hC,hC], optimize=True)
	X['0'] += 1.0 * np.einsum('IUAB,uvVwxU,wAvV,xBuI->', h['bb'][C,A,V,V], lambdas['aab'], t['ab'][pa,pV,ha,hA], t['ab'][pa,pV,ha,hC], optimize=True)
	X['0'] += -1.0 * np.einsum('IUAB,uVWvUX,XAIW,vBuV->', h['bb'][C,A,V,V], lambdas['abb'], t['bb'][pA,pV,hC,hA], t['ab'][pa,pV,ha,hA], optimize=True)
	X['0'] += 0.5 * np.einsum('IUAB,uVWvUX,XAVW,vBuI->', h['bb'][C,A,V,V], lambdas['abb'], t['bb'][pA,pV,hA,hA], t['ab'][pa,pV,ha,hC], optimize=True)
	X['0'] += 0.25 * np.einsum('IUAB,uVWvUX,ABVW,vXuI->', h['bb'][C,A,V,V], lambdas['abb'], t['bb'][pV,pV,hA,hA], t['ab'][pa,pA,ha,hC], optimize=True)
	X['0'] += -0.5 * np.einsum('IUAB,VWXUYZ,YAWX,ZBIV->', h['bb'][C,A,V,V], lambdas['bbb'], t['bb'][pA,pV,hA,hA], t['bb'][pA,pV,hC,hA], optimize=True)
	X['0'] += 0.125 * np.einsum('IUAB,VWXUYZ,ABWX,YZIV->', h['bb'][C,A,V,V], lambdas['bbb'], t['bb'][pV,pV,hA,hA], t['bb'][pA,pA,hC,hA], optimize=True)
	toc = time.time()
	elapsed_time = toc - tic
	if verbose:
		print(f'Took {elapsed_time} seconds.')
	return X


def H_T_ncomm2_nbody2(X, h, t, gamma1, eta1, lambdas, orbspace, verbose=False):
	tic = time.time()
	c = orbspace['core_alpha']
	C = orbspace['core_beta']
	a = orbspace['active_alpha']
	A = orbspace['active_beta']
	v = orbspace['virt_alpha']
	V = orbspace['virt_beta']
	hc = orbspace['hole_core_alpha']
	hC = orbspace['hole_core_beta']
	ha = orbspace['hole_active_alpha']
	hA = orbspace['hole_active_beta']
	pa = orbspace['particle_active_alpha']
	pA = orbspace['particle_active_beta']
	pv = orbspace['particle_virt_alpha']
	pV = orbspace['particle_virt_beta']

	# AA|VA
	X['bb'][pA,pV,hA,hA] += -0.5 * np.einsum('iIaB,UBVW,aAiI->UAVW', h['ab'][c,C,v,V], t['bb'][pA,pV,hA,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pA,pV,hA,hA] += -0.25 * np.einsum('IJBC,ACIJ,UBVW->UAVW', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hA,hA], optimize=True)
	# AA|VV
	X['bb'][pV,pV,hA,hA] += 0.5 * np.einsum('WX,iIaW,XAUV,aBiI->ABUV', eta1['b'], h['ab'][c,C,v,A], t['bb'][pA,pV,hA,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pV,pV,hA,hA] += 0.125 * np.einsum('WX,IJWC,ABIJ,XCUV->ABUV', eta1['b'], h['bb'][C,C,A,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hA,hA], optimize=True)
	X['bb'][pV,pV,hA,hA] += -0.25 * np.einsum('WX,IJWC,ACIJ,XBUV->ABUV', eta1['b'], h['bb'][C,C,A,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hA,hA], optimize=True)
	X['bb'][pV,pV,hA,hA] += 0.5 * np.einsum('WX,iIaW,XAUV,aBiI->ABUV', gamma1['b'], h['ab'][c,C,v,A], t['bb'][pA,pV,hA,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pV,pV,hA,hA] += -0.25 * np.einsum('WX,IJWC,ACIJ,XBUV->ABUV', gamma1['b'], h['bb'][C,C,A,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hA,hA], optimize=True)
	X['bb'][pV,pV,hA,hA] += -0.5 * np.einsum('iIaC,ACUV,aBiI->ABUV', h['ab'][c,C,v,V], t['bb'][pV,pV,hA,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pV,pV,hA,hA] += -0.25 * np.einsum('IJCD,ACUV,BDIJ->ABUV', h['bb'][C,C,V,V], t['bb'][pV,pV,hA,hA], t['bb'][pV,pV,hC,hC], optimize=True)
	X['bb'][pV,pV,hA,hA] += 0.0625 * np.einsum('IJCD,CDUV,ABIJ->ABUV', h['bb'][C,C,V,V], t['bb'][pV,pV,hA,hA], t['bb'][pV,pV,hC,hC], optimize=True)
	# CA|AA
	X['bb'][pA,pA,hC,hA] += -0.5 * np.einsum('iJaA,UVJW,aAiI->UVIW', h['ab'][c,C,v,V], t['bb'][pA,pA,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pA,pA,hC,hA] += -0.25 * np.einsum('JKAB,ABIK,UVJW->UVIW', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pA,hC,hA], optimize=True)
	# CA|VA
	X['bb'][pA,pV,hC,hA] += 1.0 * np.einsum('uv,ijua,aAiI,vUjV->UAIV', eta1['a'], h['aa'][c,c,a,v], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += -1.0 * np.einsum('uv,iJuB,ABIJ,vUiV->UAIV', eta1['a'], h['ab'][c,C,a,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += -1.0 * np.einsum('WX,iJaW,UXIV,aAiJ->UAIV', eta1['b'], h['ab'][c,C,v,A], t['bb'][pA,pA,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pA,pV,hC,hA] += 1.0 * np.einsum('WX,iJaW,UXJV,aAiI->UAIV', eta1['b'], h['ab'][c,C,v,A], t['bb'][pA,pA,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pA,pV,hC,hA] += 1.0 * np.einsum('WX,iXaB,UAVW,aBiI->UAIV', eta1['b'], h['ab'][c,A,v,V], t['bb'][pA,pV,hA,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pA,pV,hC,hA] += 1.0 * np.einsum('WX,JKWB,ABIK,UXJV->UAIV', eta1['b'], h['bb'][C,C,A,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pA,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += -0.5 * np.einsum('WX,JKWB,ABJK,UXIV->UAIV', eta1['b'], h['bb'][C,C,A,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pA,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += -0.5 * np.einsum('WX,JXBC,BCIJ,UAVW->UAIV', eta1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hA,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += 1.0 * np.einsum('uv,ivab,bAiI,aUuV->UAIV', gamma1['a'], h['aa'][c,a,v,v], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += -1.0 * np.einsum('uv,vJaB,ABIJ,aUuV->UAIV', gamma1['a'], h['ab'][a,C,v,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pA,ha,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += -1.0 * np.einsum('WX,iJaW,UXIV,aAiJ->UAIV', gamma1['b'], h['ab'][c,C,v,A], t['bb'][pA,pA,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pA,pV,hC,hA] += 1.0 * np.einsum('WX,iXaB,UAVW,aBiI->UAIV', gamma1['b'], h['ab'][c,A,v,V], t['bb'][pA,pV,hA,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pA,pV,hC,hA] += -1.0 * np.einsum('WX,iXaB,UBVW,aAiI->UAIV', gamma1['b'], h['ab'][c,A,v,V], t['bb'][pA,pV,hA,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pA,pV,hC,hA] += -0.5 * np.einsum('WX,JKWB,ABJK,UXIV->UAIV', gamma1['b'], h['bb'][C,C,A,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pA,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += 1.0 * np.einsum('WX,JXBC,ACIJ,UBVW->UAIV', gamma1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hA,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += -0.5 * np.einsum('WX,JXBC,BCIJ,UAVW->UAIV', gamma1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hA,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += -1.0 * np.einsum('ijab,bAjI,aUiV->UAIV', h['aa'][c,c,v,v], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,hc,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += -1.0 * np.einsum('iJaB,UAJV,aBiI->UAIV', h['ab'][c,C,v,V], t['bb'][pA,pV,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pA,pV,hC,hA] += -1.0 * np.einsum('iJaB,UBIV,aAiJ->UAIV', h['ab'][c,C,v,V], t['bb'][pA,pV,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pA,pV,hC,hA] += 1.0 * np.einsum('iJaB,UBJV,aAiI->UAIV', h['ab'][c,C,v,V], t['bb'][pA,pV,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pA,pV,hC,hA] += -1.0 * np.einsum('iJaB,ABIJ,aUiV->UAIV', h['ab'][c,C,v,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pA,hc,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += 1.0 * np.einsum('JKBC,ACIK,UBJV->UAIV', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += -0.5 * np.einsum('JKBC,ACJK,UBIV->UAIV', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hA] += -0.5 * np.einsum('JKBC,BCIK,UAJV->UAIV', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hC,hA], optimize=True)
	# CA|VV
	X['bb'][pV,pV,hC,hA] += 1.0 * np.einsum('uv,wx,ivwa,aAiI,xBuU->ABIU', eta1['a'], gamma1['a'], h['aa'][c,a,a,v], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += -1.0 * np.einsum('uv,wx,ixua,aAiI,vBwU->ABIU', eta1['a'], gamma1['a'], h['aa'][c,a,a,v], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += -1.0 * np.einsum('uv,wx,vJwC,ACIJ,xBuU->ABIU', eta1['a'], gamma1['a'], h['ab'][a,C,a,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += -0.5 * np.einsum('uv,wx,xJuC,ABIJ,vCwU->ABIU', eta1['a'], gamma1['a'], h['ab'][a,C,a,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += 1.0 * np.einsum('uv,wx,xJuC,ACIJ,vBwU->ABIU', eta1['a'], gamma1['a'], h['ab'][a,C,a,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += -1.0 * np.einsum('uv,ijua,aAiI,vBjU->ABIU', eta1['a'], h['aa'][c,c,a,v], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,hc,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += -0.5 * np.einsum('uv,iJuC,ABIJ,vCiU->ABIU', eta1['a'], h['ab'][c,C,a,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pV,hc,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += 1.0 * np.einsum('uv,iJuC,ACIJ,vBiU->ABIU', eta1['a'], h['ab'][c,C,a,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pV,hc,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += -0.5 * np.einsum('VW,uv,iJuV,ABIJ,vWiU->ABIU', eta1['b'], eta1['a'], h['ab'][c,C,a,A], t['bb'][pV,pV,hC,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += -0.25 * np.einsum('VW,XY,JKVX,ABIK,WYJU->ABIU', eta1['b'], eta1['b'], h['bb'][C,C,A,A], t['bb'][pV,pV,hC,hC], t['bb'][pA,pA,hC,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += 0.125 * np.einsum('VW,XY,JKVX,ABJK,WYIU->ABIU', eta1['b'], eta1['b'], h['bb'][C,C,A,A], t['bb'][pV,pV,hC,hC], t['bb'][pA,pA,hC,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += -0.5 * np.einsum('VW,uv,vJaV,ABIJ,aWuU->ABIU', eta1['b'], gamma1['a'], h['ab'][a,C,v,A], t['bb'][pV,pV,hC,hC], t['ab'][pv,pA,ha,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += -1.0 * np.einsum('VW,XY,iWaX,YAUV,aBiI->ABIU', eta1['b'], gamma1['b'], h['ab'][c,A,v,A], t['bb'][pA,pV,hA,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pV,pV,hC,hA] += 1.0 * np.einsum('VW,XY,iYaV,WAUX,aBiI->ABIU', eta1['b'], gamma1['b'], h['ab'][c,A,v,A], t['bb'][pA,pV,hA,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pV,pV,hC,hA] += -1.0 * np.einsum('VW,XY,JWXC,ACIJ,YBUV->ABIU', eta1['b'], gamma1['b'], h['bb'][C,A,A,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hA,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += -0.5 * np.einsum('VW,XY,JYVC,ABIJ,WCUX->ABIU', eta1['b'], gamma1['b'], h['bb'][C,A,A,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hA,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += 1.0 * np.einsum('VW,XY,JYVC,ACIJ,WBUX->ABIU', eta1['b'], gamma1['b'], h['bb'][C,A,A,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hA,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += 1.0 * np.einsum('VW,iJaV,WAIU,aBiJ->ABIU', eta1['b'], h['ab'][c,C,v,A], t['bb'][pA,pV,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pV,pV,hC,hA] += -1.0 * np.einsum('VW,iJaV,WAJU,aBiI->ABIU', eta1['b'], h['ab'][c,C,v,A], t['bb'][pA,pV,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pV,pV,hC,hA] += -0.5 * np.einsum('VW,iJaV,ABIJ,aWiU->ABIU', eta1['b'], h['ab'][c,C,v,A], t['bb'][pV,pV,hC,hC], t['ab'][pv,pA,hc,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += 0.5 * np.einsum('VW,iWaC,ABUV,aCiI->ABIU', eta1['b'], h['ab'][c,A,v,V], t['bb'][pV,pV,hA,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pV,pV,hC,hA] += -0.5 * np.einsum('VW,JKVC,ABIK,WCJU->ABIU', eta1['b'], h['bb'][C,C,A,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += 0.25 * np.einsum('VW,JKVC,ABJK,WCIU->ABIU', eta1['b'], h['bb'][C,C,A,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += 1.0 * np.einsum('VW,JKVC,ACIK,WBJU->ABIU', eta1['b'], h['bb'][C,C,A,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += -0.5 * np.einsum('VW,JKVC,ACJK,WBIU->ABIU', eta1['b'], h['bb'][C,C,A,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += -0.25 * np.einsum('VW,JWCD,ABUV,CDIJ->ABIU', eta1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hA,hA], t['bb'][pV,pV,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hA] += 1.0 * np.einsum('uv,ivab,aAuU,bBiI->ABIU', gamma1['a'], h['aa'][c,a,v,v], t['ab'][pv,pV,ha,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pV,pV,hC,hA] += -0.5 * np.einsum('uv,vJaC,ABIJ,aCuU->ABIU', gamma1['a'], h['ab'][a,C,v,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pV,ha,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += 1.0 * np.einsum('uv,vJaC,ACIJ,aBuU->ABIU', gamma1['a'], h['ab'][a,C,v,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pV,ha,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += -0.125 * np.einsum('VW,XY,JKVX,ABJK,WYIU->ABIU', gamma1['b'], gamma1['b'], h['bb'][C,C,A,A], t['bb'][pV,pV,hC,hC], t['bb'][pA,pA,hC,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += 1.0 * np.einsum('VW,iJaV,WAIU,aBiJ->ABIU', gamma1['b'], h['ab'][c,C,v,A], t['bb'][pA,pV,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pV,pV,hC,hA] += 0.5 * np.einsum('VW,iWaC,ABUV,aCiI->ABIU', gamma1['b'], h['ab'][c,A,v,V], t['bb'][pV,pV,hA,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pV,pV,hC,hA] += -1.0 * np.einsum('VW,iWaC,ACUV,aBiI->ABIU', gamma1['b'], h['ab'][c,A,v,V], t['bb'][pV,pV,hA,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pV,pV,hC,hA] += -0.5 * np.einsum('VW,JKVC,ACJK,WBIU->ABIU', gamma1['b'], h['bb'][C,C,A,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += -0.25 * np.einsum('VW,JWCD,ABUV,CDIJ->ABIU', gamma1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hA,hA], t['bb'][pV,pV,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hA] += 1.0 * np.einsum('VW,JWCD,ACUV,BDIJ->ABIU', gamma1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hA,hA], t['bb'][pV,pV,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hA] += -0.25 * np.einsum('VW,JWCD,CDUV,ABIJ->ABIU', gamma1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hA,hA], t['bb'][pV,pV,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hA] += -1.0 * np.einsum('ijab,aAiU,bBjI->ABIU', h['aa'][c,c,v,v], t['ab'][pv,pV,hc,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pV,pV,hC,hA] += -0.5 * np.einsum('iJaC,ABIJ,aCiU->ABIU', h['ab'][c,C,v,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pV,hc,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += -0.5 * np.einsum('iJaC,ABJU,aCiI->ABIU', h['ab'][c,C,v,V], t['bb'][pV,pV,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pV,pV,hC,hA] += 1.0 * np.einsum('iJaC,ACIJ,aBiU->ABIU', h['ab'][c,C,v,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pV,hc,hA], optimize=True)
	X['bb'][pV,pV,hC,hA] += -1.0 * np.einsum('iJaC,ACIU,aBiJ->ABIU', h['ab'][c,C,v,V], t['bb'][pV,pV,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pV,pV,hC,hA] += 1.0 * np.einsum('iJaC,ACJU,aBiI->ABIU', h['ab'][c,C,v,V], t['bb'][pV,pV,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pV,pV,hC,hA] += -0.25 * np.einsum('JKCD,ABJU,CDIK->ABIU', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hA], t['bb'][pV,pV,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hA] += -0.5 * np.einsum('JKCD,ACIU,BDJK->ABIU', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hA], t['bb'][pV,pV,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hA] += 1.0 * np.einsum('JKCD,ACJU,BDIK->ABIU', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hA], t['bb'][pV,pV,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hA] += 0.125 * np.einsum('JKCD,CDIU,ABJK->ABIU', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hA], t['bb'][pV,pV,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hA] += -0.25 * np.einsum('JKCD,CDJU,ABIK->ABIU', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hA], t['bb'][pV,pV,hC,hC], optimize=True)
	# CC|AA
	X['bb'][pA,pA,hC,hC] += -0.5 * np.einsum('WX,iXaA,UVIW,aAiJ->UVIJ', eta1['b'], h['ab'][c,A,v,V], t['bb'][pA,pA,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pA,pA,hC,hC] += -0.25 * np.einsum('WX,KXAB,ABIK,UVJW->UVIJ', eta1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pA,hC,hA], optimize=True)
	X['bb'][pA,pA,hC,hC] += -0.5 * np.einsum('WX,iXaA,UVIW,aAiJ->UVIJ', gamma1['b'], h['ab'][c,A,v,V], t['bb'][pA,pA,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pA,pA,hC,hC] += 0.125 * np.einsum('WX,KXAB,ABIJ,UVKW->UVIJ', gamma1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pA,hC,hA], optimize=True)
	X['bb'][pA,pA,hC,hC] += -0.25 * np.einsum('WX,KXAB,ABIK,UVJW->UVIJ', gamma1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pA,hC,hA], optimize=True)
	X['bb'][pA,pA,hC,hC] += -0.5 * np.einsum('iKaA,UVIK,aAiJ->UVIJ', h['ab'][c,C,v,V], t['bb'][pA,pA,hC,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pA,pA,hC,hC] += 0.0625 * np.einsum('KLAB,ABIJ,UVKL->UVIJ', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pA,hC,hC], optimize=True)
	X['bb'][pA,pA,hC,hC] += -0.25 * np.einsum('KLAB,ABIK,UVJL->UVIJ', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pA,hC,hC], optimize=True)
	# CC|VA
	X['bb'][pA,pV,hC,hC] += -1.0 * np.einsum('uv,wx,ivwa,aAiI,xUuJ->UAIJ', eta1['a'], gamma1['a'], h['aa'][c,a,a,v], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,ha,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += 1.0 * np.einsum('uv,wx,ixua,aAiI,vUwJ->UAIJ', eta1['a'], gamma1['a'], h['aa'][c,a,a,v], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,ha,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += 1.0 * np.einsum('uv,wx,vKwB,ABIK,xUuJ->UAIJ', eta1['a'], gamma1['a'], h['ab'][a,C,a,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pA,ha,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += 0.5 * np.einsum('uv,wx,xKuB,ABIJ,vUwK->UAIJ', eta1['a'], gamma1['a'], h['ab'][a,C,a,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pA,ha,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += -1.0 * np.einsum('uv,wx,xKuB,ABIK,vUwJ->UAIJ', eta1['a'], gamma1['a'], h['ab'][a,C,a,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pA,ha,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += 0.5 * np.einsum('uv,VW,iWuB,ABIJ,vUiV->UAIJ', eta1['a'], gamma1['b'], h['ab'][c,A,a,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['bb'][pA,pV,hC,hC] += 1.0 * np.einsum('uv,ijua,aAiI,vUjJ->UAIJ', eta1['a'], h['aa'][c,c,a,v], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += 0.5 * np.einsum('uv,iKuB,ABIJ,vUiK->UAIJ', eta1['a'], h['ab'][c,C,a,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pA,hc,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += -1.0 * np.einsum('uv,iKuB,ABIK,vUiJ->UAIJ', eta1['a'], h['ab'][c,C,a,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pA,hc,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += -0.125 * np.einsum('VW,XY,WYBC,BCIJ,UAVX->UAIJ', eta1['b'], eta1['b'], h['bb'][A,A,V,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hA,hA], optimize=True)
	X['bb'][pA,pV,hC,hC] += -1.0 * np.einsum('VW,XY,iWaX,UYIV,aAiJ->UAIJ', eta1['b'], gamma1['b'], h['ab'][c,A,v,A], t['bb'][pA,pA,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += 1.0 * np.einsum('VW,XY,iYaV,UWIX,aAiJ->UAIJ', eta1['b'], gamma1['b'], h['ab'][c,A,v,A], t['bb'][pA,pA,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += -1.0 * np.einsum('VW,XY,KWXB,ABIK,UYJV->UAIJ', eta1['b'], gamma1['b'], h['bb'][C,A,A,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pA,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hC] += -0.5 * np.einsum('VW,XY,KYVB,ABIJ,UWKX->UAIJ', eta1['b'], gamma1['b'], h['bb'][C,A,A,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pA,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hC] += 1.0 * np.einsum('VW,XY,KYVB,ABIK,UWJX->UAIJ', eta1['b'], gamma1['b'], h['bb'][C,A,A,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pA,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hC] += -0.5 * np.einsum('VW,iKaV,UWIJ,aAiK->UAIJ', eta1['b'], h['ab'][c,C,v,A], t['bb'][pA,pA,hC,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += 1.0 * np.einsum('VW,iKaV,UWIK,aAiJ->UAIJ', eta1['b'], h['ab'][c,C,v,A], t['bb'][pA,pA,hC,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += -1.0 * np.einsum('VW,iWaB,UAIV,aBiJ->UAIJ', eta1['b'], h['ab'][c,A,v,V], t['bb'][pA,pV,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += -0.25 * np.einsum('VW,KLVB,ABIJ,UWKL->UAIJ', eta1['b'], h['bb'][C,C,A,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pA,hC,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += 1.0 * np.einsum('VW,KLVB,ABIK,UWJL->UAIJ', eta1['b'], h['bb'][C,C,A,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pA,hC,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += -0.25 * np.einsum('VW,KLVB,ABKL,UWIJ->UAIJ', eta1['b'], h['bb'][C,C,A,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pA,hC,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += -0.5 * np.einsum('VW,KWBC,BCIK,UAJV->UAIJ', eta1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hC] += 1.0 * np.einsum('uv,ivab,bAiI,aUuJ->UAIJ', gamma1['a'], h['aa'][c,a,v,v], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += 0.5 * np.einsum('uv,vKaB,ABIJ,aUuK->UAIJ', gamma1['a'], h['ab'][a,C,v,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pA,ha,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += -1.0 * np.einsum('uv,vKaB,ABIK,aUuJ->UAIJ', gamma1['a'], h['ab'][a,C,v,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pA,ha,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += 0.5 * np.einsum('VW,uv,vWaB,ABIJ,aUuV->UAIJ', gamma1['b'], gamma1['a'], h['ab'][a,A,v,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pA,ha,hA], optimize=True)
	X['bb'][pA,pV,hC,hC] += -0.25 * np.einsum('VW,XY,WYBC,ACIJ,UBVX->UAIJ', gamma1['b'], gamma1['b'], h['bb'][A,A,V,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hA,hA], optimize=True)
	X['bb'][pA,pV,hC,hC] += 0.125 * np.einsum('VW,XY,WYBC,BCIJ,UAVX->UAIJ', gamma1['b'], gamma1['b'], h['bb'][A,A,V,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hA,hA], optimize=True)
	X['bb'][pA,pV,hC,hC] += -0.5 * np.einsum('VW,iKaV,UWIJ,aAiK->UAIJ', gamma1['b'], h['ab'][c,C,v,A], t['bb'][pA,pA,hC,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += -1.0 * np.einsum('VW,iWaB,UAIV,aBiJ->UAIJ', gamma1['b'], h['ab'][c,A,v,V], t['bb'][pA,pV,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += 1.0 * np.einsum('VW,iWaB,UBIV,aAiJ->UAIJ', gamma1['b'], h['ab'][c,A,v,V], t['bb'][pA,pV,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += 0.5 * np.einsum('VW,iWaB,ABIJ,aUiV->UAIJ', gamma1['b'], h['ab'][c,A,v,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pA,hc,hA], optimize=True)
	X['bb'][pA,pV,hC,hC] += -0.25 * np.einsum('VW,KLVB,ABKL,UWIJ->UAIJ', gamma1['b'], h['bb'][C,C,A,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pA,hC,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += -0.5 * np.einsum('VW,KWBC,ACIJ,UBKV->UAIJ', gamma1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hC] += 1.0 * np.einsum('VW,KWBC,ACIK,UBJV->UAIJ', gamma1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hC] += 0.25 * np.einsum('VW,KWBC,BCIJ,UAKV->UAIJ', gamma1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hC] += -0.5 * np.einsum('VW,KWBC,BCIK,UAJV->UAIJ', gamma1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pA,pV,hC,hC] += -1.0 * np.einsum('ijab,aAiI,bUjJ->UAIJ', h['aa'][c,c,v,v], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,hc,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += -1.0 * np.einsum('iKaB,UAIK,aBiJ->UAIJ', h['ab'][c,C,v,V], t['bb'][pA,pV,hC,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += -0.5 * np.einsum('iKaB,UBIJ,aAiK->UAIJ', h['ab'][c,C,v,V], t['bb'][pA,pV,hC,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += 1.0 * np.einsum('iKaB,UBIK,aAiJ->UAIJ', h['ab'][c,C,v,V], t['bb'][pA,pV,hC,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += 0.5 * np.einsum('iKaB,ABIJ,aUiK->UAIJ', h['ab'][c,C,v,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pA,hc,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += -1.0 * np.einsum('iKaB,ABIK,aUiJ->UAIJ', h['ab'][c,C,v,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pA,hc,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += 0.25 * np.einsum('KLBC,ABIJ,UCKL->UAIJ', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hC,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += -1.0 * np.einsum('KLBC,ABIK,UCJL->UAIJ', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hC,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += 0.25 * np.einsum('KLBC,ABKL,UCIJ->UAIJ', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hC,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += 0.125 * np.einsum('KLBC,BCIJ,UAKL->UAIJ', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hC,hC], optimize=True)
	X['bb'][pA,pV,hC,hC] += -0.5 * np.einsum('KLBC,BCIK,UAJL->UAIJ', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hC,hC], optimize=True)
	# CC|VV
	X['bb'][pV,pV,hC,hC] += 1.0 * np.einsum('uv,wx,ivwa,aAiI,xBuJ->ABIJ', eta1['a'], gamma1['a'], h['aa'][c,a,a,v], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += -1.0 * np.einsum('uv,wx,ixua,aAiI,vBwJ->ABIJ', eta1['a'], gamma1['a'], h['aa'][c,a,a,v], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += -1.0 * np.einsum('uv,wx,vKwC,ACIK,xBuJ->ABIJ', eta1['a'], gamma1['a'], h['ab'][a,C,a,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pV,ha,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += -0.5 * np.einsum('uv,wx,xKuC,ABIK,vCwJ->ABIJ', eta1['a'], gamma1['a'], h['ab'][a,C,a,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pV,ha,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += -0.5 * np.einsum('uv,wx,xKuC,ACIJ,vBwK->ABIJ', eta1['a'], gamma1['a'], h['ab'][a,C,a,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pV,ha,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += 1.0 * np.einsum('uv,wx,xKuC,ACIK,vBwJ->ABIJ', eta1['a'], gamma1['a'], h['ab'][a,C,a,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pV,ha,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += -0.5 * np.einsum('uv,UV,wx,vKwU,ABIK,xVuJ->ABIJ', eta1['a'], gamma1['b'], gamma1['a'], h['ab'][a,C,a,A], t['bb'][pV,pV,hC,hC], t['ab'][pa,pA,ha,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += -0.5 * np.einsum('uv,UV,wx,xVuC,ACIJ,vBwU->ABIJ', eta1['a'], gamma1['b'], gamma1['a'], h['ab'][a,A,a,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['bb'][pV,pV,hC,hC] += -0.5 * np.einsum('uv,UV,iVuC,ACIJ,vBiU->ABIJ', eta1['a'], gamma1['b'], h['ab'][c,A,a,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pV,hc,hA], optimize=True)
	X['bb'][pV,pV,hC,hC] += -1.0 * np.einsum('uv,ijua,aAiI,vBjJ->ABIJ', eta1['a'], h['aa'][c,c,a,v], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,hc,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += -0.5 * np.einsum('uv,iKuC,ABIK,vCiJ->ABIJ', eta1['a'], h['ab'][c,C,a,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pV,hc,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += -0.5 * np.einsum('uv,iKuC,ACIJ,vBiK->ABIJ', eta1['a'], h['ab'][c,C,a,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pV,hc,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += 1.0 * np.einsum('uv,iKuC,ACIK,vBiJ->ABIJ', eta1['a'], h['ab'][c,C,a,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pV,hc,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += -0.5 * np.einsum('UV,uv,wx,vVwC,ACIJ,xBuU->ABIJ', eta1['b'], eta1['a'], gamma1['a'], h['ab'][a,A,a,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['bb'][pV,pV,hC,hC] += -0.5 * np.einsum('UV,uv,wx,xKuU,ABIK,vVwJ->ABIJ', eta1['b'], eta1['a'], gamma1['a'], h['ab'][a,C,a,A], t['bb'][pV,pV,hC,hC], t['ab'][pa,pA,ha,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += -0.5 * np.einsum('UV,uv,iKuU,ABIK,vViJ->ABIJ', eta1['b'], eta1['a'], h['ab'][c,C,a,A], t['bb'][pV,pV,hC,hC], t['ab'][pa,pA,hc,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += -0.25 * np.einsum('UV,WX,YZ,KZUW,ABIK,VXJY->ABIJ', eta1['b'], eta1['b'], gamma1['b'], h['bb'][C,A,A,A], t['bb'][pV,pV,hC,hC], t['bb'][pA,pA,hC,hA], optimize=True)
	X['bb'][pV,pV,hC,hC] += -0.25 * np.einsum('UV,WX,YZ,VXYC,ACIJ,ZBUW->ABIJ', eta1['b'], eta1['b'], gamma1['b'], h['bb'][A,A,A,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hA,hA], optimize=True)
	X['bb'][pV,pV,hC,hC] += -0.25 * np.einsum('UV,WX,KLUW,ABIK,VXJL->ABIJ', eta1['b'], eta1['b'], h['bb'][C,C,A,A], t['bb'][pV,pV,hC,hC], t['bb'][pA,pA,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += 0.0625 * np.einsum('UV,WX,KLUW,ABKL,VXIJ->ABIJ', eta1['b'], eta1['b'], h['bb'][C,C,A,A], t['bb'][pV,pV,hC,hC], t['bb'][pA,pA,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += -0.0625 * np.einsum('UV,WX,VXCD,ABUW,CDIJ->ABIJ', eta1['b'], eta1['b'], h['bb'][A,A,V,V], t['bb'][pV,pV,hA,hA], t['bb'][pV,pV,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += -0.5 * np.einsum('UV,uv,vKaU,ABIK,aVuJ->ABIJ', eta1['b'], gamma1['a'], h['ab'][a,C,v,A], t['bb'][pV,pV,hC,hC], t['ab'][pv,pA,ha,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += -0.25 * np.einsum('UV,WX,YZ,KVWY,ABIK,XZJU->ABIJ', eta1['b'], gamma1['b'], gamma1['b'], h['bb'][C,A,A,A], t['bb'][pV,pV,hC,hC], t['bb'][pA,pA,hC,hA], optimize=True)
	X['bb'][pV,pV,hC,hC] += -0.25 * np.einsum('UV,WX,YZ,XZUC,ACIJ,VBWY->ABIJ', eta1['b'], gamma1['b'], gamma1['b'], h['bb'][A,A,A,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hA,hA], optimize=True)
	X['bb'][pV,pV,hC,hC] += 1.0 * np.einsum('UV,WX,iVaW,XAIU,aBiJ->ABIJ', eta1['b'], gamma1['b'], h['ab'][c,A,v,A], t['bb'][pA,pV,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += -1.0 * np.einsum('UV,WX,iXaU,VAIW,aBiJ->ABIJ', eta1['b'], gamma1['b'], h['ab'][c,A,v,A], t['bb'][pA,pV,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += -1.0 * np.einsum('UV,WX,KVWC,ACIK,XBJU->ABIJ', eta1['b'], gamma1['b'], h['bb'][C,A,A,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pV,pV,hC,hC] += -0.5 * np.einsum('UV,WX,KXUC,ABIK,VCJW->ABIJ', eta1['b'], gamma1['b'], h['bb'][C,A,A,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pV,pV,hC,hC] += -0.5 * np.einsum('UV,WX,KXUC,ACIJ,VBKW->ABIJ', eta1['b'], gamma1['b'], h['bb'][C,A,A,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pV,pV,hC,hC] += 1.0 * np.einsum('UV,WX,KXUC,ACIK,VBJW->ABIJ', eta1['b'], gamma1['b'], h['bb'][C,A,A,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hC,hA], optimize=True)
	X['bb'][pV,pV,hC,hC] += 0.5 * np.einsum('UV,iKaU,VAIJ,aBiK->ABIJ', eta1['b'], h['ab'][c,C,v,A], t['bb'][pA,pV,hC,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += -1.0 * np.einsum('UV,iKaU,VAIK,aBiJ->ABIJ', eta1['b'], h['ab'][c,C,v,A], t['bb'][pA,pV,hC,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += -0.5 * np.einsum('UV,iKaU,ABIK,aViJ->ABIJ', eta1['b'], h['ab'][c,C,v,A], t['bb'][pV,pV,hC,hC], t['ab'][pv,pA,hc,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += -0.5 * np.einsum('UV,iVaC,ABIU,aCiJ->ABIJ', eta1['b'], h['ab'][c,A,v,V], t['bb'][pV,pV,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += -0.5 * np.einsum('UV,KLUC,ABIK,VCJL->ABIJ', eta1['b'], h['bb'][C,C,A,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += 0.125 * np.einsum('UV,KLUC,ABKL,VCIJ->ABIJ', eta1['b'], h['bb'][C,C,A,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += -0.25 * np.einsum('UV,KLUC,ACIJ,VBKL->ABIJ', eta1['b'], h['bb'][C,C,A,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += 1.0 * np.einsum('UV,KLUC,ACIK,VBJL->ABIJ', eta1['b'], h['bb'][C,C,A,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += -0.25 * np.einsum('UV,KLUC,ACKL,VBIJ->ABIJ', eta1['b'], h['bb'][C,C,A,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += 0.25 * np.einsum('UV,KVCD,ABIU,CDJK->ABIJ', eta1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hC,hA], t['bb'][pV,pV,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += -1.0 * np.einsum('uv,ivab,aAuI,bBiJ->ABIJ', gamma1['a'], h['aa'][c,a,v,v], t['ab'][pv,pV,ha,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += -0.5 * np.einsum('uv,vKaC,ABIK,aCuJ->ABIJ', gamma1['a'], h['ab'][a,C,v,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pV,ha,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += -0.5 * np.einsum('uv,vKaC,ACIJ,aBuK->ABIJ', gamma1['a'], h['ab'][a,C,v,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pV,ha,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += 1.0 * np.einsum('uv,vKaC,ACIK,aBuJ->ABIJ', gamma1['a'], h['ab'][a,C,v,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pV,ha,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += -0.5 * np.einsum('UV,uv,vVaC,ACIJ,aBuU->ABIJ', gamma1['b'], gamma1['a'], h['ab'][a,A,v,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pV,ha,hA], optimize=True)
	X['bb'][pV,pV,hC,hC] += -0.0625 * np.einsum('UV,WX,KLUW,ABKL,VXIJ->ABIJ', gamma1['b'], gamma1['b'], h['bb'][C,C,A,A], t['bb'][pV,pV,hC,hC], t['bb'][pA,pA,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += 0.0625 * np.einsum('UV,WX,VXCD,ABUW,CDIJ->ABIJ', gamma1['b'], gamma1['b'], h['bb'][A,A,V,V], t['bb'][pV,pV,hA,hA], t['bb'][pV,pV,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += -0.25 * np.einsum('UV,WX,VXCD,ACUW,BDIJ->ABIJ', gamma1['b'], gamma1['b'], h['bb'][A,A,V,V], t['bb'][pV,pV,hA,hA], t['bb'][pV,pV,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += 0.5 * np.einsum('UV,iKaU,VAIJ,aBiK->ABIJ', gamma1['b'], h['ab'][c,C,v,A], t['bb'][pA,pV,hC,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += -0.5 * np.einsum('UV,iVaC,ABIU,aCiJ->ABIJ', gamma1['b'], h['ab'][c,A,v,V], t['bb'][pV,pV,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += -0.5 * np.einsum('UV,iVaC,ACIJ,aBiU->ABIJ', gamma1['b'], h['ab'][c,A,v,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pV,hc,hA], optimize=True)
	X['bb'][pV,pV,hC,hC] += 1.0 * np.einsum('UV,iVaC,ACIU,aBiJ->ABIJ', gamma1['b'], h['ab'][c,A,v,V], t['bb'][pV,pV,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += -0.25 * np.einsum('UV,KLUC,ACKL,VBIJ->ABIJ', gamma1['b'], h['bb'][C,C,A,V], t['bb'][pV,pV,hC,hC], t['bb'][pA,pV,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += 0.25 * np.einsum('UV,KVCD,ABIU,CDJK->ABIJ', gamma1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hC,hA], t['bb'][pV,pV,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += 0.125 * np.einsum('UV,KVCD,ABKU,CDIJ->ABIJ', gamma1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hC,hA], t['bb'][pV,pV,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += -1.0 * np.einsum('UV,KVCD,ACIU,BDJK->ABIJ', gamma1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hC,hA], t['bb'][pV,pV,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += -0.5 * np.einsum('UV,KVCD,ACKU,BDIJ->ABIJ', gamma1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hC,hA], t['bb'][pV,pV,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += 0.25 * np.einsum('UV,KVCD,CDIU,ABJK->ABIJ', gamma1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hC,hA], t['bb'][pV,pV,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += 0.5 * np.einsum('ijab,bAjI,aBiJ->ABIJ', h['aa'][c,c,v,v], t['ab'][pv,pV,hc,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += -0.5 * np.einsum('iKaC,ABIK,aCiJ->ABIJ', h['ab'][c,C,v,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += -0.5 * np.einsum('iKaC,ACIJ,aBiK->ABIJ', h['ab'][c,C,v,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += 1.0 * np.einsum('iKaC,ACIK,aBiJ->ABIJ', h['ab'][c,C,v,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += 0.25 * np.einsum('KLCD,ABIL,CDJK->ABIJ', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hC], t['bb'][pV,pV,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += 0.0625 * np.einsum('KLCD,ABKL,CDIJ->ABIJ', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hC], t['bb'][pV,pV,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += 0.25 * np.einsum('KLCD,ADIJ,BCKL->ABIJ', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hC], t['bb'][pV,pV,hC,hC], optimize=True)
	X['bb'][pV,pV,hC,hC] += 0.5 * np.einsum('KLCD,ADIL,BCJK->ABIJ', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hC], t['bb'][pV,pV,hC,hC], optimize=True)
	# aA|Av
	X['ab'][pv,pA,ha,hA] += -0.5 * np.einsum('ijbc,bUuV,acij->aUuV', h['aa'][c,c,v,v], t['ab'][pv,pA,ha,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pA,ha,hA] += -1.0 * np.einsum('iIbA,aAiI,bUuV->aUuV', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hA], optimize=True)
	# aA|Va
	X['ab'][pa,pV,ha,hA] += -1.0 * np.einsum('iIaB,aAiI,uBvU->uAvU', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,ha,hA] += 0.5 * np.einsum('IJBC,ABIJ,uCvU->uAvU', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	# aA|Vv
	X['ab'][pv,pV,ha,hA] += -0.5 * np.einsum('vw,ijvb,abij,wAuU->aAuU', eta1['a'], h['aa'][c,c,a,v], t['aa'][pv,pv,hc,hc], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += 1.0 * np.einsum('vw,iIvB,aAiI,wBuU->aAuU', eta1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += -1.0 * np.einsum('vw,iIvB,aBiI,wAuU->aAuU', eta1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += 1.0 * np.einsum('VW,iIbV,aAiI,bWuU->aAuU', eta1['b'], h['ab'][c,C,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += -1.0 * np.einsum('VW,iIbV,bAiI,aWuU->aAuU', eta1['b'], h['ab'][c,C,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += -0.5 * np.einsum('VW,IJVB,ABIJ,aWuU->aAuU', eta1['b'], h['bb'][C,C,A,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += -0.5 * np.einsum('vw,ijvb,abij,wAuU->aAuU', gamma1['a'], h['aa'][c,c,a,v], t['aa'][pv,pv,hc,hc], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += -1.0 * np.einsum('vw,iIvB,aBiI,wAuU->aAuU', gamma1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += -1.0 * np.einsum('VW,iIbV,bAiI,aWuU->aAuU', gamma1['b'], h['ab'][c,C,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += -0.5 * np.einsum('VW,IJVB,ABIJ,aWuU->aAuU', gamma1['b'], h['bb'][C,C,A,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hA] += -0.5 * np.einsum('ijbc,bAuU,acij->aAuU', h['aa'][c,c,v,v], t['ab'][pv,pV,ha,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pV,ha,hA] += -1.0 * np.einsum('iIbB,aBuU,bAiI->aAuU', h['ab'][c,C,v,V], t['ab'][pv,pV,ha,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,ha,hA] += -1.0 * np.einsum('iIbB,bAuU,aBiI->aAuU', h['ab'][c,C,v,V], t['ab'][pv,pV,ha,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,ha,hA] += 1.0 * np.einsum('iIbB,bBuU,aAiI->aAuU', h['ab'][c,C,v,V], t['ab'][pv,pV,ha,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,ha,hA] += 0.5 * np.einsum('IJBC,ABIJ,aCuU->aAuU', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pV,ha,hA], optimize=True)
	# aC|Aa
	X['ab'][pa,pA,ha,hC] += -1.0 * np.einsum('iJaA,aAiI,uUvJ->uUvI', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pA,ha,hC] += 0.5 * np.einsum('JKAB,ABIJ,uUvK->uUvI', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pA,ha,hC], optimize=True)
	# aC|Av
	X['ab'][pv,pA,ha,hC] += -0.5 * np.einsum('vw,ijvb,abij,wUuI->aUuI', eta1['a'], h['aa'][c,c,a,v], t['aa'][pv,pv,hc,hc], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,ha,hC] += 1.0 * np.einsum('vw,iJvA,aAiI,wUuJ->aUuI', eta1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,ha,hC] += -1.0 * np.einsum('vw,iJvA,aAiJ,wUuI->aUuI', eta1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,ha,hC] += -1.0 * np.einsum('VW,iWbA,bAiI,aUuV->aUuI', eta1['b'], h['ab'][c,A,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,ha,hC] += 0.5 * np.einsum('VW,JWAB,ABIJ,aUuV->aUuI', eta1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,ha,hC] += -0.5 * np.einsum('vw,ijvb,abij,wUuI->aUuI', gamma1['a'], h['aa'][c,c,a,v], t['aa'][pv,pv,hc,hc], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,ha,hC] += -1.0 * np.einsum('vw,iJvA,aAiJ,wUuI->aUuI', gamma1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,ha,hC] += 1.0 * np.einsum('VW,iWbA,aAiI,bUuV->aUuI', gamma1['b'], h['ab'][c,A,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,ha,hC] += -1.0 * np.einsum('VW,iWbA,bAiI,aUuV->aUuI', gamma1['b'], h['ab'][c,A,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,ha,hC] += 0.5 * np.einsum('VW,JWAB,ABIJ,aUuV->aUuI', gamma1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,ha,hC] += -0.5 * np.einsum('ijbc,bUuI,acij->aUuI', h['aa'][c,c,v,v], t['ab'][pv,pA,ha,hC], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pA,ha,hC] += 1.0 * np.einsum('iJbA,aAiI,bUuJ->aUuI', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,ha,hC] += -1.0 * np.einsum('iJbA,aAiJ,bUuI->aUuI', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,ha,hC] += -1.0 * np.einsum('iJbA,bAiI,aUuJ->aUuI', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,ha,hC] += 0.5 * np.einsum('JKAB,ABIJ,aUuK->aUuI', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pA,ha,hC], optimize=True)
	# aC|Va
	X['ab'][pa,pV,ha,hC] += 1.0 * np.einsum('wx,ijwa,aAiI,uxjv->uAvI', eta1['a'], h['aa'][c,c,a,v], t['ab'][pv,pV,hc,hC], t['aa'][pa,pa,hc,ha], optimize=True)
	X['ab'][pa,pV,ha,hC] += -1.0 * np.einsum('wx,iJwB,ABIJ,uxiv->uAvI', eta1['a'], h['ab'][c,C,a,V], t['bb'][pV,pV,hC,hC], t['aa'][pa,pa,hc,ha], optimize=True)
	X['ab'][pa,pV,ha,hC] += 1.0 * np.einsum('UV,iJaU,aAiI,uVvJ->uAvI', eta1['b'], h['ab'][c,C,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += -1.0 * np.einsum('UV,iJaU,aAiJ,uVvI->uAvI', eta1['b'], h['ab'][c,C,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += -1.0 * np.einsum('UV,iVaB,aBiI,uAvU->uAvI', eta1['b'], h['ab'][c,A,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,ha,hC] += -1.0 * np.einsum('UV,JKUB,ABIJ,uVvK->uAvI', eta1['b'], h['bb'][C,C,A,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += -0.5 * np.einsum('UV,JKUB,ABJK,uVvI->uAvI', eta1['b'], h['bb'][C,C,A,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += 0.5 * np.einsum('UV,JVBC,BCIJ,uAvU->uAvI', eta1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,ha,hC] += -1.0 * np.einsum('wx,ixab,bAiI,uavw->uAvI', gamma1['a'], h['aa'][c,a,v,v], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,ha,ha], optimize=True)
	X['ab'][pa,pV,ha,hC] += 1.0 * np.einsum('wx,xJaB,ABIJ,uavw->uAvI', gamma1['a'], h['ab'][a,C,v,V], t['bb'][pV,pV,hC,hC], t['aa'][pa,pv,ha,ha], optimize=True)
	X['ab'][pa,pV,ha,hC] += -1.0 * np.einsum('UV,iJaU,aAiJ,uVvI->uAvI', gamma1['b'], h['ab'][c,C,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += 1.0 * np.einsum('UV,iVaB,aAiI,uBvU->uAvI', gamma1['b'], h['ab'][c,A,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,ha,hC] += -1.0 * np.einsum('UV,iVaB,aBiI,uAvU->uAvI', gamma1['b'], h['ab'][c,A,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,ha,hC] += -0.5 * np.einsum('UV,JKUB,ABJK,uVvI->uAvI', gamma1['b'], h['bb'][C,C,A,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += 1.0 * np.einsum('UV,JVBC,ABIJ,uCvU->uAvI', gamma1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,ha,hC] += 0.5 * np.einsum('UV,JVBC,BCIJ,uAvU->uAvI', gamma1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,ha,hC] += -1.0 * np.einsum('ijab,aAiI,ubjv->uAvI', h['aa'][c,c,v,v], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,hc,ha], optimize=True)
	X['ab'][pa,pV,ha,hC] += 1.0 * np.einsum('iJaB,aAiI,uBvJ->uAvI', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += -1.0 * np.einsum('iJaB,aAiJ,uBvI->uAvI', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += -1.0 * np.einsum('iJaB,aBiI,uAvJ->uAvI', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += -1.0 * np.einsum('iJaB,ABIJ,uaiv->uAvI', h['ab'][c,C,v,V], t['bb'][pV,pV,hC,hC], t['aa'][pa,pv,hc,ha], optimize=True)
	X['ab'][pa,pV,ha,hC] += 1.0 * np.einsum('JKBC,ABIJ,uCvK->uAvI', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += 0.5 * np.einsum('JKBC,ABJK,uCvI->uAvI', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pa,pV,ha,hC] += 0.5 * np.einsum('JKBC,BCIJ,uAvK->uAvI', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pV,ha,hC], optimize=True)
	# aC|Vv
	X['ab'][pv,pV,ha,hC] += 0.5 * np.einsum('vw,xy,ijvx,aAiI,wyju->aAuI', eta1['a'], eta1['a'], h['aa'][c,c,a,a], t['ab'][pv,pV,hc,hC], t['aa'][pa,pa,hc,ha], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('vw,xy,iwxb,bAiI,yauv->aAuI', eta1['a'], gamma1['a'], h['aa'][c,a,a,v], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,ha,ha], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('vw,xy,iyvb,aAiI,wbux->aAuI', eta1['a'], gamma1['a'], h['aa'][c,a,a,v], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,ha,ha], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('vw,xy,iyvb,bAiI,waux->aAuI', eta1['a'], gamma1['a'], h['aa'][c,a,a,v], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,ha,ha], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('vw,xy,wJxB,ABIJ,yauv->aAuI', eta1['a'], gamma1['a'], h['ab'][a,C,a,V], t['bb'][pV,pV,hC,hC], t['aa'][pa,pv,ha,ha], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('vw,xy,yJvB,ABIJ,waux->aAuI', eta1['a'], gamma1['a'], h['ab'][a,C,a,V], t['bb'][pV,pV,hC,hC], t['aa'][pa,pv,ha,ha], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('vw,UV,iVvB,aAiI,wBuU->aAuI', eta1['a'], gamma1['b'], h['ab'][c,A,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('vw,UV,iVvB,aBiI,wAuU->aAuI', eta1['a'], gamma1['b'], h['ab'][c,A,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hC] += -0.5 * np.einsum('vw,ijvb,abij,wAuI->aAuI', eta1['a'], h['aa'][c,c,a,v], t['aa'][pv,pv,hc,hc], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('vw,ijvb,aAiI,wbju->aAuI', eta1['a'], h['aa'][c,c,a,v], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,hc,ha], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('vw,ijvb,bAiI,waju->aAuI', eta1['a'], h['aa'][c,c,a,v], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,hc,ha], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('vw,iJvB,aAiI,wBuJ->aAuI', eta1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('vw,iJvB,aAiJ,wBuI->aAuI', eta1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('vw,iJvB,aBiI,wAuJ->aAuI', eta1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('vw,iJvB,aBiJ,wAuI->aAuI', eta1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('vw,iJvB,ABIJ,waiu->aAuI', eta1['a'], h['ab'][c,C,a,V], t['bb'][pV,pV,hC,hC], t['aa'][pa,pv,hc,ha], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('UV,vw,iJvU,aAiI,wVuJ->aAuI', eta1['b'], eta1['a'], h['ab'][c,C,a,A], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('UV,vw,iJvU,aAiJ,wVuI->aAuI', eta1['b'], eta1['a'], h['ab'][c,C,a,A], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('UV,vw,iVvB,aBiI,wAuU->aAuI', eta1['b'], gamma1['a'], h['ab'][c,A,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('UV,WX,iVbW,bAiI,aXuU->aAuI', eta1['b'], gamma1['b'], h['ab'][c,A,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('UV,WX,iXbU,aAiI,bVuW->aAuI', eta1['b'], gamma1['b'], h['ab'][c,A,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('UV,WX,iXbU,bAiI,aVuW->aAuI', eta1['b'], gamma1['b'], h['ab'][c,A,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('UV,WX,JVWB,ABIJ,aXuU->aAuI', eta1['b'], gamma1['b'], h['bb'][C,A,A,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('UV,WX,JXUB,ABIJ,aVuW->aAuI', eta1['b'], gamma1['b'], h['bb'][C,A,A,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('UV,iJbU,aAiI,bVuJ->aAuI', eta1['b'], h['ab'][c,C,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('UV,iJbU,aAiJ,bVuI->aAuI', eta1['b'], h['ab'][c,C,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('UV,iJbU,bAiI,aVuJ->aAuI', eta1['b'], h['ab'][c,C,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('UV,iJbU,bAiJ,aVuI->aAuI', eta1['b'], h['ab'][c,C,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('UV,iVbB,aAuU,bBiI->aAuI', eta1['b'], h['ab'][c,A,v,V], t['ab'][pv,pV,ha,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('UV,JKUB,ABIJ,aVuK->aAuI', eta1['b'], h['bb'][C,C,A,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += -0.5 * np.einsum('UV,JKUB,ABJK,aVuI->aAuI', eta1['b'], h['bb'][C,C,A,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += 0.5 * np.einsum('UV,JVBC,BCIJ,aAuU->aAuI', eta1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hC] += -0.5 * np.einsum('vw,ijvb,abij,wAuI->aAuI', gamma1['a'], h['aa'][c,c,a,v], t['aa'][pv,pv,hc,hc], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += -0.5 * np.einsum('vw,iwbc,aAiI,bcuv->aAuI', gamma1['a'], h['aa'][c,a,v,v], t['ab'][pv,pV,hc,hC], t['aa'][pv,pv,ha,ha], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('vw,iwbc,cAiI,abuv->aAuI', gamma1['a'], h['aa'][c,a,v,v], t['ab'][pv,pV,hc,hC], t['aa'][pv,pv,ha,ha], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('vw,iJvB,aBiJ,wAuI->aAuI', gamma1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('vw,wJbB,ABIJ,abuv->aAuI', gamma1['a'], h['ab'][a,C,v,V], t['bb'][pV,pV,hC,hC], t['aa'][pv,pv,ha,ha], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('UV,vw,iJvU,aAiJ,wVuI->aAuI', gamma1['b'], gamma1['a'], h['ab'][c,C,a,A], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('UV,iJbU,bAiJ,aVuI->aAuI', gamma1['b'], h['ab'][c,C,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('UV,iVbB,aAuU,bBiI->aAuI', gamma1['b'], h['ab'][c,A,v,V], t['ab'][pv,pV,ha,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('UV,iVbB,aBuU,bAiI->aAuI', gamma1['b'], h['ab'][c,A,v,V], t['ab'][pv,pV,ha,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('UV,iVbB,bAuU,aBiI->aAuI', gamma1['b'], h['ab'][c,A,v,V], t['ab'][pv,pV,ha,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('UV,iVbB,bBuU,aAiI->aAuI', gamma1['b'], h['ab'][c,A,v,V], t['ab'][pv,pV,ha,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += -0.5 * np.einsum('UV,JKUB,ABJK,aVuI->aAuI', gamma1['b'], h['bb'][C,C,A,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('UV,JVBC,ABIJ,aCuU->aAuI', gamma1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hC] += 0.5 * np.einsum('UV,JVBC,BCIJ,aAuU->aAuI', gamma1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,ha,hC] += 0.5 * np.einsum('ijbc,aAiI,bcju->aAuI', h['aa'][c,c,v,v], t['ab'][pv,pV,hc,hC], t['aa'][pv,pv,hc,ha], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('ijbc,bAiI,acju->aAuI', h['aa'][c,c,v,v], t['ab'][pv,pV,hc,hC], t['aa'][pv,pv,hc,ha], optimize=True)
	X['ab'][pv,pV,ha,hC] += -0.5 * np.einsum('ijbc,bAuI,acij->aAuI', h['aa'][c,c,v,v], t['ab'][pv,pV,ha,hC], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('iJbB,aAuJ,bBiI->aAuI', h['ab'][c,C,v,V], t['ab'][pv,pV,ha,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('iJbB,aBuI,bAiJ->aAuI', h['ab'][c,C,v,V], t['ab'][pv,pV,ha,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('iJbB,aBuJ,bAiI->aAuI', h['ab'][c,C,v,V], t['ab'][pv,pV,ha,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('iJbB,bAuI,aBiJ->aAuI', h['ab'][c,C,v,V], t['ab'][pv,pV,ha,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('iJbB,bAuJ,aBiI->aAuI', h['ab'][c,C,v,V], t['ab'][pv,pV,ha,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('iJbB,bBuI,aAiJ->aAuI', h['ab'][c,C,v,V], t['ab'][pv,pV,ha,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('iJbB,bBuJ,aAiI->aAuI', h['ab'][c,C,v,V], t['ab'][pv,pV,ha,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += -1.0 * np.einsum('iJbB,ABIJ,abiu->aAuI', h['ab'][c,C,v,V], t['bb'][pV,pV,hC,hC], t['aa'][pv,pv,hc,ha], optimize=True)
	X['ab'][pv,pV,ha,hC] += 1.0 * np.einsum('JKBC,ABIJ,aCuK->aAuI', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += 0.5 * np.einsum('JKBC,ABJK,aCuI->aAuI', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,ha,hC] += 0.5 * np.einsum('JKBC,BCIJ,aAuK->aAuI', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pV,ha,hC], optimize=True)
	# aa|va
	X['aa'][pa,pv,ha,ha] += -0.25 * np.einsum('ijbc,acij,ubvw->uavw', h['aa'][c,c,v,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pa,pv,ha,ha] += -0.5 * np.einsum('iIbA,aAiI,ubvw->uavw', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,ha,ha], optimize=True)
	# aa|vv
	X['aa'][pv,pv,ha,ha] += 0.125 * np.einsum('wx,ijwc,abij,xcuv->abuv', eta1['a'], h['aa'][c,c,a,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pv,pv,ha,ha] += -0.25 * np.einsum('wx,ijwc,acij,xbuv->abuv', eta1['a'], h['aa'][c,c,a,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pv,pv,ha,ha] += -0.5 * np.einsum('wx,iIwA,aAiI,xbuv->abuv', eta1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pv,pv,ha,ha] += -0.25 * np.einsum('wx,ijwc,acij,xbuv->abuv', gamma1['a'], h['aa'][c,c,a,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pv,pv,ha,ha] += -0.5 * np.einsum('wx,iIwA,aAiI,xbuv->abuv', gamma1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pv,pv,ha,ha] += -0.25 * np.einsum('ijcd,acuv,bdij->abuv', h['aa'][c,c,v,v], t['aa'][pv,pv,ha,ha], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,ha,ha] += 0.0625 * np.einsum('ijcd,cduv,abij->abuv', h['aa'][c,c,v,v], t['aa'][pv,pv,ha,ha], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,ha,ha] += 0.5 * np.einsum('iIcA,aAiI,bcuv->abuv', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['aa'][pv,pv,ha,ha], optimize=True)
	# cA|Aa
	X['ab'][pa,pA,hc,hA] += -0.5 * np.einsum('jkab,abik,uUjV->uUiV', h['aa'][c,c,v,v], t['aa'][pv,pv,hc,hc], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pA,hc,hA] += -1.0 * np.einsum('jIaA,aAiI,uUjV->uUiV', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	# cA|Av
	X['ab'][pv,pA,hc,hA] += 1.0 * np.einsum('uv,jkub,abik,vUjV->aUiV', eta1['a'], h['aa'][c,c,a,v], t['aa'][pv,pv,hc,hc], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += -0.5 * np.einsum('uv,jkub,abjk,vUiV->aUiV', eta1['a'], h['aa'][c,c,a,v], t['aa'][pv,pv,hc,hc], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += 0.5 * np.einsum('uv,jvbc,aUuV,bcij->aUiV', eta1['a'], h['aa'][c,a,v,v], t['ab'][pv,pA,ha,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pA,hc,hA] += 1.0 * np.einsum('uv,jIuA,aAiI,vUjV->aUiV', eta1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += -1.0 * np.einsum('uv,jIuA,aAjI,vUiV->aUiV', eta1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += -1.0 * np.einsum('uv,vIbA,bAiI,aUuV->aUiV', eta1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += -1.0 * np.einsum('WX,jIbW,UXIV,abij->aUiV', eta1['b'], h['ab'][c,C,v,A], t['bb'][pA,pA,hC,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pA,hc,hA] += -1.0 * np.einsum('WX,IJWA,UXIV,aAiJ->aUiV', eta1['b'], h['bb'][C,C,A,V], t['bb'][pA,pA,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hA] += -0.5 * np.einsum('uv,jkub,abjk,vUiV->aUiV', gamma1['a'], h['aa'][c,c,a,v], t['aa'][pv,pv,hc,hc], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += 0.5 * np.einsum('uv,jvbc,aUuV,bcij->aUiV', gamma1['a'], h['aa'][c,a,v,v], t['ab'][pv,pA,ha,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pA,hc,hA] += -1.0 * np.einsum('uv,jvbc,bUuV,acij->aUiV', gamma1['a'], h['aa'][c,a,v,v], t['ab'][pv,pA,ha,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pA,hc,hA] += -1.0 * np.einsum('uv,jIuA,aAjI,vUiV->aUiV', gamma1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += 1.0 * np.einsum('uv,vIbA,aAiI,bUuV->aUiV', gamma1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += -1.0 * np.einsum('uv,vIbA,bAiI,aUuV->aUiV', gamma1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += 1.0 * np.einsum('WX,jXbA,UAVW,abij->aUiV', gamma1['b'], h['ab'][c,A,v,V], t['bb'][pA,pV,hA,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pA,hc,hA] += -1.0 * np.einsum('WX,IXAB,UAVW,aBiI->aUiV', gamma1['b'], h['bb'][C,A,V,V], t['bb'][pA,pV,hA,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hA] += -0.5 * np.einsum('jkbc,aUjV,bcik->aUiV', h['aa'][c,c,v,v], t['ab'][pv,pA,hc,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pA,hc,hA] += -0.5 * np.einsum('jkbc,bUiV,acjk->aUiV', h['aa'][c,c,v,v], t['ab'][pv,pA,hc,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pA,hc,hA] += 1.0 * np.einsum('jkbc,bUjV,acik->aUiV', h['aa'][c,c,v,v], t['ab'][pv,pA,hc,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pA,hc,hA] += 1.0 * np.einsum('jIbA,aAiI,bUjV->aUiV', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += -1.0 * np.einsum('jIbA,aAjI,bUiV->aUiV', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += -1.0 * np.einsum('jIbA,bAiI,aUjV->aUiV', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hA] += -1.0 * np.einsum('jIbA,UAIV,abij->aUiV', h['ab'][c,C,v,V], t['bb'][pA,pV,hC,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pA,hc,hA] += -1.0 * np.einsum('IJAB,UAIV,aBiJ->aUiV', h['bb'][C,C,V,V], t['bb'][pA,pV,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	# cA|Va
	X['ab'][pa,pV,hc,hA] += 0.5 * np.einsum('vw,jwab,abij,uAvU->uAiU', eta1['a'], h['aa'][c,a,v,v], t['aa'][pv,pv,hc,hc], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += -1.0 * np.einsum('vw,wIaB,aBiI,uAvU->uAiU', eta1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += 1.0 * np.einsum('VW,jIaV,aAiI,uWjU->uAiU', eta1['b'], h['ab'][c,C,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += -1.0 * np.einsum('VW,jIaV,aAjI,uWiU->uAiU', eta1['b'], h['ab'][c,C,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += -0.5 * np.einsum('VW,IJVB,ABIJ,uWiU->uAiU', eta1['b'], h['bb'][C,C,A,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += 0.5 * np.einsum('vw,jwab,abij,uAvU->uAiU', gamma1['a'], h['aa'][c,a,v,v], t['aa'][pv,pv,hc,hc], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += 1.0 * np.einsum('vw,wIaB,aAiI,uBvU->uAiU', gamma1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += -1.0 * np.einsum('vw,wIaB,aBiI,uAvU->uAiU', gamma1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += -1.0 * np.einsum('VW,jIaV,aAjI,uWiU->uAiU', gamma1['b'], h['ab'][c,C,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += -0.5 * np.einsum('VW,IJVB,ABIJ,uWiU->uAiU', gamma1['b'], h['bb'][C,C,A,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += -0.5 * np.einsum('jkab,abik,uAjU->uAiU', h['aa'][c,c,v,v], t['aa'][pv,pv,hc,hc], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += 1.0 * np.einsum('jIaB,aAiI,uBjU->uAiU', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += -1.0 * np.einsum('jIaB,aAjI,uBiU->uAiU', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += -1.0 * np.einsum('jIaB,aBiI,uAjU->uAiU', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hA] += 0.5 * np.einsum('IJBC,ABIJ,uCiU->uAiU', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pV,hc,hA], optimize=True)
	# cA|Vv
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('uv,wx,jvwb,abij,xAuU->aAiU', eta1['a'], gamma1['a'], h['aa'][c,a,a,v], t['aa'][pv,pv,hc,hc], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('uv,wx,jxub,abij,vAwU->aAiU', eta1['a'], gamma1['a'], h['aa'][c,a,a,v], t['aa'][pv,pv,hc,hc], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('uv,wx,vIwB,aBiI,xAuU->aAiU', eta1['a'], gamma1['a'], h['ab'][a,C,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('uv,wx,xIuB,aAiI,vBwU->aAiU', eta1['a'], gamma1['a'], h['ab'][a,C,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('uv,wx,xIuB,aBiI,vAwU->aAiU', eta1['a'], gamma1['a'], h['ab'][a,C,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('uv,VW,vIbV,bAiI,aWuU->aAiU', eta1['a'], gamma1['b'], h['ab'][a,C,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('uv,jkub,abik,vAjU->aAiU', eta1['a'], h['aa'][c,c,a,v], t['aa'][pv,pv,hc,hc], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += -0.5 * np.einsum('uv,jkub,abjk,vAiU->aAiU', eta1['a'], h['aa'][c,c,a,v], t['aa'][pv,pv,hc,hc], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += 0.5 * np.einsum('uv,jvbc,aAuU,bcij->aAiU', eta1['a'], h['aa'][c,a,v,v], t['ab'][pv,pV,ha,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('uv,jIuB,aAiI,vBjU->aAiU', eta1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('uv,jIuB,aAjI,vBiU->aAiU', eta1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('uv,jIuB,aBiI,vAjU->aAiU', eta1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('uv,jIuB,aBjI,vAiU->aAiU', eta1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('uv,vIbB,aAuU,bBiI->aAiU', eta1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,ha,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('VW,uv,jIuV,aAiI,vWjU->aAiU', eta1['b'], eta1['a'], h['ab'][c,C,a,A], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('VW,uv,jIuV,aAjI,vWiU->aAiU', eta1['b'], eta1['a'], h['ab'][c,C,a,A], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += -0.5 * np.einsum('VW,XY,IJVX,WYIU,aAiJ->aAiU', eta1['b'], eta1['b'], h['bb'][C,C,A,A], t['bb'][pA,pA,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('VW,uv,vIbV,aAiI,bWuU->aAiU', eta1['b'], gamma1['a'], h['ab'][a,C,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('VW,uv,vIbV,bAiI,aWuU->aAiU', eta1['b'], gamma1['a'], h['ab'][a,C,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('VW,XY,jWbX,YAUV,abij->aAiU', eta1['b'], gamma1['b'], h['ab'][c,A,v,A], t['bb'][pA,pV,hA,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('VW,XY,jYbV,WAUX,abij->aAiU', eta1['b'], gamma1['b'], h['ab'][c,A,v,A], t['bb'][pA,pV,hA,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('VW,XY,IWXB,YAUV,aBiI->aAiU', eta1['b'], gamma1['b'], h['bb'][C,A,A,V], t['bb'][pA,pV,hA,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('VW,XY,IYVB,WAUX,aBiI->aAiU', eta1['b'], gamma1['b'], h['bb'][C,A,A,V], t['bb'][pA,pV,hA,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('VW,XY,IYVB,WBUX,aAiI->aAiU', eta1['b'], gamma1['b'], h['bb'][C,A,A,V], t['bb'][pA,pV,hA,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('VW,jIbV,aAiI,bWjU->aAiU', eta1['b'], h['ab'][c,C,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('VW,jIbV,aAjI,bWiU->aAiU', eta1['b'], h['ab'][c,C,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('VW,jIbV,bAiI,aWjU->aAiU', eta1['b'], h['ab'][c,C,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('VW,jIbV,bAjI,aWiU->aAiU', eta1['b'], h['ab'][c,C,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('VW,jIbV,WAIU,abij->aAiU', eta1['b'], h['ab'][c,C,v,A], t['bb'][pA,pV,hC,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('VW,IJVB,WAIU,aBiJ->aAiU', eta1['b'], h['bb'][C,C,A,V], t['bb'][pA,pV,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('VW,IJVB,WBIU,aAiJ->aAiU', eta1['b'], h['bb'][C,C,A,V], t['bb'][pA,pV,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hA] += -0.5 * np.einsum('VW,IJVB,ABIJ,aWiU->aAiU', eta1['b'], h['bb'][C,C,A,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += -0.5 * np.einsum('uv,jkub,abjk,vAiU->aAiU', gamma1['a'], h['aa'][c,c,a,v], t['aa'][pv,pv,hc,hc], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += 0.5 * np.einsum('uv,jvbc,aAuU,bcij->aAiU', gamma1['a'], h['aa'][c,a,v,v], t['ab'][pv,pV,ha,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('uv,jvbc,bAuU,acij->aAiU', gamma1['a'], h['aa'][c,a,v,v], t['ab'][pv,pV,ha,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('uv,jIuB,aBjI,vAiU->aAiU', gamma1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('uv,vIbB,aAuU,bBiI->aAiU', gamma1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,ha,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('uv,vIbB,aBuU,bAiI->aAiU', gamma1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,ha,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('uv,vIbB,bAuU,aBiI->aAiU', gamma1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,ha,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('uv,vIbB,bBuU,aAiI->aAiU', gamma1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,ha,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('VW,uv,jIuV,aAjI,vWiU->aAiU', gamma1['b'], gamma1['a'], h['ab'][c,C,a,A], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('VW,jIbV,bAjI,aWiU->aAiU', gamma1['b'], h['ab'][c,C,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('VW,jWbB,ABUV,abij->aAiU', gamma1['b'], h['ab'][c,A,v,V], t['bb'][pV,pV,hA,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pV,hc,hA] += -0.5 * np.einsum('VW,IJVB,ABIJ,aWiU->aAiU', gamma1['b'], h['bb'][C,C,A,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('VW,IWBC,ABUV,aCiI->aAiU', gamma1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hA,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hA] += -0.5 * np.einsum('VW,IWBC,BCUV,aAiI->aAiU', gamma1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hA,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hA] += -0.5 * np.einsum('jkbc,aAjU,bcik->aAiU', h['aa'][c,c,v,v], t['ab'][pv,pV,hc,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pV,hc,hA] += -0.5 * np.einsum('jkbc,bAiU,acjk->aAiU', h['aa'][c,c,v,v], t['ab'][pv,pV,hc,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('jkbc,bAjU,acik->aAiU', h['aa'][c,c,v,v], t['ab'][pv,pV,hc,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('jIbB,aAjU,bBiI->aAiU', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('jIbB,aBiU,bAjI->aAiU', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('jIbB,aBjU,bAiI->aAiU', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('jIbB,bAiU,aBjI->aAiU', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('jIbB,bAjU,aBiI->aAiU', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hA] += 1.0 * np.einsum('jIbB,bBiU,aAjI->aAiU', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('jIbB,bBjU,aAiI->aAiU', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('jIbB,ABIU,abij->aAiU', h['ab'][c,C,v,V], t['bb'][pV,pV,hC,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pV,hc,hA] += 0.5 * np.einsum('IJBC,ABIJ,aCiU->aAiU', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hA] += -1.0 * np.einsum('IJBC,ABIU,aCiJ->aAiU', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hA] += -0.5 * np.einsum('IJBC,BCIU,aAiJ->aAiU', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	# cC|Aa
	X['ab'][pa,pA,hc,hC] += 0.5 * np.einsum('vw,jwab,abij,uUvI->uUiI', eta1['a'], h['aa'][c,a,v,v], t['aa'][pv,pv,hc,hc], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pA,hc,hC] += -1.0 * np.einsum('vw,wJaA,aAiJ,uUvI->uUiI', eta1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pA,hc,hC] += -1.0 * np.einsum('VW,jWaA,aAjI,uUiV->uUiI', eta1['b'], h['ab'][c,A,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pA,hc,hC] += 0.5 * np.einsum('VW,JWAB,ABIJ,uUiV->uUiI', eta1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pA,hc,hC] += 0.5 * np.einsum('vw,jwab,abij,uUvI->uUiI', gamma1['a'], h['aa'][c,a,v,v], t['aa'][pv,pv,hc,hc], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pA,hc,hC] += 1.0 * np.einsum('vw,wJaA,aAiI,uUvJ->uUiI', gamma1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pA,hc,hC] += -1.0 * np.einsum('vw,wJaA,aAiJ,uUvI->uUiI', gamma1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pA,hc,hC] += 1.0 * np.einsum('VW,jWaA,aAiI,uUjV->uUiI', gamma1['b'], h['ab'][c,A,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pA,hc,hC] += -1.0 * np.einsum('VW,jWaA,aAjI,uUiV->uUiI', gamma1['b'], h['ab'][c,A,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pA,hc,hC] += 0.5 * np.einsum('VW,JWAB,ABIJ,uUiV->uUiI', gamma1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pA,hc,hC] += -0.5 * np.einsum('jkab,abik,uUjI->uUiI', h['aa'][c,c,v,v], t['aa'][pv,pv,hc,hc], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pa,pA,hc,hC] += 1.0 * np.einsum('jJaA,aAiI,uUjJ->uUiI', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pa,pA,hc,hC] += -1.0 * np.einsum('jJaA,aAiJ,uUjI->uUiI', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pa,pA,hc,hC] += -1.0 * np.einsum('jJaA,aAjI,uUiJ->uUiI', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pa,pA,hc,hC] += 0.5 * np.einsum('JKAB,ABIJ,uUiK->uUiI', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pA,hc,hC], optimize=True)
	# cC|Av
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('uv,wx,jvwb,abij,xUuI->aUiI', eta1['a'], gamma1['a'], h['aa'][c,a,a,v], t['aa'][pv,pv,hc,hc], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('uv,wx,jxub,abij,vUwI->aUiI', eta1['a'], gamma1['a'], h['aa'][c,a,a,v], t['aa'][pv,pv,hc,hc], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('uv,wx,vJwA,aAiJ,xUuI->aUiI', eta1['a'], gamma1['a'], h['ab'][a,C,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('uv,wx,xJuA,aAiI,vUwJ->aUiI', eta1['a'], gamma1['a'], h['ab'][a,C,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('uv,wx,xJuA,aAiJ,vUwI->aUiI', eta1['a'], gamma1['a'], h['ab'][a,C,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('uv,VW,jWuA,aAiI,vUjV->aUiI', eta1['a'], gamma1['b'], h['ab'][c,A,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('uv,VW,jWuA,aAjI,vUiV->aUiI', eta1['a'], gamma1['b'], h['ab'][c,A,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('uv,jkub,abik,vUjI->aUiI', eta1['a'], h['aa'][c,c,a,v], t['aa'][pv,pv,hc,hc], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += -0.5 * np.einsum('uv,jkub,abjk,vUiI->aUiI', eta1['a'], h['aa'][c,c,a,v], t['aa'][pv,pv,hc,hc], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += 0.5 * np.einsum('uv,jvbc,aUuI,bcij->aUiI', eta1['a'], h['aa'][c,a,v,v], t['ab'][pv,pA,ha,hC], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('uv,jJuA,aAiI,vUjJ->aUiI', eta1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('uv,jJuA,aAiJ,vUjI->aUiI', eta1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('uv,jJuA,aAjI,vUiJ->aUiI', eta1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('uv,jJuA,aAjJ,vUiI->aUiI', eta1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('uv,vJbA,bAiJ,aUuI->aUiI', eta1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('VW,uv,vWbA,bAiI,aUuV->aUiI', eta1['b'], eta1['a'], h['ab'][a,A,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('VW,uv,jWuA,aAjI,vUiV->aUiI', eta1['b'], gamma1['a'], h['ab'][c,A,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('VW,XY,jWbX,UYIV,abij->aUiI', eta1['b'], gamma1['b'], h['ab'][c,A,v,A], t['bb'][pA,pA,hC,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('VW,XY,jYbV,UWIX,abij->aUiI', eta1['b'], gamma1['b'], h['ab'][c,A,v,A], t['bb'][pA,pA,hC,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('VW,XY,JWXA,UYIV,aAiJ->aUiI', eta1['b'], gamma1['b'], h['bb'][C,A,A,V], t['bb'][pA,pA,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('VW,XY,JYVA,UWIX,aAiJ->aUiI', eta1['b'], gamma1['b'], h['bb'][C,A,A,V], t['bb'][pA,pA,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('VW,XY,JYVA,UWJX,aAiI->aUiI', eta1['b'], gamma1['b'], h['bb'][C,A,A,V], t['bb'][pA,pA,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('VW,jJbV,UWIJ,abij->aUiI', eta1['b'], h['ab'][c,C,v,A], t['bb'][pA,pA,hC,hC], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('VW,jWbA,bAjI,aUiV->aUiI', eta1['b'], h['ab'][c,A,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('VW,JKVA,UWIJ,aAiK->aUiI', eta1['b'], h['bb'][C,C,A,V], t['bb'][pA,pA,hC,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += 0.5 * np.einsum('VW,JKVA,UWJK,aAiI->aUiI', eta1['b'], h['bb'][C,C,A,V], t['bb'][pA,pA,hC,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += 0.5 * np.einsum('VW,JWAB,ABIJ,aUiV->aUiI', eta1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hC] += -0.5 * np.einsum('uv,jkub,abjk,vUiI->aUiI', gamma1['a'], h['aa'][c,c,a,v], t['aa'][pv,pv,hc,hc], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += 0.5 * np.einsum('uv,jvbc,aUuI,bcij->aUiI', gamma1['a'], h['aa'][c,a,v,v], t['ab'][pv,pA,ha,hC], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('uv,jvbc,bUuI,acij->aUiI', gamma1['a'], h['aa'][c,a,v,v], t['ab'][pv,pA,ha,hC], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('uv,jJuA,aAjJ,vUiI->aUiI', gamma1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('uv,vJbA,aAiI,bUuJ->aUiI', gamma1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('uv,vJbA,aAiJ,bUuI->aUiI', gamma1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('uv,vJbA,bAiI,aUuJ->aUiI', gamma1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('uv,vJbA,bAiJ,aUuI->aUiI', gamma1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('VW,uv,vWbA,aAiI,bUuV->aUiI', gamma1['b'], gamma1['a'], h['ab'][a,A,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('VW,uv,vWbA,bAiI,aUuV->aUiI', gamma1['b'], gamma1['a'], h['ab'][a,A,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pA,hc,hC] += 0.5 * np.einsum('VW,XY,WYAB,UAVX,aBiI->aUiI', gamma1['b'], gamma1['b'], h['bb'][A,A,V,V], t['bb'][pA,pV,hA,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('VW,jWbA,aAiI,bUjV->aUiI', gamma1['b'], h['ab'][c,A,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('VW,jWbA,aAjI,bUiV->aUiI', gamma1['b'], h['ab'][c,A,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('VW,jWbA,bAiI,aUjV->aUiI', gamma1['b'], h['ab'][c,A,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('VW,jWbA,bAjI,aUiV->aUiI', gamma1['b'], h['ab'][c,A,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('VW,jWbA,UAIV,abij->aUiI', gamma1['b'], h['ab'][c,A,v,V], t['bb'][pA,pV,hC,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('VW,JWAB,UAIV,aBiJ->aUiI', gamma1['b'], h['bb'][C,A,V,V], t['bb'][pA,pV,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('VW,JWAB,UAJV,aBiI->aUiI', gamma1['b'], h['bb'][C,A,V,V], t['bb'][pA,pV,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += 0.5 * np.einsum('VW,JWAB,ABIJ,aUiV->aUiI', gamma1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pA,hc,hC] += -0.5 * np.einsum('jkbc,aUjI,bcik->aUiI', h['aa'][c,c,v,v], t['ab'][pv,pA,hc,hC], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pA,hc,hC] += -0.5 * np.einsum('jkbc,bUiI,acjk->aUiI', h['aa'][c,c,v,v], t['ab'][pv,pA,hc,hC], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('jkbc,bUjI,acik->aUiI', h['aa'][c,c,v,v], t['ab'][pv,pA,hc,hC], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('jJbA,aAiI,bUjJ->aUiI', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('jJbA,aAiJ,bUjI->aUiI', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('jJbA,aAjI,bUiJ->aUiI', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('jJbA,aAjJ,bUiI->aUiI', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('jJbA,bAiI,aUjJ->aUiI', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('jJbA,bAiJ,aUjI->aUiI', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += -1.0 * np.einsum('jJbA,bAjI,aUiJ->aUiI', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('jJbA,UAIJ,abij->aUiI', h['ab'][c,C,v,V], t['bb'][pA,pV,hC,hC], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pA,hc,hC] += 1.0 * np.einsum('JKAB,UAIJ,aBiK->aUiI', h['bb'][C,C,V,V], t['bb'][pA,pV,hC,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += 0.5 * np.einsum('JKAB,UAJK,aBiI->aUiI', h['bb'][C,C,V,V], t['bb'][pA,pV,hC,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pA,hc,hC] += 0.5 * np.einsum('JKAB,ABIJ,aUiK->aUiI', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pA,hc,hC], optimize=True)
	# cC|Va
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('vw,xy,jwxa,aAjI,uyiv->uAiI', eta1['a'], gamma1['a'], h['aa'][c,a,a,v], t['ab'][pv,pV,hc,hC], t['aa'][pa,pa,hc,ha], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('vw,xy,jyva,aAiI,uwjx->uAiI', eta1['a'], gamma1['a'], h['aa'][c,a,a,v], t['ab'][pv,pV,hc,hC], t['aa'][pa,pa,hc,ha], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('vw,xy,jyva,aAjI,uwix->uAiI', eta1['a'], gamma1['a'], h['aa'][c,a,a,v], t['ab'][pv,pV,hc,hC], t['aa'][pa,pa,hc,ha], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('vw,xy,wJxB,ABIJ,uyiv->uAiI', eta1['a'], gamma1['a'], h['ab'][a,C,a,V], t['bb'][pV,pV,hC,hC], t['aa'][pa,pa,hc,ha], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('vw,xy,yJvB,ABIJ,uwix->uAiI', eta1['a'], gamma1['a'], h['ab'][a,C,a,V], t['bb'][pV,pV,hC,hC], t['aa'][pa,pa,hc,ha], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('vw,UV,wJaU,aAiJ,uVvI->uAiI', eta1['a'], gamma1['b'], h['ab'][a,C,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += 0.5 * np.einsum('vw,jkva,aAiI,uwjk->uAiI', eta1['a'], h['aa'][c,c,a,v], t['ab'][pv,pV,hc,hC], t['aa'][pa,pa,hc,hc], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('vw,jkva,aAjI,uwik->uAiI', eta1['a'], h['aa'][c,c,a,v], t['ab'][pv,pV,hc,hC], t['aa'][pa,pa,hc,hc], optimize=True)
	X['ab'][pa,pV,hc,hC] += 0.5 * np.einsum('vw,jwab,abij,uAvI->uAiI', eta1['a'], h['aa'][c,a,v,v], t['aa'][pv,pv,hc,hc], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('vw,jJvB,ABIJ,uwij->uAiI', eta1['a'], h['ab'][c,C,a,V], t['bb'][pV,pV,hC,hC], t['aa'][pa,pa,hc,hc], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('vw,wJaB,aBiJ,uAvI->uAiI', eta1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('UV,vw,wVaB,aBiI,uAvU->uAiI', eta1['b'], eta1['a'], h['ab'][a,A,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('UV,vw,wJaU,aAiI,uVvJ->uAiI', eta1['b'], gamma1['a'], h['ab'][a,C,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('UV,vw,wJaU,aAiJ,uVvI->uAiI', eta1['b'], gamma1['a'], h['ab'][a,C,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('UV,WX,jVaW,aAjI,uXiU->uAiI', eta1['b'], gamma1['b'], h['ab'][c,A,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('UV,WX,jXaU,aAiI,uVjW->uAiI', eta1['b'], gamma1['b'], h['ab'][c,A,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('UV,WX,jXaU,aAjI,uViW->uAiI', eta1['b'], gamma1['b'], h['ab'][c,A,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('UV,WX,JVWB,ABIJ,uXiU->uAiI', eta1['b'], gamma1['b'], h['bb'][C,A,A,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('UV,WX,JXUB,ABIJ,uViW->uAiI', eta1['b'], gamma1['b'], h['bb'][C,A,A,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('UV,jJaU,aAiI,uVjJ->uAiI', eta1['b'], h['ab'][c,C,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('UV,jJaU,aAiJ,uVjI->uAiI', eta1['b'], h['ab'][c,C,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('UV,jJaU,aAjI,uViJ->uAiI', eta1['b'], h['ab'][c,C,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('UV,jJaU,aAjJ,uViI->uAiI', eta1['b'], h['ab'][c,C,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('UV,jVaB,aBjI,uAiU->uAiI', eta1['b'], h['ab'][c,A,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('UV,JKUB,ABIJ,uViK->uAiI', eta1['b'], h['bb'][C,C,A,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += -0.5 * np.einsum('UV,JKUB,ABJK,uViI->uAiI', eta1['b'], h['bb'][C,C,A,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += 0.5 * np.einsum('UV,JVBC,BCIJ,uAiU->uAiI', eta1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hC] += 0.5 * np.einsum('vw,xy,wyab,bAiI,uavx->uAiI', gamma1['a'], gamma1['a'], h['aa'][a,a,v,v], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,ha,ha], optimize=True)
	X['ab'][pa,pV,hc,hC] += 0.5 * np.einsum('vw,jwab,abij,uAvI->uAiI', gamma1['a'], h['aa'][c,a,v,v], t['aa'][pv,pv,hc,hc], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('vw,jwab,aAiI,ubjv->uAiI', gamma1['a'], h['aa'][c,a,v,v], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,hc,ha], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('vw,jwab,aAjI,ubiv->uAiI', gamma1['a'], h['aa'][c,a,v,v], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,hc,ha], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('vw,wJaB,aAiI,uBvJ->uAiI', gamma1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('vw,wJaB,aAiJ,uBvI->uAiI', gamma1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('vw,wJaB,aBiI,uAvJ->uAiI', gamma1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('vw,wJaB,aBiJ,uAvI->uAiI', gamma1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('vw,wJaB,ABIJ,uaiv->uAiI', gamma1['a'], h['ab'][a,C,v,V], t['bb'][pV,pV,hC,hC], t['aa'][pa,pv,hc,ha], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('UV,vw,wVaB,aAiI,uBvU->uAiI', gamma1['b'], gamma1['a'], h['ab'][a,A,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('UV,vw,wVaB,aBiI,uAvU->uAiI', gamma1['b'], gamma1['a'], h['ab'][a,A,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('UV,jJaU,aAjJ,uViI->uAiI', gamma1['b'], h['ab'][c,C,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('UV,jVaB,aAiI,uBjU->uAiI', gamma1['b'], h['ab'][c,A,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('UV,jVaB,aAjI,uBiU->uAiI', gamma1['b'], h['ab'][c,A,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('UV,jVaB,aBiI,uAjU->uAiI', gamma1['b'], h['ab'][c,A,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('UV,jVaB,aBjI,uAiU->uAiI', gamma1['b'], h['ab'][c,A,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hC] += -0.5 * np.einsum('UV,JKUB,ABJK,uViI->uAiI', gamma1['b'], h['bb'][C,C,A,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('UV,JVBC,ABIJ,uCiU->uAiI', gamma1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hC] += 0.5 * np.einsum('UV,JVBC,BCIJ,uAiU->uAiI', gamma1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pa,pV,hc,hC] += -0.5 * np.einsum('jkab,abik,uAjI->uAiI', h['aa'][c,c,v,v], t['aa'][pv,pv,hc,hc], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += -0.5 * np.einsum('jkab,aAiI,ubjk->uAiI', h['aa'][c,c,v,v], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,hc,hc], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('jkab,aAjI,ubik->uAiI', h['aa'][c,c,v,v], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,hc,hc], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('jJaB,aAiI,uBjJ->uAiI', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('jJaB,aAiJ,uBjI->uAiI', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('jJaB,aAjI,uBiJ->uAiI', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('jJaB,aAjJ,uBiI->uAiI', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('jJaB,aBiI,uAjJ->uAiI', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('jJaB,aBiJ,uAjI->uAiI', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += -1.0 * np.einsum('jJaB,aBjI,uAiJ->uAiI', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('jJaB,ABIJ,uaij->uAiI', h['ab'][c,C,v,V], t['bb'][pV,pV,hC,hC], t['aa'][pa,pv,hc,hc], optimize=True)
	X['ab'][pa,pV,hc,hC] += 1.0 * np.einsum('JKBC,ABIJ,uCiK->uAiI', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += 0.5 * np.einsum('JKBC,ABJK,uCiI->uAiI', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pa,pV,hc,hC] += 0.5 * np.einsum('JKBC,BCIJ,uAiK->uAiI', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hC], t['ab'][pa,pV,hc,hC], optimize=True)
	# cC|Vv
	X['ab'][pv,pV,hc,hC] += -0.5 * np.einsum('uv,wx,yz,jzuw,aAjI,vxiy->aAiI', eta1['a'], eta1['a'], gamma1['a'], h['aa'][c,a,a,a], t['ab'][pv,pV,hc,hC], t['aa'][pa,pa,hc,ha], optimize=True)
	X['ab'][pv,pV,hc,hC] += -0.5 * np.einsum('uv,wx,yz,vxyb,bAiI,zauw->aAiI', eta1['a'], eta1['a'], gamma1['a'], h['aa'][a,a,a,v], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,ha,ha], optimize=True)
	X['ab'][pv,pV,hc,hC] += -0.5 * np.einsum('uv,wx,jkuw,aAjI,vxik->aAiI', eta1['a'], eta1['a'], h['aa'][c,c,a,a], t['ab'][pv,pV,hc,hC], t['aa'][pa,pa,hc,hc], optimize=True)
	X['ab'][pv,pV,hc,hC] += -0.5 * np.einsum('uv,wx,yz,jvwy,aAjI,xziu->aAiI', eta1['a'], gamma1['a'], gamma1['a'], h['aa'][c,a,a,a], t['ab'][pv,pV,hc,hC], t['aa'][pa,pa,hc,ha], optimize=True)
	X['ab'][pv,pV,hc,hC] += -0.5 * np.einsum('uv,wx,yz,xzub,bAiI,vawy->aAiI', eta1['a'], gamma1['a'], gamma1['a'], h['aa'][a,a,a,v], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,ha,ha], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('uv,wx,jvwb,abij,xAuI->aAiI', eta1['a'], gamma1['a'], h['aa'][c,a,a,v], t['aa'][pv,pv,hc,hc], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('uv,wx,jvwb,bAjI,xaiu->aAiI', eta1['a'], gamma1['a'], h['aa'][c,a,a,v], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,hc,ha], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('uv,wx,jxub,abij,vAwI->aAiI', eta1['a'], gamma1['a'], h['aa'][c,a,a,v], t['aa'][pv,pv,hc,hc], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('uv,wx,jxub,aAjI,vbiw->aAiI', eta1['a'], gamma1['a'], h['aa'][c,a,a,v], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,hc,ha], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('uv,wx,jxub,bAiI,vajw->aAiI', eta1['a'], gamma1['a'], h['aa'][c,a,a,v], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,hc,ha], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('uv,wx,jxub,bAjI,vaiw->aAiI', eta1['a'], gamma1['a'], h['aa'][c,a,a,v], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,hc,ha], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('uv,wx,vJwB,aBiJ,xAuI->aAiI', eta1['a'], gamma1['a'], h['ab'][a,C,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('uv,wx,vJwB,ABIJ,xaiu->aAiI', eta1['a'], gamma1['a'], h['ab'][a,C,a,V], t['bb'][pV,pV,hC,hC], t['aa'][pa,pv,hc,ha], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('uv,wx,xJuB,aAiJ,vBwI->aAiI', eta1['a'], gamma1['a'], h['ab'][a,C,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('uv,wx,xJuB,aBiI,vAwJ->aAiI', eta1['a'], gamma1['a'], h['ab'][a,C,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('uv,wx,xJuB,aBiJ,vAwI->aAiI', eta1['a'], gamma1['a'], h['ab'][a,C,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('uv,wx,xJuB,ABIJ,vaiw->aAiI', eta1['a'], gamma1['a'], h['ab'][a,C,a,V], t['bb'][pV,pV,hC,hC], t['aa'][pa,pv,hc,ha], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('uv,UV,wx,vJwU,aAiJ,xVuI->aAiI', eta1['a'], gamma1['b'], gamma1['a'], h['ab'][a,C,a,A], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('uv,UV,wx,xVuB,aBiI,vAwU->aAiI', eta1['a'], gamma1['b'], gamma1['a'], h['ab'][a,A,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('uv,UV,jVuB,aAjI,vBiU->aAiI', eta1['a'], gamma1['b'], h['ab'][c,A,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('uv,UV,jVuB,aBiI,vAjU->aAiI', eta1['a'], gamma1['b'], h['ab'][c,A,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('uv,UV,jVuB,aBjI,vAiU->aAiI', eta1['a'], gamma1['b'], h['ab'][c,A,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('uv,UV,vJbU,bAiJ,aVuI->aAiI', eta1['a'], gamma1['b'], h['ab'][a,C,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('uv,jkub,abik,vAjI->aAiI', eta1['a'], h['aa'][c,c,a,v], t['aa'][pv,pv,hc,hc], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -0.5 * np.einsum('uv,jkub,abjk,vAiI->aAiI', eta1['a'], h['aa'][c,c,a,v], t['aa'][pv,pv,hc,hc], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('uv,jkub,aAjI,vbik->aAiI', eta1['a'], h['aa'][c,c,a,v], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,hc,hc], optimize=True)
	X['ab'][pv,pV,hc,hC] += -0.5 * np.einsum('uv,jkub,bAiI,vajk->aAiI', eta1['a'], h['aa'][c,c,a,v], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,hc,hc], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('uv,jkub,bAjI,vaik->aAiI', eta1['a'], h['aa'][c,c,a,v], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,hc,hc], optimize=True)
	X['ab'][pv,pV,hc,hC] += 0.5 * np.einsum('uv,jvbc,aAuI,bcij->aAiI', eta1['a'], h['aa'][c,a,v,v], t['ab'][pv,pV,ha,hC], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('uv,jJuB,aAiJ,vBjI->aAiI', eta1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('uv,jJuB,aAjI,vBiJ->aAiI', eta1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('uv,jJuB,aAjJ,vBiI->aAiI', eta1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('uv,jJuB,aBiI,vAjJ->aAiI', eta1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('uv,jJuB,aBiJ,vAjI->aAiI', eta1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('uv,jJuB,aBjI,vAiJ->aAiI', eta1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('uv,jJuB,aBjJ,vAiI->aAiI', eta1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('uv,jJuB,ABIJ,vaij->aAiI', eta1['a'], h['ab'][c,C,a,V], t['bb'][pV,pV,hC,hC], t['aa'][pa,pv,hc,hc], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('uv,vJbB,aAuI,bBiJ->aAiI', eta1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,ha,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,uv,wx,vVwB,aBiI,xAuU->aAiI', eta1['b'], eta1['a'], gamma1['a'], h['ab'][a,A,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,uv,wx,xJuU,aAiJ,vVwI->aAiI', eta1['b'], eta1['a'], gamma1['a'], h['ab'][a,C,a,A], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,ha,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,uv,WX,jXuU,aAjI,vViW->aAiI', eta1['b'], eta1['a'], gamma1['b'], h['ab'][c,A,a,A], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,uv,WX,vVbW,bAiI,aXuU->aAiI', eta1['b'], eta1['a'], gamma1['b'], h['ab'][a,A,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,uv,jJuU,aAiJ,vVjI->aAiI', eta1['b'], eta1['a'], h['ab'][c,C,a,A], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,uv,jJuU,aAjI,vViJ->aAiI', eta1['b'], eta1['a'], h['ab'][c,C,a,A], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('UV,uv,jJuU,aAjJ,vViI->aAiI', eta1['b'], eta1['a'], h['ab'][c,C,a,A], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,uv,vVbB,aAuU,bBiI->aAiI', eta1['b'], eta1['a'], h['ab'][a,A,v,V], t['ab'][pv,pV,ha,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -0.5 * np.einsum('UV,WX,YZ,JZUW,VXIY,aAiJ->aAiI', eta1['b'], eta1['b'], gamma1['b'], h['bb'][C,A,A,A], t['bb'][pA,pA,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -0.5 * np.einsum('UV,WX,YZ,VXYB,ZAUW,aBiI->aAiI', eta1['b'], eta1['b'], gamma1['b'], h['bb'][A,A,A,V], t['bb'][pA,pV,hA,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 0.5 * np.einsum('UV,WX,JKUW,VXIJ,aAiK->aAiI', eta1['b'], eta1['b'], h['bb'][C,C,A,A], t['bb'][pA,pA,hC,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,uv,jVuB,aBjI,vAiU->aAiI', eta1['b'], gamma1['a'], h['ab'][c,A,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,uv,vJbU,aAiJ,bVuI->aAiI', eta1['b'], gamma1['a'], h['ab'][a,C,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,uv,vJbU,bAiI,aVuJ->aAiI', eta1['b'], gamma1['a'], h['ab'][a,C,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('UV,uv,vJbU,bAiJ,aVuI->aAiI', eta1['b'], gamma1['a'], h['ab'][a,C,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,WX,uv,jVuW,aAjI,vXiU->aAiI', eta1['b'], gamma1['b'], gamma1['a'], h['ab'][c,A,a,A], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,WX,uv,vXbU,bAiI,aVuW->aAiI', eta1['b'], gamma1['b'], gamma1['a'], h['ab'][a,A,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hA], optimize=True)
	X['ab'][pv,pV,hc,hC] += -0.5 * np.einsum('UV,WX,YZ,JVWY,XZIU,aAiJ->aAiI', eta1['b'], gamma1['b'], gamma1['b'], h['bb'][C,A,A,A], t['bb'][pA,pA,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -0.5 * np.einsum('UV,WX,YZ,XZUB,VAWY,aBiI->aAiI', eta1['b'], gamma1['b'], gamma1['b'], h['bb'][A,A,A,V], t['bb'][pA,pV,hA,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,WX,jVbW,bAjI,aXiU->aAiI', eta1['b'], gamma1['b'], h['ab'][c,A,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('UV,WX,jVbW,XAIU,abij->aAiI', eta1['b'], gamma1['b'], h['ab'][c,A,v,A], t['bb'][pA,pV,hC,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,WX,jXbU,aAjI,bViW->aAiI', eta1['b'], gamma1['b'], h['ab'][c,A,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,WX,jXbU,bAiI,aVjW->aAiI', eta1['b'], gamma1['b'], h['ab'][c,A,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('UV,WX,jXbU,bAjI,aViW->aAiI', eta1['b'], gamma1['b'], h['ab'][c,A,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,WX,jXbU,VAIW,abij->aAiI', eta1['b'], gamma1['b'], h['ab'][c,A,v,A], t['bb'][pA,pV,hC,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,WX,JVWB,XAIU,aBiJ->aAiI', eta1['b'], gamma1['b'], h['bb'][C,A,A,V], t['bb'][pA,pV,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('UV,WX,JVWB,ABIJ,aXiU->aAiI', eta1['b'], gamma1['b'], h['bb'][C,A,A,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('UV,WX,JXUB,VAIW,aBiJ->aAiI', eta1['b'], gamma1['b'], h['bb'][C,A,A,V], t['bb'][pA,pV,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,WX,JXUB,VAJW,aBiI->aAiI', eta1['b'], gamma1['b'], h['bb'][C,A,A,V], t['bb'][pA,pV,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,WX,JXUB,VBIW,aAiJ->aAiI', eta1['b'], gamma1['b'], h['bb'][C,A,A,V], t['bb'][pA,pV,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,WX,JXUB,ABIJ,aViW->aAiI', eta1['b'], gamma1['b'], h['bb'][C,A,A,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pA,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,jJbU,aAiJ,bVjI->aAiI', eta1['b'], h['ab'][c,C,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,jJbU,aAjI,bViJ->aAiI', eta1['b'], h['ab'][c,C,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('UV,jJbU,aAjJ,bViI->aAiI', eta1['b'], h['ab'][c,C,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,jJbU,bAiI,aVjJ->aAiI', eta1['b'], h['ab'][c,C,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('UV,jJbU,bAiJ,aVjI->aAiI', eta1['b'], h['ab'][c,C,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('UV,jJbU,bAjI,aViJ->aAiI', eta1['b'], h['ab'][c,C,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,jJbU,bAjJ,aViI->aAiI', eta1['b'], h['ab'][c,C,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,jJbU,VAIJ,abij->aAiI', eta1['b'], h['ab'][c,C,v,A], t['bb'][pA,pV,hC,hC], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,jVbB,aAiU,bBjI->aAiI', eta1['b'], h['ab'][c,A,v,V], t['ab'][pv,pV,hc,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,JKUB,VAIJ,aBiK->aAiI', eta1['b'], h['bb'][C,C,A,V], t['bb'][pA,pV,hC,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -0.5 * np.einsum('UV,JKUB,VAJK,aBiI->aAiI', eta1['b'], h['bb'][C,C,A,V], t['bb'][pA,pV,hC,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('UV,JKUB,VBIJ,aAiK->aAiI', eta1['b'], h['bb'][C,C,A,V], t['bb'][pA,pV,hC,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,JKUB,ABIJ,aViK->aAiI', eta1['b'], h['bb'][C,C,A,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -0.5 * np.einsum('UV,JKUB,ABJK,aViI->aAiI', eta1['b'], h['bb'][C,C,A,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 0.5 * np.einsum('UV,JVBC,BCIJ,aAiU->aAiI', eta1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hC] += 0.5 * np.einsum('uv,wx,vxbc,cAiI,abuw->aAiI', gamma1['a'], gamma1['a'], h['aa'][a,a,v,v], t['ab'][pv,pV,hc,hC], t['aa'][pv,pv,ha,ha], optimize=True)
	X['ab'][pv,pV,hc,hC] += -0.5 * np.einsum('uv,jkub,abjk,vAiI->aAiI', gamma1['a'], h['aa'][c,c,a,v], t['aa'][pv,pv,hc,hc], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -0.5 * np.einsum('uv,jvbc,aAjI,bciu->aAiI', gamma1['a'], h['aa'][c,a,v,v], t['ab'][pv,pV,hc,hC], t['aa'][pv,pv,hc,ha], optimize=True)
	X['ab'][pv,pV,hc,hC] += 0.5 * np.einsum('uv,jvbc,aAuI,bcij->aAiI', gamma1['a'], h['aa'][c,a,v,v], t['ab'][pv,pV,ha,hC], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('uv,jvbc,bAiI,acju->aAiI', gamma1['a'], h['aa'][c,a,v,v], t['ab'][pv,pV,hc,hC], t['aa'][pv,pv,hc,ha], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('uv,jvbc,bAjI,aciu->aAiI', gamma1['a'], h['aa'][c,a,v,v], t['ab'][pv,pV,hc,hC], t['aa'][pv,pv,hc,ha], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('uv,jvbc,bAuI,acij->aAiI', gamma1['a'], h['aa'][c,a,v,v], t['ab'][pv,pV,ha,hC], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('uv,jJuB,aBjJ,vAiI->aAiI', gamma1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('uv,vJbB,aAuI,bBiJ->aAiI', gamma1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,ha,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('uv,vJbB,aAuJ,bBiI->aAiI', gamma1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,ha,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('uv,vJbB,aBuI,bAiJ->aAiI', gamma1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,ha,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('uv,vJbB,aBuJ,bAiI->aAiI', gamma1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,ha,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('uv,vJbB,bAuI,aBiJ->aAiI', gamma1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,ha,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('uv,vJbB,bAuJ,aBiI->aAiI', gamma1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,ha,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('uv,vJbB,bBuI,aAiJ->aAiI', gamma1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,ha,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('uv,vJbB,ABIJ,abiu->aAiI', gamma1['a'], h['ab'][a,C,v,V], t['bb'][pV,pV,hC,hC], t['aa'][pv,pv,hc,ha], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,uv,jJuU,aAjJ,vViI->aAiI', gamma1['b'], gamma1['a'], h['ab'][c,C,a,A], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('UV,uv,vVbB,aAuU,bBiI->aAiI', gamma1['b'], gamma1['a'], h['ab'][a,A,v,V], t['ab'][pv,pV,ha,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,uv,vVbB,aBuU,bAiI->aAiI', gamma1['b'], gamma1['a'], h['ab'][a,A,v,V], t['ab'][pv,pV,ha,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,uv,vVbB,bAuU,aBiI->aAiI', gamma1['b'], gamma1['a'], h['ab'][a,A,v,V], t['ab'][pv,pV,ha,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 0.5 * np.einsum('UV,WX,VXBC,ABUW,aCiI->aAiI', gamma1['b'], gamma1['b'], h['bb'][A,A,V,V], t['bb'][pV,pV,hA,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,jJbU,bAjJ,aViI->aAiI', gamma1['b'], h['ab'][c,C,v,A], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,jVbB,aAiU,bBjI->aAiI', gamma1['b'], h['ab'][c,A,v,V], t['ab'][pv,pV,hc,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('UV,jVbB,aAjU,bBiI->aAiI', gamma1['b'], h['ab'][c,A,v,V], t['ab'][pv,pV,hc,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('UV,jVbB,aBiU,bAjI->aAiI', gamma1['b'], h['ab'][c,A,v,V], t['ab'][pv,pV,hc,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,jVbB,aBjU,bAiI->aAiI', gamma1['b'], h['ab'][c,A,v,V], t['ab'][pv,pV,hc,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('UV,jVbB,bAiU,aBjI->aAiI', gamma1['b'], h['ab'][c,A,v,V], t['ab'][pv,pV,hc,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,jVbB,bAjU,aBiI->aAiI', gamma1['b'], h['ab'][c,A,v,V], t['ab'][pv,pV,hc,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,jVbB,bBiU,aAjI->aAiI', gamma1['b'], h['ab'][c,A,v,V], t['ab'][pv,pV,hc,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('UV,jVbB,ABIU,abij->aAiI', gamma1['b'], h['ab'][c,A,v,V], t['bb'][pV,pV,hC,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pV,hc,hC] += -0.5 * np.einsum('UV,JKUB,ABJK,aViI->aAiI', gamma1['b'], h['bb'][C,C,A,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pA,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('UV,JVBC,ABIJ,aCiU->aAiI', gamma1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('UV,JVBC,ABIU,aCiJ->aAiI', gamma1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('UV,JVBC,ABJU,aCiI->aAiI', gamma1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 0.5 * np.einsum('UV,JVBC,BCIJ,aAiU->aAiI', gamma1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pV,hc,hA], optimize=True)
	X['ab'][pv,pV,hc,hC] += -0.5 * np.einsum('UV,JVBC,BCIU,aAiJ->aAiI', gamma1['b'], h['bb'][C,A,V,V], t['bb'][pV,pV,hC,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -0.5 * np.einsum('jkbc,aAjI,bcik->aAiI', h['aa'][c,c,v,v], t['ab'][pv,pV,hc,hC], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pV,hc,hC] += -0.5 * np.einsum('jkbc,bAiI,acjk->aAiI', h['aa'][c,c,v,v], t['ab'][pv,pV,hc,hC], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('jkbc,bAjI,acik->aAiI', h['aa'][c,c,v,v], t['ab'][pv,pV,hc,hC], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('jJbB,aAiJ,bBjI->aAiI', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('jJbB,aAjI,bBiJ->aAiI', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('jJbB,aAjJ,bBiI->aAiI', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('jJbB,aBiI,bAjJ->aAiI', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('jJbB,aBiJ,bAjI->aAiI', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('jJbB,aBjI,bAiJ->aAiI', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += -1.0 * np.einsum('jJbB,aBjJ,bAiI->aAiI', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('jJbB,ABIJ,abij->aAiI', h['ab'][c,C,v,V], t['bb'][pV,pV,hC,hC], t['aa'][pv,pv,hc,hc], optimize=True)
	X['ab'][pv,pV,hc,hC] += 1.0 * np.einsum('JKBC,ABIJ,aCiK->aAiI', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 0.5 * np.einsum('JKBC,ABJK,aCiI->aAiI', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	X['ab'][pv,pV,hc,hC] += 0.5 * np.einsum('JKBC,BCIJ,aAiK->aAiI', h['bb'][C,C,V,V], t['bb'][pV,pV,hC,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	# ca|aa
	X['aa'][pa,pa,hc,ha] += -0.25 * np.einsum('jkab,abik,uvjw->uviw', h['aa'][c,c,v,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pa,hc,ha] += -0.5 * np.einsum('jIaA,aAiI,uvjw->uviw', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['aa'][pa,pa,hc,ha], optimize=True)
	# ca|va
	X['aa'][pa,pv,hc,ha] += 1.0 * np.einsum('wx,jkwb,abik,uxjv->uaiv', eta1['a'], h['aa'][c,c,a,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += -0.5 * np.einsum('wx,jkwb,abjk,uxiv->uaiv', eta1['a'], h['aa'][c,c,a,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += -0.5 * np.einsum('wx,jxbc,bcij,uavw->uaiv', eta1['a'], h['aa'][c,a,v,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += 1.0 * np.einsum('wx,jIwA,aAiI,uxjv->uaiv', eta1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += -1.0 * np.einsum('wx,jIwA,aAjI,uxiv->uaiv', eta1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += 1.0 * np.einsum('wx,xIbA,bAiI,uavw->uaiv', eta1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += -1.0 * np.einsum('UV,jIbU,abij,uVvI->uaiv', eta1['b'], h['ab'][c,C,v,A], t['aa'][pv,pv,hc,hc], t['ab'][pa,pA,ha,hC], optimize=True)
	X['aa'][pa,pv,hc,ha] += -1.0 * np.einsum('UV,IJUA,aAiJ,uVvI->uaiv', eta1['b'], h['bb'][C,C,A,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,ha,hC], optimize=True)
	X['aa'][pa,pv,hc,ha] += -0.5 * np.einsum('wx,jkwb,abjk,uxiv->uaiv', gamma1['a'], h['aa'][c,c,a,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += 1.0 * np.einsum('wx,jxbc,acij,ubvw->uaiv', gamma1['a'], h['aa'][c,a,v,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += -0.5 * np.einsum('wx,jxbc,bcij,uavw->uaiv', gamma1['a'], h['aa'][c,a,v,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += -1.0 * np.einsum('wx,jIwA,aAjI,uxiv->uaiv', gamma1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += -1.0 * np.einsum('wx,xIbA,aAiI,ubvw->uaiv', gamma1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += 1.0 * np.einsum('wx,xIbA,bAiI,uavw->uaiv', gamma1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += -1.0 * np.einsum('UV,jVbA,abij,uAvU->uaiv', gamma1['b'], h['ab'][c,A,v,V], t['aa'][pv,pv,hc,hc], t['ab'][pa,pV,ha,hA], optimize=True)
	X['aa'][pa,pv,hc,ha] += 1.0 * np.einsum('UV,IVAB,aBiI,uAvU->uaiv', gamma1['b'], h['bb'][C,A,V,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hA], optimize=True)
	X['aa'][pa,pv,hc,ha] += 1.0 * np.einsum('jkbc,acik,ubjv->uaiv', h['aa'][c,c,v,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += -0.5 * np.einsum('jkbc,acjk,ubiv->uaiv', h['aa'][c,c,v,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += -0.5 * np.einsum('jkbc,bcik,uajv->uaiv', h['aa'][c,c,v,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += -1.0 * np.einsum('jIbA,abij,uAvI->uaiv', h['ab'][c,C,v,V], t['aa'][pv,pv,hc,hc], t['ab'][pa,pV,ha,hC], optimize=True)
	X['aa'][pa,pv,hc,ha] += 1.0 * np.einsum('jIbA,aAiI,ubjv->uaiv', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += -1.0 * np.einsum('jIbA,aAjI,ubiv->uaiv', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += -1.0 * np.einsum('jIbA,bAiI,uajv->uaiv', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,ha] += -1.0 * np.einsum('IJAB,aBiJ,uAvI->uaiv', h['bb'][C,C,V,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,ha,hC], optimize=True)
	# ca|vv
	X['aa'][pv,pv,hc,ha] += -0.25 * np.einsum('vw,xy,jkvx,abik,wyju->abiu', eta1['a'], eta1['a'], h['aa'][c,c,a,a], t['aa'][pv,pv,hc,hc], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += 0.125 * np.einsum('vw,xy,jkvx,abjk,wyiu->abiu', eta1['a'], eta1['a'], h['aa'][c,c,a,a], t['aa'][pv,pv,hc,hc], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += -1.0 * np.einsum('vw,xy,jwxc,acij,ybuv->abiu', eta1['a'], gamma1['a'], h['aa'][c,a,a,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += -0.5 * np.einsum('vw,xy,jyvc,abij,wcux->abiu', eta1['a'], gamma1['a'], h['aa'][c,a,a,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += 1.0 * np.einsum('vw,xy,jyvc,acij,wbux->abiu', eta1['a'], gamma1['a'], h['aa'][c,a,a,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += 1.0 * np.einsum('vw,xy,wIxA,aAiI,ybuv->abiu', eta1['a'], gamma1['a'], h['ab'][a,C,a,V], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += -1.0 * np.einsum('vw,xy,yIvA,aAiI,wbux->abiu', eta1['a'], gamma1['a'], h['ab'][a,C,a,V], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += -0.5 * np.einsum('vw,UV,jVvA,abij,wAuU->abiu', eta1['a'], gamma1['b'], h['ab'][c,A,a,V], t['aa'][pv,pv,hc,hc], t['ab'][pa,pV,ha,hA], optimize=True)
	X['aa'][pv,pv,hc,ha] += -0.5 * np.einsum('vw,jkvc,abik,wcju->abiu', eta1['a'], h['aa'][c,c,a,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += 0.25 * np.einsum('vw,jkvc,abjk,wciu->abiu', eta1['a'], h['aa'][c,c,a,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += 1.0 * np.einsum('vw,jkvc,acik,wbju->abiu', eta1['a'], h['aa'][c,c,a,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += -0.5 * np.einsum('vw,jkvc,acjk,wbiu->abiu', eta1['a'], h['aa'][c,c,a,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += -0.25 * np.einsum('vw,jwcd,abuv,cdij->abiu', eta1['a'], h['aa'][c,a,v,v], t['aa'][pv,pv,ha,ha], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,ha] += -0.5 * np.einsum('vw,jIvA,abij,wAuI->abiu', eta1['a'], h['ab'][c,C,a,V], t['aa'][pv,pv,hc,hc], t['ab'][pa,pV,ha,hC], optimize=True)
	X['aa'][pv,pv,hc,ha] += 1.0 * np.einsum('vw,jIvA,aAiI,wbju->abiu', eta1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += -1.0 * np.einsum('vw,jIvA,aAjI,wbiu->abiu', eta1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += 0.5 * np.einsum('vw,wIcA,cAiI,abuv->abiu', eta1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,hc,hC], t['aa'][pv,pv,ha,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += -0.5 * np.einsum('UV,vw,jIvU,abij,wVuI->abiu', eta1['b'], eta1['a'], h['ab'][c,C,a,A], t['aa'][pv,pv,hc,hc], t['ab'][pa,pA,ha,hC], optimize=True)
	X['aa'][pv,pv,hc,ha] += 1.0 * np.einsum('UV,WX,jVcW,aXuU,bcij->abiu', eta1['b'], gamma1['b'], h['ab'][c,A,v,A], t['ab'][pv,pA,ha,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,ha] += -1.0 * np.einsum('UV,WX,jXcU,aVuW,bcij->abiu', eta1['b'], gamma1['b'], h['ab'][c,A,v,A], t['ab'][pv,pA,ha,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,ha] += -0.5 * np.einsum('UV,WX,jXcU,cVuW,abij->abiu', eta1['b'], gamma1['b'], h['ab'][c,A,v,A], t['ab'][pv,pA,ha,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,ha] += 1.0 * np.einsum('UV,WX,IVWA,aAiI,bXuU->abiu', eta1['b'], gamma1['b'], h['bb'][C,A,A,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hA], optimize=True)
	X['aa'][pv,pv,hc,ha] += -1.0 * np.einsum('UV,WX,IXUA,aAiI,bVuW->abiu', eta1['b'], gamma1['b'], h['bb'][C,A,A,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hA], optimize=True)
	X['aa'][pv,pv,hc,ha] += -1.0 * np.einsum('UV,jIcU,aVuI,bcij->abiu', eta1['b'], h['ab'][c,C,v,A], t['ab'][pv,pA,ha,hC], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,ha] += -0.5 * np.einsum('UV,jIcU,cVuI,abij->abiu', eta1['b'], h['ab'][c,C,v,A], t['ab'][pv,pA,ha,hC], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,ha] += 1.0 * np.einsum('UV,IJUA,aAiJ,bVuI->abiu', eta1['b'], h['bb'][C,C,A,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,ha,hC], optimize=True)
	X['aa'][pv,pv,hc,ha] += -0.125 * np.einsum('vw,xy,jkvx,abjk,wyiu->abiu', gamma1['a'], gamma1['a'], h['aa'][c,c,a,a], t['aa'][pv,pv,hc,hc], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += -0.5 * np.einsum('vw,jkvc,acjk,wbiu->abiu', gamma1['a'], h['aa'][c,c,a,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += -0.25 * np.einsum('vw,jwcd,abuv,cdij->abiu', gamma1['a'], h['aa'][c,a,v,v], t['aa'][pv,pv,ha,ha], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,ha] += 1.0 * np.einsum('vw,jwcd,acuv,bdij->abiu', gamma1['a'], h['aa'][c,a,v,v], t['aa'][pv,pv,ha,ha], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,ha] += -0.25 * np.einsum('vw,jwcd,cduv,abij->abiu', gamma1['a'], h['aa'][c,a,v,v], t['aa'][pv,pv,ha,ha], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,ha] += -1.0 * np.einsum('vw,jIvA,aAjI,wbiu->abiu', gamma1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += 1.0 * np.einsum('vw,wIcA,aAiI,bcuv->abiu', gamma1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,hc,hC], t['aa'][pv,pv,ha,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += 0.5 * np.einsum('vw,wIcA,cAiI,abuv->abiu', gamma1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,hc,hC], t['aa'][pv,pv,ha,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += -1.0 * np.einsum('UV,jVcA,aAuU,bcij->abiu', gamma1['b'], h['ab'][c,A,v,V], t['ab'][pv,pV,ha,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,ha] += -0.5 * np.einsum('UV,jVcA,cAuU,abij->abiu', gamma1['b'], h['ab'][c,A,v,V], t['ab'][pv,pV,ha,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,ha] += 1.0 * np.einsum('UV,IVAB,aAuU,bBiI->abiu', gamma1['b'], h['bb'][C,A,V,V], t['ab'][pv,pV,ha,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['aa'][pv,pv,hc,ha] += -0.25 * np.einsum('jkcd,abju,cdik->abiu', h['aa'][c,c,v,v], t['aa'][pv,pv,hc,ha], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,ha] += -0.5 * np.einsum('jkcd,aciu,bdjk->abiu', h['aa'][c,c,v,v], t['aa'][pv,pv,hc,ha], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,ha] += 1.0 * np.einsum('jkcd,acju,bdik->abiu', h['aa'][c,c,v,v], t['aa'][pv,pv,hc,ha], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,ha] += 0.125 * np.einsum('jkcd,cdiu,abjk->abiu', h['aa'][c,c,v,v], t['aa'][pv,pv,hc,ha], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,ha] += -0.25 * np.einsum('jkcd,cdju,abik->abiu', h['aa'][c,c,v,v], t['aa'][pv,pv,hc,ha], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,ha] += -1.0 * np.einsum('jIcA,aAiI,bcju->abiu', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['aa'][pv,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += 1.0 * np.einsum('jIcA,aAjI,bciu->abiu', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['aa'][pv,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += -1.0 * np.einsum('jIcA,aAuI,bcij->abiu', h['ab'][c,C,v,V], t['ab'][pv,pV,ha,hC], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,ha] += -0.5 * np.einsum('jIcA,cAiI,abju->abiu', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['aa'][pv,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,ha] += -0.5 * np.einsum('jIcA,cAuI,abij->abiu', h['ab'][c,C,v,V], t['ab'][pv,pV,ha,hC], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,ha] += -1.0 * np.einsum('IJAB,aAuI,bBiJ->abiu', h['bb'][C,C,V,V], t['ab'][pv,pV,ha,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	# cc|aa
	X['aa'][pa,pa,hc,hc] += -0.25 * np.einsum('wx,kxab,abik,uvjw->uvij', eta1['a'], h['aa'][c,a,v,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pa,hc,hc] += 0.5 * np.einsum('wx,xIaA,aAiI,uvjw->uvij', eta1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,hc,hC], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pa,hc,hc] += 0.125 * np.einsum('wx,kxab,abij,uvkw->uvij', gamma1['a'], h['aa'][c,a,v,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pa,hc,hc] += -0.25 * np.einsum('wx,kxab,abik,uvjw->uvij', gamma1['a'], h['aa'][c,a,v,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pa,hc,hc] += 0.5 * np.einsum('wx,xIaA,aAiI,uvjw->uvij', gamma1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,hc,hC], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pa,hc,hc] += 0.0625 * np.einsum('klab,abij,uvkl->uvij', h['aa'][c,c,v,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pa,hc,hc], optimize=True)
	X['aa'][pa,pa,hc,hc] += -0.25 * np.einsum('klab,abik,uvjl->uvij', h['aa'][c,c,v,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pa,hc,hc], optimize=True)
	X['aa'][pa,pa,hc,hc] += 0.5 * np.einsum('kIaA,aAiI,uvjk->uvij', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['aa'][pa,pa,hc,hc], optimize=True)
	# cc|va
	X['aa'][pa,pv,hc,hc] += -0.125 * np.einsum('vw,xy,wybc,bcij,uavx->uaij', eta1['a'], eta1['a'], h['aa'][a,a,v,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pa,pv,hc,hc] += -1.0 * np.einsum('vw,xy,kwxb,abik,uyjv->uaij', eta1['a'], gamma1['a'], h['aa'][c,a,a,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,hc] += -0.5 * np.einsum('vw,xy,kyvb,abij,uwkx->uaij', eta1['a'], gamma1['a'], h['aa'][c,a,a,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,hc] += 1.0 * np.einsum('vw,xy,kyvb,abik,uwjx->uaij', eta1['a'], gamma1['a'], h['aa'][c,a,a,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,hc] += 1.0 * np.einsum('vw,xy,wIxA,aAiI,uyjv->uaij', eta1['a'], gamma1['a'], h['ab'][a,C,a,V], t['ab'][pv,pV,hc,hC], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,hc] += -1.0 * np.einsum('vw,xy,yIvA,aAiI,uwjx->uaij', eta1['a'], gamma1['a'], h['ab'][a,C,a,V], t['ab'][pv,pV,hc,hC], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,hc] += -0.25 * np.einsum('vw,klvb,abij,uwkl->uaij', eta1['a'], h['aa'][c,c,a,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pa,hc,hc], optimize=True)
	X['aa'][pa,pv,hc,hc] += 1.0 * np.einsum('vw,klvb,abik,uwjl->uaij', eta1['a'], h['aa'][c,c,a,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pa,hc,hc], optimize=True)
	X['aa'][pa,pv,hc,hc] += -0.25 * np.einsum('vw,klvb,abkl,uwij->uaij', eta1['a'], h['aa'][c,c,a,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pa,hc,hc], optimize=True)
	X['aa'][pa,pv,hc,hc] += -0.5 * np.einsum('vw,kwbc,bcik,uajv->uaij', eta1['a'], h['aa'][c,a,v,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,hc] += -1.0 * np.einsum('vw,kIvA,aAiI,uwjk->uaij', eta1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['aa'][pa,pa,hc,hc], optimize=True)
	X['aa'][pa,pv,hc,hc] += -0.5 * np.einsum('vw,kIvA,aAkI,uwij->uaij', eta1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['aa'][pa,pa,hc,hc], optimize=True)
	X['aa'][pa,pv,hc,hc] += 1.0 * np.einsum('vw,wIbA,bAiI,uajv->uaij', eta1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,hc] += 0.5 * np.einsum('UV,vw,wIbU,abij,uVvI->uaij', eta1['b'], gamma1['a'], h['ab'][a,C,v,A], t['aa'][pv,pv,hc,hc], t['ab'][pa,pA,ha,hC], optimize=True)
	X['aa'][pa,pv,hc,hc] += 1.0 * np.einsum('UV,WX,kVbW,abik,uXjU->uaij', eta1['b'], gamma1['b'], h['ab'][c,A,v,A], t['aa'][pv,pv,hc,hc], t['ab'][pa,pA,hc,hA], optimize=True)
	X['aa'][pa,pv,hc,hc] += 0.5 * np.einsum('UV,WX,kXbU,abij,uVkW->uaij', eta1['b'], gamma1['b'], h['ab'][c,A,v,A], t['aa'][pv,pv,hc,hc], t['ab'][pa,pA,hc,hA], optimize=True)
	X['aa'][pa,pv,hc,hc] += -1.0 * np.einsum('UV,WX,kXbU,abik,uVjW->uaij', eta1['b'], gamma1['b'], h['ab'][c,A,v,A], t['aa'][pv,pv,hc,hc], t['ab'][pa,pA,hc,hA], optimize=True)
	X['aa'][pa,pv,hc,hc] += -1.0 * np.einsum('UV,WX,IVWA,aAiI,uXjU->uaij', eta1['b'], gamma1['b'], h['bb'][C,A,A,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['aa'][pa,pv,hc,hc] += 1.0 * np.einsum('UV,WX,IXUA,aAiI,uVjW->uaij', eta1['b'], gamma1['b'], h['bb'][C,A,A,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hA], optimize=True)
	X['aa'][pa,pv,hc,hc] += 0.5 * np.einsum('UV,kIbU,abij,uVkI->uaij', eta1['b'], h['ab'][c,C,v,A], t['aa'][pv,pv,hc,hc], t['ab'][pa,pA,hc,hC], optimize=True)
	X['aa'][pa,pv,hc,hc] += -1.0 * np.einsum('UV,kIbU,abik,uVjI->uaij', eta1['b'], h['ab'][c,C,v,A], t['aa'][pv,pv,hc,hc], t['ab'][pa,pA,hc,hC], optimize=True)
	X['aa'][pa,pv,hc,hc] += 1.0 * np.einsum('UV,IJUA,aAiI,uVjJ->uaij', eta1['b'], h['bb'][C,C,A,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pA,hc,hC], optimize=True)
	X['aa'][pa,pv,hc,hc] += -0.25 * np.einsum('vw,xy,wybc,acij,ubvx->uaij', gamma1['a'], gamma1['a'], h['aa'][a,a,v,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pa,pv,hc,hc] += 0.125 * np.einsum('vw,xy,wybc,bcij,uavx->uaij', gamma1['a'], gamma1['a'], h['aa'][a,a,v,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pa,pv,hc,hc] += -0.25 * np.einsum('vw,klvb,abkl,uwij->uaij', gamma1['a'], h['aa'][c,c,a,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pa,hc,hc], optimize=True)
	X['aa'][pa,pv,hc,hc] += -0.5 * np.einsum('vw,kwbc,acij,ubkv->uaij', gamma1['a'], h['aa'][c,a,v,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,hc] += 1.0 * np.einsum('vw,kwbc,acik,ubjv->uaij', gamma1['a'], h['aa'][c,a,v,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,hc] += 0.25 * np.einsum('vw,kwbc,bcij,uakv->uaij', gamma1['a'], h['aa'][c,a,v,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,hc] += -0.5 * np.einsum('vw,kwbc,bcik,uajv->uaij', gamma1['a'], h['aa'][c,a,v,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,hc] += -0.5 * np.einsum('vw,kIvA,aAkI,uwij->uaij', gamma1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['aa'][pa,pa,hc,hc], optimize=True)
	X['aa'][pa,pv,hc,hc] += 0.5 * np.einsum('vw,wIbA,abij,uAvI->uaij', gamma1['a'], h['ab'][a,C,v,V], t['aa'][pv,pv,hc,hc], t['ab'][pa,pV,ha,hC], optimize=True)
	X['aa'][pa,pv,hc,hc] += -1.0 * np.einsum('vw,wIbA,aAiI,ubjv->uaij', gamma1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,hc] += 1.0 * np.einsum('vw,wIbA,bAiI,uajv->uaij', gamma1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pa,pv,hc,hc] += 0.5 * np.einsum('UV,vw,wVbA,abij,uAvU->uaij', gamma1['b'], gamma1['a'], h['ab'][a,A,v,V], t['aa'][pv,pv,hc,hc], t['ab'][pa,pV,ha,hA], optimize=True)
	X['aa'][pa,pv,hc,hc] += 0.5 * np.einsum('UV,kVbA,abij,uAkU->uaij', gamma1['b'], h['ab'][c,A,v,V], t['aa'][pv,pv,hc,hc], t['ab'][pa,pV,hc,hA], optimize=True)
	X['aa'][pa,pv,hc,hc] += -1.0 * np.einsum('UV,kVbA,abik,uAjU->uaij', gamma1['b'], h['ab'][c,A,v,V], t['aa'][pv,pv,hc,hc], t['ab'][pa,pV,hc,hA], optimize=True)
	X['aa'][pa,pv,hc,hc] += -1.0 * np.einsum('UV,IVAB,aAiI,uBjU->uaij', gamma1['b'], h['bb'][C,A,V,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,hc,hA], optimize=True)
	X['aa'][pa,pv,hc,hc] += 0.25 * np.einsum('klbc,abij,uckl->uaij', h['aa'][c,c,v,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,hc,hc], optimize=True)
	X['aa'][pa,pv,hc,hc] += -1.0 * np.einsum('klbc,abik,ucjl->uaij', h['aa'][c,c,v,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,hc,hc], optimize=True)
	X['aa'][pa,pv,hc,hc] += 0.25 * np.einsum('klbc,abkl,ucij->uaij', h['aa'][c,c,v,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,hc,hc], optimize=True)
	X['aa'][pa,pv,hc,hc] += 0.125 * np.einsum('klbc,bcij,uakl->uaij', h['aa'][c,c,v,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,hc,hc], optimize=True)
	X['aa'][pa,pv,hc,hc] += -0.5 * np.einsum('klbc,bcik,uajl->uaij', h['aa'][c,c,v,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,hc,hc], optimize=True)
	X['aa'][pa,pv,hc,hc] += 0.5 * np.einsum('kIbA,abij,uAkI->uaij', h['ab'][c,C,v,V], t['aa'][pv,pv,hc,hc], t['ab'][pa,pV,hc,hC], optimize=True)
	X['aa'][pa,pv,hc,hc] += -1.0 * np.einsum('kIbA,abik,uAjI->uaij', h['ab'][c,C,v,V], t['aa'][pv,pv,hc,hc], t['ab'][pa,pV,hc,hC], optimize=True)
	X['aa'][pa,pv,hc,hc] += -1.0 * np.einsum('kIbA,aAiI,ubjk->uaij', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,hc,hc], optimize=True)
	X['aa'][pa,pv,hc,hc] += -0.5 * np.einsum('kIbA,aAkI,ubij->uaij', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,hc,hc], optimize=True)
	X['aa'][pa,pv,hc,hc] += 1.0 * np.einsum('kIbA,bAiI,uajk->uaij', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,hc,hc], optimize=True)
	X['aa'][pa,pv,hc,hc] += -1.0 * np.einsum('IJAB,aAiI,uBjJ->uaij', h['bb'][C,C,V,V], t['ab'][pv,pV,hc,hC], t['ab'][pa,pV,hc,hC], optimize=True)
	# cc|vv
	X['aa'][pv,pv,hc,hc] += -0.25 * np.einsum('uv,wx,yz,kzuw,abik,vxjy->abij', eta1['a'], eta1['a'], gamma1['a'], h['aa'][c,a,a,a], t['aa'][pv,pv,hc,hc], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,hc] += -0.25 * np.einsum('uv,wx,yz,vxyc,acij,zbuw->abij', eta1['a'], eta1['a'], gamma1['a'], h['aa'][a,a,a,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pv,pv,hc,hc] += -0.25 * np.einsum('uv,wx,kluw,abik,vxjl->abij', eta1['a'], eta1['a'], h['aa'][c,c,a,a], t['aa'][pv,pv,hc,hc], t['aa'][pa,pa,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += 0.0625 * np.einsum('uv,wx,kluw,abkl,vxij->abij', eta1['a'], eta1['a'], h['aa'][c,c,a,a], t['aa'][pv,pv,hc,hc], t['aa'][pa,pa,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += -0.0625 * np.einsum('uv,wx,vxcd,abuw,cdij->abij', eta1['a'], eta1['a'], h['aa'][a,a,v,v], t['aa'][pv,pv,ha,ha], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += -0.25 * np.einsum('uv,wx,yz,kvwy,abik,xzju->abij', eta1['a'], gamma1['a'], gamma1['a'], h['aa'][c,a,a,a], t['aa'][pv,pv,hc,hc], t['aa'][pa,pa,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,hc] += -0.25 * np.einsum('uv,wx,yz,xzuc,acij,vbwy->abij', eta1['a'], gamma1['a'], gamma1['a'], h['aa'][a,a,a,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,ha,ha], optimize=True)
	X['aa'][pv,pv,hc,hc] += -1.0 * np.einsum('uv,wx,kvwc,acik,xbju->abij', eta1['a'], gamma1['a'], h['aa'][c,a,a,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,hc] += -0.5 * np.einsum('uv,wx,kxuc,abik,vcjw->abij', eta1['a'], gamma1['a'], h['aa'][c,a,a,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,hc] += -0.5 * np.einsum('uv,wx,kxuc,acij,vbkw->abij', eta1['a'], gamma1['a'], h['aa'][c,a,a,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,hc] += 1.0 * np.einsum('uv,wx,kxuc,acik,vbjw->abij', eta1['a'], gamma1['a'], h['aa'][c,a,a,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,hc] += 1.0 * np.einsum('uv,wx,vIwA,aAiI,xbju->abij', eta1['a'], gamma1['a'], h['ab'][a,C,a,V], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,hc] += -1.0 * np.einsum('uv,wx,xIuA,aAiI,vbjw->abij', eta1['a'], gamma1['a'], h['ab'][a,C,a,V], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,hc] += -0.5 * np.einsum('uv,UV,kVuA,abik,vAjU->abij', eta1['a'], gamma1['b'], h['ab'][c,A,a,V], t['aa'][pv,pv,hc,hc], t['ab'][pa,pV,hc,hA], optimize=True)
	X['aa'][pv,pv,hc,hc] += -0.5 * np.einsum('uv,kluc,abik,vcjl->abij', eta1['a'], h['aa'][c,c,a,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += 0.125 * np.einsum('uv,kluc,abkl,vcij->abij', eta1['a'], h['aa'][c,c,a,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += -0.25 * np.einsum('uv,kluc,acij,vbkl->abij', eta1['a'], h['aa'][c,c,a,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += 1.0 * np.einsum('uv,kluc,acik,vbjl->abij', eta1['a'], h['aa'][c,c,a,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += -0.25 * np.einsum('uv,kluc,ackl,vbij->abij', eta1['a'], h['aa'][c,c,a,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += 0.25 * np.einsum('uv,kvcd,abiu,cdjk->abij', eta1['a'], h['aa'][c,a,v,v], t['aa'][pv,pv,hc,ha], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += -0.5 * np.einsum('uv,kIuA,abik,vAjI->abij', eta1['a'], h['ab'][c,C,a,V], t['aa'][pv,pv,hc,hc], t['ab'][pa,pV,hc,hC], optimize=True)
	X['aa'][pv,pv,hc,hc] += -1.0 * np.einsum('uv,kIuA,aAiI,vbjk->abij', eta1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += -0.5 * np.einsum('uv,kIuA,aAkI,vbij->abij', eta1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += 0.5 * np.einsum('uv,vIcA,cAiI,abju->abij', eta1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,hc,hC], t['aa'][pv,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,hc] += -0.5 * np.einsum('UV,uv,WX,kXuU,abik,vVjW->abij', eta1['b'], eta1['a'], gamma1['b'], h['ab'][c,A,a,A], t['aa'][pv,pv,hc,hc], t['ab'][pa,pA,hc,hA], optimize=True)
	X['aa'][pv,pv,hc,hc] += 0.5 * np.einsum('UV,uv,WX,vVcW,aXuU,bcij->abij', eta1['b'], eta1['a'], gamma1['b'], h['ab'][a,A,v,A], t['ab'][pv,pA,ha,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += -0.5 * np.einsum('UV,uv,kIuU,abik,vVjI->abij', eta1['b'], eta1['a'], h['ab'][c,C,a,A], t['aa'][pv,pv,hc,hc], t['ab'][pa,pA,hc,hC], optimize=True)
	X['aa'][pv,pv,hc,hc] += 0.5 * np.einsum('UV,uv,vIcU,aVuI,bcij->abij', eta1['b'], gamma1['a'], h['ab'][a,C,v,A], t['ab'][pv,pA,ha,hC], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += -0.5 * np.einsum('UV,WX,uv,kVuW,abik,vXjU->abij', eta1['b'], gamma1['b'], gamma1['a'], h['ab'][c,A,a,A], t['aa'][pv,pv,hc,hc], t['ab'][pa,pA,hc,hA], optimize=True)
	X['aa'][pv,pv,hc,hc] += 0.5 * np.einsum('UV,WX,uv,vXcU,aVuW,bcij->abij', eta1['b'], gamma1['b'], gamma1['a'], h['ab'][a,A,v,A], t['ab'][pv,pA,ha,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += -1.0 * np.einsum('UV,WX,kVcW,aXiU,bcjk->abij', eta1['b'], gamma1['b'], h['ab'][c,A,v,A], t['ab'][pv,pA,hc,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += 1.0 * np.einsum('UV,WX,kXcU,aViW,bcjk->abij', eta1['b'], gamma1['b'], h['ab'][c,A,v,A], t['ab'][pv,pA,hc,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += 0.5 * np.einsum('UV,WX,kXcU,aVkW,bcij->abij', eta1['b'], gamma1['b'], h['ab'][c,A,v,A], t['ab'][pv,pA,hc,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += 0.5 * np.einsum('UV,WX,kXcU,cViW,abjk->abij', eta1['b'], gamma1['b'], h['ab'][c,A,v,A], t['ab'][pv,pA,hc,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += 1.0 * np.einsum('UV,WX,IVWA,aAiI,bXjU->abij', eta1['b'], gamma1['b'], h['bb'][C,A,A,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,hc,hA], optimize=True)
	X['aa'][pv,pv,hc,hc] += -1.0 * np.einsum('UV,WX,IXUA,aAiI,bVjW->abij', eta1['b'], gamma1['b'], h['bb'][C,A,A,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,hc,hA], optimize=True)
	X['aa'][pv,pv,hc,hc] += 1.0 * np.einsum('UV,kIcU,aViI,bcjk->abij', eta1['b'], h['ab'][c,C,v,A], t['ab'][pv,pA,hc,hC], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += 0.5 * np.einsum('UV,kIcU,aVkI,bcij->abij', eta1['b'], h['ab'][c,C,v,A], t['ab'][pv,pA,hc,hC], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += 0.5 * np.einsum('UV,kIcU,cViI,abjk->abij', eta1['b'], h['ab'][c,C,v,A], t['ab'][pv,pA,hc,hC], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += -1.0 * np.einsum('UV,IJUA,aAiI,bVjJ->abij', eta1['b'], h['bb'][C,C,A,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pA,hc,hC], optimize=True)
	X['aa'][pv,pv,hc,hc] += -0.0625 * np.einsum('uv,wx,kluw,abkl,vxij->abij', gamma1['a'], gamma1['a'], h['aa'][c,c,a,a], t['aa'][pv,pv,hc,hc], t['aa'][pa,pa,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += 0.0625 * np.einsum('uv,wx,vxcd,abuw,cdij->abij', gamma1['a'], gamma1['a'], h['aa'][a,a,v,v], t['aa'][pv,pv,ha,ha], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += -0.25 * np.einsum('uv,wx,vxcd,acuw,bdij->abij', gamma1['a'], gamma1['a'], h['aa'][a,a,v,v], t['aa'][pv,pv,ha,ha], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += -0.25 * np.einsum('uv,kluc,ackl,vbij->abij', gamma1['a'], h['aa'][c,c,a,v], t['aa'][pv,pv,hc,hc], t['aa'][pa,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += 0.25 * np.einsum('uv,kvcd,abiu,cdjk->abij', gamma1['a'], h['aa'][c,a,v,v], t['aa'][pv,pv,hc,ha], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += 0.125 * np.einsum('uv,kvcd,abku,cdij->abij', gamma1['a'], h['aa'][c,a,v,v], t['aa'][pv,pv,hc,ha], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += -1.0 * np.einsum('uv,kvcd,aciu,bdjk->abij', gamma1['a'], h['aa'][c,a,v,v], t['aa'][pv,pv,hc,ha], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += -0.5 * np.einsum('uv,kvcd,acku,bdij->abij', gamma1['a'], h['aa'][c,a,v,v], t['aa'][pv,pv,hc,ha], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += 0.25 * np.einsum('uv,kvcd,cdiu,abjk->abij', gamma1['a'], h['aa'][c,a,v,v], t['aa'][pv,pv,hc,ha], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += -0.5 * np.einsum('uv,kIuA,aAkI,vbij->abij', gamma1['a'], h['ab'][c,C,a,V], t['ab'][pv,pV,hc,hC], t['aa'][pa,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += 1.0 * np.einsum('uv,vIcA,aAiI,bcju->abij', gamma1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,hc,hC], t['aa'][pv,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,hc] += 0.5 * np.einsum('uv,vIcA,aAuI,bcij->abij', gamma1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,ha,hC], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += 0.5 * np.einsum('uv,vIcA,cAiI,abju->abij', gamma1['a'], h['ab'][a,C,v,V], t['ab'][pv,pV,hc,hC], t['aa'][pv,pv,hc,ha], optimize=True)
	X['aa'][pv,pv,hc,hc] += 0.5 * np.einsum('UV,uv,vVcA,aAuU,bcij->abij', gamma1['b'], gamma1['a'], h['ab'][a,A,v,V], t['ab'][pv,pV,ha,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += 1.0 * np.einsum('UV,kVcA,aAiU,bcjk->abij', gamma1['b'], h['ab'][c,A,v,V], t['ab'][pv,pV,hc,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += 0.5 * np.einsum('UV,kVcA,aAkU,bcij->abij', gamma1['b'], h['ab'][c,A,v,V], t['ab'][pv,pV,hc,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += 0.5 * np.einsum('UV,kVcA,cAiU,abjk->abij', gamma1['b'], h['ab'][c,A,v,V], t['ab'][pv,pV,hc,hA], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += -1.0 * np.einsum('UV,IVAB,aAiU,bBjI->abij', gamma1['b'], h['bb'][C,A,V,V], t['ab'][pv,pV,hc,hA], t['ab'][pv,pV,hc,hC], optimize=True)
	X['aa'][pv,pv,hc,hc] += 0.25 * np.einsum('klcd,abil,cdjk->abij', h['aa'][c,c,v,v], t['aa'][pv,pv,hc,hc], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += 0.0625 * np.einsum('klcd,abkl,cdij->abij', h['aa'][c,c,v,v], t['aa'][pv,pv,hc,hc], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += 0.25 * np.einsum('klcd,adij,bckl->abij', h['aa'][c,c,v,v], t['aa'][pv,pv,hc,hc], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += 0.5 * np.einsum('klcd,adil,bcjk->abij', h['aa'][c,c,v,v], t['aa'][pv,pv,hc,hc], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += 1.0 * np.einsum('kIcA,aAiI,bcjk->abij', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += 0.5 * np.einsum('kIcA,aAkI,bcij->abij', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += 0.5 * np.einsum('kIcA,cAiI,abjk->abij', h['ab'][c,C,v,V], t['ab'][pv,pV,hc,hC], t['aa'][pv,pv,hc,hc], optimize=True)
	X['aa'][pv,pv,hc,hc] += 0.5 * np.einsum('IJAB,aAiI,bBjJ->abij', h['bb'][C,C,V,V], t['ab'][pv,pV,hc,hC], t['ab'][pv,pV,hc,hC], optimize=True)
	toc = time.time()
	elapsed_time = toc - tic
	if verbose:
		print(f'Took {elapsed_time} seconds.')
	return X
